<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Satış Dashboard - Speedometer</title>
    <script src="https://smtpjs.com/v3/smtp.js"></script>
    

    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-analytics-compat.js"></script>    

    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Hamburger Menu Styles */
        .hamburger-menu {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
        }
        
        .hamburger-btn {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 4px;
        }
        
        .hamburger-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border-color: #cbd5e1;
        }
        
        .hamburger-line {
            width: 20px;
            height: 2px;
            background: #475569;
            transition: all 0.3s ease;
            border-radius: 1px;
        }
        
        .hamburger-btn.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        
        .hamburger-btn.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }
        
        .hamburger-btn.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(5px);
        }
        
        .menu-content {
            position: fixed;
            top: 0;
            left: -350px;
            width: 350px;
            height: 100%;
            background: white;
            box-shadow: 4px 0 20px rgba(0,0,0,0.2);
            transition: left 0.3s ease;
            overflow-y: auto;
            z-index: 1002;
        }
        
        .menu-content.active {
            left: 0;
        }
        
        .menu-header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .menu-header h3 {
            margin: 0;
            font-size: 1.3em;
        }
        
        .pipeline-container {
            display: none;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            min-height: 100vh;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
        }
        
        .pipeline-header {
            text-align: center;
            color: #1e293b;
            margin-bottom: 30px;
        }
        
        .pipeline-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #1e293b;
        }
        
        .pipeline-header p {
            font-size: 1.1em;
            color: #64748b;
            margin: 0;
        }
        
        .pipeline-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .pipeline-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #2563EB;
            transition: all 0.3s ease;
        }
        
        .pipeline-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .pipeline-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .customer-name {
            font-size: 1.3em;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }
        
        .pipeline-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .status-prospecting {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-qualified {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .status-proposal {
            background: #fce7f3;
            color: #be185d;
        }
        
        .status-negotiation {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-closed {
            background: #dcfce7;
            color: #166534;
        }
        
        .pipeline-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .pipeline-detail-item {
            display: flex;
            flex-direction: column;
        }
        
        .pipeline-detail-label {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 4px;
            font-weight: 500;
        }
        
        .pipeline-detail-value {
            font-size: 1em;
            color: #1e293b;
            font-weight: 500;
        }
        
        .pipeline-amount {
            font-size: 1.4em;
            font-weight: 700;
            color: #059669;
            text-align: right;
        }
        
        .pipeline-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .pipeline-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .pipeline-btn-primary {
            background: #2563EB;
            color: white;
        }
        
        .pipeline-btn-primary:hover {
            background: #1d4ed8;
        }
        
        .pipeline-btn-secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        
        .pipeline-btn-secondary:hover {
            background: #e2e8f0;
        }
        
        .pipeline-detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .pipeline-detail-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 3px solid #2563EB;
        }
        
        .pipeline-detail-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .pipeline-detail-card-header h4 {
            margin: 0;
            color: #1e293b;
            font-size: 1.1em;
        }
        
        .pipeline-detail-card-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .pipeline-detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
        }
        
        .detail-label {
            font-weight: 500;
            color: #64748b;
            font-size: 0.9em;
        }
        
        .detail-value {
            color: #1e293b;
            font-weight: 500;
        }
        
        .detail-value.amount {
            color: #059669;
            font-weight: 600;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .summary-stat {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .summary-stat-label {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 5px;
        }
        
        .summary-stat-value {
            font-size: 1.2em;
            font-weight: 600;
            color: #1e293b;
        }
        
        .menu-body {
            padding: 20px;
        }
        
        .menu-section {
            margin-bottom: 25px;
        }
        
        .menu-section h4 {
            color: #333;
            margin: 0 0 15px 0;
            font-size: 1.1em;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 8px;
        }
        
        .menu-section {
            margin-bottom: 25px;
        }
        
        .menu-section h4 {
            color: #333;
            margin: 0 0 15px 0;
            font-size: 1.1em;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 8px;
        }
        
        .menu-btn {
            display: block;
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 8px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 14px;
        }
        
        .menu-btn:hover {
            transform: translateX(5px);
        }
        
        .menu-btn-primary {
            background: linear-gradient(135deg, #475569 0%, #64748b 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(71, 85, 105, 0.3);
        }
        
        .menu-btn-primary:hover {
            background: linear-gradient(135deg, #334155 0%, #475569 100%);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(71, 85, 105, 0.4);
        }
        
        .menu-btn-secondary {
            background: linear-gradient(135deg, #94a3b8 0%, #cbd5e1 100%);
            color: #1e293b;
            box-shadow: 0 2px 8px rgba(148, 163, 184, 0.3);
        }
        
        .menu-btn-secondary:hover {
            background: linear-gradient(135deg, #64748b 0%, #94a3b8 100%);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(148, 163, 184, 0.4);
        }
        
        .menu-btn-google {
            background: linear-gradient(135deg, #0ea5e9 0%, #38bdf8 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(14, 165, 233, 0.3);
        }
        
        .menu-btn-google:hover {
            background: linear-gradient(135deg, #0284c7 0%, #0ea5e9 100%);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.4);
        }
        
        .menu-btn-google-green {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        .menu-btn-google-green:hover {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        
        .file-input-menu {
            padding: 10px 15px;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            margin-bottom: 8px;
            color: #64748b;
            font-weight: 500;
        }
        
        .file-input-menu:hover {
            border-color: #94a3b8;
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
            transform: translateX(5px);
            color: #475569;
        }
        
        .header {
            text-align: center;
            color: #1e293b;
            margin-bottom: 30px;
            margin-top: 20px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .header p {
            font-size: 1.2em;
            margin: 10px 0;
            opacity: 0.9;
        }
        
        .control-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .control-panel h3 {
            margin: 0 0 15px 0;
            color: #333;
        }
        
        .upload-section {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .file-input {
            padding: 10px 15px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-input:hover {
            border-color: #667eea;
            background: #e8f0fe;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #2563EB;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .data-input {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .data-input textarea {
            width: 100%;
            height: 120px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            resize: vertical;
        }
        
        .speedometer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .speedometer-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
            cursor: grab;
            position: relative;
            user-select: none;
        }
        
        .speedometer-card.dragging {
            cursor: grabbing;
            transform: rotate(5deg) scale(1.05);
            box-shadow: 0 12px 40px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .speedometer-card.drag-over {
            border: 2px dashed #3b82f6;
            background: #f0f9ff;
        }
        
        /* Mail Settings Styles */
        .mail-settings-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .mail-settings-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .mail-settings-card h3 {
            margin: 0 0 25px 0;
            color: #1e293b;
            font-size: 1.5rem;
        }
        
        .mail-settings-form {
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        .form-group small {
            display: block;
            margin-top: 5px;
            color: #6b7280;
            font-size: 12px;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }
        
        .checkbox-item span {
            font-weight: 500;
        }
        
        .mail-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }
        
        .mail-status {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e2e8f0;
        }
        
        .mail-status h4 {
            margin: 0 0 15px 0;
            color: #1e293b;
        }
        
        .mail-status p {
            margin: 8px 0;
            color: #475569;
        }
        
        .mail-status strong {
            color: #1e293b;
        }
        
        .speedometer-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            border-color: #3b82f6;
        }
        
        .speedometer-card.inactive-card {
            opacity: 0.6;
            filter: grayscale(50%);
        }
        
        .speedometer-card.inactive-card:hover {
            transform: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-color: rgba(255,255,255,0.2);
        }
        
        .speedometer-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10b981, #3b82f6, #f59e0b, #ef4444);
            border-radius: 16px 16px 0 0;
        }
        
        .speedometer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .speedometer-header h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
        }
        
        .performance-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .performance-excellent {
            background: #dcfce7;
            color: #166534;
        }
        
        .performance-good {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .performance-average {
            background: #fef3c7;
            color: #92400e;
        }
        
        .performance-poor {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .speedometer-gauge {
            text-align: center;
            margin: 20px 0;
        }
        
        .gauge-svg {
            width: 100%;
            max-width: 200px;
            height: auto;
        }
        
        .percentage-text {
            font-size: 24px;
            font-weight: 700;
            fill: #1f2937;
        }
        
        .target-text {
            font-size: 12px;
            fill: #6b7280;
            font-weight: 500;
        }
        
        .speedometer-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 4px;
            font-weight: 500;
        }
        
        .stat-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
        }
        
        .speedometer-footer {
            text-align: center;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #f1f5f9;
        }
        
        .detail-link {
            color: #3b82f6;
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        .detail-link:hover {
            color: #1d4ed8;
        }
        
        /* Yıllık Dashboard özel stilleri */
        #yearlyDashboardContainer .header {
            text-align: center;
            color: #1e293b;
            margin-bottom: 30px;
            margin-top: 20px;
        }
        
        #yearlyDashboardContainer .header h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        #yearlyDashboardContainer .header p {
            font-size: 1.2em;
            margin: 10px 0;
            opacity: 0.9;
        }
        
        #yearlyDashboardContainer .summary-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        /* Satış Kaynağı Dağılım Grafikleri */
        .sales-source-charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }
        
        .chart-container h4 {
            margin: 0 0 15px 0;
            color: #1e293b;
            font-size: 1.1em;
            text-align: center;
            font-weight: 600;
        }
        
        .chart {
            height: 200px;
            width: 100%;
            position: relative;
        }
        
        .chart-bar {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border-radius: 4px;
            margin: 8px 0;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .chart-bar:hover {
            transform: scaleX(1.02);
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }
        
        .chart-bar-label {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 0.85em;
            font-weight: 500;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .chart-bar-value {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 0.85em;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .chart-total {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 10px;
            border: 2px solid #cbd5e1;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .chart-total strong {
            color: #1e293b;
            font-size: 1.2em;
            font-weight: 700;
        }
        
        /* 5 kaynak yan yana, her kutucukta satır satır satışçılar */
        .sales-sources-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin: 0;
            justify-content: space-between;
        }
        
        .sales-source-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            min-height: 280px;
            flex: 1;
            min-width: 200px;
            max-width: 220px;
            margin: 0;
        }
        
        .sales-source-card h3 {
            margin: 0 0 15px 0;
            color: #1e293b;
            font-size: 1.1em;
            font-weight: 700;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #3b82f6;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            margin: 0 -12px 15px -12px;
            padding: 15px 12px 10px 12px;
            border-radius: 8px 8px 0 0;
        }
        
        .sales-person-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f1f5f9;
            margin-bottom: 2px;
        }
        
        .sales-person-row:last-child {
            border-bottom: none;
        }
        
        .sales-person-row:hover {
            background: #f8fafc;
            border-radius: 6px;
            padding: 10px 8px;
            margin: 0 -8px;
        }
        
        .sales-person-name {
            font-size: 0.9em;
            color: #1e293b;
            font-weight: 600;
            flex: 1;
            margin-right: 8px;
        }
        
        .sales-person-amount {
            font-size: 0.85em;
            color: #059669;
            font-weight: 700;
            text-align: right;
            margin-left: 8px;
            min-width: 60px;
        }
        
        .sales-person-percentage {
            font-size: 0.8em;
            color: #6b7280;
            font-weight: 600;
            text-align: right;
            margin-left: 8px;
            min-width: 40px;
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .sales-source-total {
            margin-top: 15px;
            padding: 12px;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border-radius: 8px;
            text-align: center;
            font-size: 0.95em;
            font-weight: 700;
            color: white;
            border: none;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }
        
        .sales-source-distribution-card .card-body {
            padding: 0;
            min-height: 400px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }
        
        .sales-source-distribution-card .card-header {
            cursor: pointer;
            position: relative;
            padding-right: 60px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px 12px 0 0;
            margin: -20px -20px 20px -20px;
            padding: 25px 60px 20px 20px;
            border-bottom: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .sales-source-distribution-card .card-header:hover {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border-bottom-color: #cbd5e1;
        }
        
        .sales-source-distribution-card .header-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .sales-source-distribution-card .header-left {
            flex: 1;
        }
        
        .sales-source-distribution-card .header-right {
            margin-left: 15px;
        }
        
        .toggle-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
            border-radius: 50%;
            padding: 0;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 10;
        }
        
        .toggle-btn:hover {
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }
        
        .toggle-btn:active {
            transform: scale(0.95);
        }
        
        .toggle-icon {
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            line-height: 1;
        }
        
        .toggle-icon.collapsed {
            transform: rotate(-90deg);
        }
        
        .sales-source-distribution-card.collapsed .card-body {
            display: none;
        }
        
        /* Responsive tasarım */
        @media (max-width: 1200px) {
            .sales-source-card {
                min-width: 180px;
                max-width: 200px;
            }
        }
        
        @media (max-width: 768px) {
            .sales-sources-grid {
                flex-direction: column;
                align-items: center;
            }
            
            .sales-source-card {
                min-width: 100%;
                max-width: 100%;
                margin-bottom: 15px;
            }
        }
        
        #yearlyDashboardContainer .speedometer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-top: 30px;
        }
        
        #yearlyDashboardContainer .speedometer-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        #yearlyDashboardContainer .speedometer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .edit-icon {
            background: transparent;
            color: #2563EB;
            border: none;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            margin-left: 10px;
            opacity: 0;
            transform: scale(0.8);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }
        
        .speedometer-card:hover .edit-icon {
            opacity: 1;
            transform: scale(1);
        }
        
        .edit-icon:hover {
            background: #2563EB;
            color: white;
            transform: scale(1.1);
        }
        

        

        
        .detail-value.editable {
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 6px;
            position: relative;
        }
        
        .detail-value.editable:hover {
            background: #F0F9FF;
            color: #2563EB;
        }
        
        .detail-value.editing {
            background: #fff3cd;
            border: 2px solid #ffc107;
            position: relative;
            z-index: 1000;
        }
        
        .detail-value input {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 6px 10px;
            font-size: 16px;
            width: 100px;
            text-align: center;
            margin-right: 5px;
        }
        .detail-value .edit-buttons {
            display: inline-flex;
            gap: 3px;
            vertical-align: middle;
        }
        
        .detail-value .edit-buttons button {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 3px 6px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 20px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .detail-value .edit-buttons button:hover {
            background: #218838;
        }
        
        .detail-value .edit-buttons .cancel-btn {
            background: #6c757d;
        }
        
        .detail-value .edit-buttons .cancel-btn:hover {
            background: #5a6268;
        }
        
        /* Modal içindeki düzenleme alanları için özel stiller */
        .modal-content .detail-value.editing {
            max-width: 100%;
            overflow: visible;
        }
        
        .modal-content .detail-value input {
            max-width: 80px;
            font-size: 14px;
        }
        
        .modal-content .detail-value .edit-buttons {
            flex-shrink: 0;
        }
        
        .inline-edit {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 6px;
            margin: 2px 0;
        }
        
        .inline-edit input {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 14px;
            width: 100px;
        }
        
        .inline-edit button {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .inline-edit button:hover {
            background: #218838;
        }
        
        .inline-edit .cancel-btn {
            background: #6c757d;
        }
        
        .inline-edit .cancel-btn:hover {
            background: #5a6268;
        }
        
        .speedometer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
        }
        
        .speedometer-card::after {
            content: "📊 Detayları Göster";
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 0.8em;
            color: #666;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .speedometer-card:hover::after {
            opacity: 1;
        }
        
        .card-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .card-header h3 {
            margin: 0;
            font-size: 1.4em;
            color: #333;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .speedometer-container {
            position: relative;
            width: 280px;
            height: 180px;
            margin: 0 auto;
        }
        
        .speedometer-svg {
            width: 100%;
            height: 100%;
        }
        
        .stats-container {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .stat-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        .stat-value:hover {
            background: #e8f0fe;
            color: #667eea;
        }
        
        .stat-value.editing {
            background: #fff3cd;
            border: 2px solid #ffc107;
        }
        
        .achievement-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            color: white;
        }
        
        .badge-excellent { background: #108981; }
        .badge-good { background: #9CA3AF; color: white; }
        .badge-needs-improvement { background: #dc3545; }
        
        .summary-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            text-align: center;
        }
        
        .summary-stat {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .summary-stat h4 {
            margin: 0 0 10px 0;
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .summary-stat .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
        }
        
        .instructions {
            background: #e8f4f8;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
        }
        
        .instructions h4 {
            margin: 0 0 10px 0;
            color: #17a2b8;
        }
        
        .instructions ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .last-updated {
            text-align: center;
            color: #666;
            font-size: 0.9em;
            margin-top: 20px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 90%;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 15px;
        }

        .modal-title {
            font-size: 1.8em;
            color: #111827;
            font-weight: 600;
            margin: 0;
        }
        .close-btn {
            background: #f8f9fa;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #666;
        }

        .close-btn:hover {
            background: #dc3545;
            color: white;
            transform: scale(1.1);
        }

        .detail-section {
            margin-bottom: 25px;
        }

        .detail-section h3 {
            color: #111827;
            font-size: 1.3em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .detail-item {
            background: #F0F9FF;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #2563EB;
        }

        .detail-item h4 {
            margin: 0 0 8px 0;
            color: #666;
            font-size: 0.9em;
            /* text-transform: uppercase; */
        }

        .detail-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
        }
        
        .monthly-chart {
            background: #f8f9fa;
            padding: 40px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .chart-bars {
            display: flex;
            align-items: end;
            gap: 40px;
            height: 150px;
            padding: 20px 10px;
            justify-content: space-around;
            overflow: visible;
        }

        .chart-bar {
            background: linear-gradient(180deg, #7f5af0 0%, #2cb67d 100%);
            border-radius: 16px 16px 0 0;
            min-width: 38px;
            position: relative;
            transition: all 0.3s cubic-bezier(.4,2,.6,1);
            box-shadow: 0 4px 24px 0 rgba(127,90,240,0.10), 0 1.5px 0 #2cb67d;
            animation: barFadeIn 0.7s cubic-bezier(.4,2,.6,1) both;
        }
        .chart-bar:hover {
            opacity: 0.95;
            transform: scale(1.15);
            box-shadow: 0 8px 32px 0 rgba(127,90,240,0.18), 0 2px 0 #2cb67d;
            z-index: 2;
        }
        .chart-bars .chart-bar:nth-child(1) { animation-delay: 0.05s; }
        .chart-bars .chart-bar:nth-child(2) { animation-delay: 0.10s; }
        .chart-bars .chart-bar:nth-child(3) { animation-delay: 0.15s; }
        .chart-bars .chart-bar:nth-child(4) { animation-delay: 0.20s; }
        .chart-bars .chart-bar:nth-child(5) { animation-delay: 0.25s; }
        .chart-bars .chart-bar:nth-child(6) { animation-delay: 0.30s; }

        @keyframes barFadeIn {
          from { opacity: 0; transform: translateY(40px); }
          to   { opacity: 1; transform: translateY(0); }
        }

        .bar-value {
            position: absolute;
            top: -38px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            color: #222;
            font-weight: 700;
            font-size: 1em;
            padding: 3px 10px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(127,90,240,0.10);
            margin-bottom: 6px;
            white-space: nowrap;
            width: max-content;
            z-index: 3;
        }

        .bar-label {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            color: #666;
            font-weight: 500;
            white-space: nowrap;
            width: max-content;
        }

        .performance-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .indicator {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            color: white;
        }

        .indicator-excellent { background: #108981; }
        .indicator-good { background: #9CA3AF; color: white; }
        .indicator-warning { background: #fd7e14; }
        .indicator-danger { background: #dc3545; }

        .target-progress {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .progress-bar {
            background: #e9ecef;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #108981, #2563EB);
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 0.8em;
        }

        /* Ekip Kartları Stilleri */
        .team-section {
            margin-top: 40px;
            padding: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .team-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .team-header h2 {
            font-size: 2.2em;
            color: #1e293b;
            margin-bottom: 10px;
        }
        
        .team-header p {
            font-size: 1.1em;
            color: #64748b;
            margin: 0;
        }
        
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .team-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #2563EB;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .team-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .team-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .team-member-name {
            font-size: 1.3em;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }
        
        .team-performance-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .performance-excellent {
            background: #d1fae5;
            color: #065f46;
        }
        
        .performance-good {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .performance-average {
            background: #fef3c7;
            color: #92400e;
        }
        
        .performance-poor {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .team-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .team-stat-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .team-stat-label {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 5px;
        }
        
        .team-stat-value {
            font-size: 1.2em;
            font-weight: 600;
            color: #1e293b;
        }
        
        .team-progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .team-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #dc3545 0%, #ffc107 50%, #28a745 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        /* Opportunity Card Styles */
        .opportunity-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .opportunity-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #2563EB;
        }
        
        .opportunity-status.proposal {
            background: #fce7f3;
            color: #be185d;
        }
        
        .opportunity-status.qualified {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .opportunity-status.prospecting {
            background: #fef3c7;
            color: #92400e;
        }
        
        .opportunity-status.negotiation {
            background: #fef3c7;
            color: #92400e;
        }
        
        .opportunity-status.closed-won {
            background: #dcfce7;
            color: #166534;
        }
        
        .opportunity-status.closed-lost {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .opportunity-status.closed {
            background: #dcfce7;
            color: #166534;
        }
        
        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .opportunities-container {
            max-height: 300px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f1f5f9;
        }
        
        .opportunities-container::-webkit-scrollbar {
            width: 6px;
        }
        
        .opportunities-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        
        .opportunities-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        .opportunities-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Modal Performans Detay Stilleri */
        .performance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .performance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #2563EB;
        }
        
        .performance-label {
            font-weight: 600;
            color: #64748b;
        }
        
        .performance-value {
            font-weight: 700;
            color: #1e293b;
            font-size: 1.1em;
        }
        
        @media (max-width: 768px) {
            .speedometer-grid {
                grid-template-columns: 1fr;
            }
            
            .team-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .menu-content {
                width: 300px;
            }
        }

        @media (max-width: 480px) {
            .summary-stats {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .menu-content {
                width: 280px;
            }
        }

        .header-flex {
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }
        .header-center {
          flex: 0 1 auto;
          text-align: center;
          margin: 0 auto;
          width: 100%;
        }
        .header-side {
          flex: 0 0 auto;
        }
        @media (max-width: 600px) {
          .header-center {
            font-size: 1em;
          }
        }
    </style>
    <style>
    @media (max-width: 600px) {
      .modal-content {
        max-width: 98vw !important;
        min-width: unset !important;
        padding: 10px !important;
        border-radius: 10px !important;
      }
      .modal-header h2, .modal-title {
        font-size: 1.2em !important;
      }
      .modal-header .close-btn {
        top: 8px !important;
        right: 8px !important;
        width: 32px !important;
        height: 32px !important;
        font-size: 1.3em !important;
      }
      #loginForm > div, #loginForm input, #loginForm button {
        max-width: 98vw !important;
        min-width: unset !important;
        font-size: 1em !important;
      }
      .dashboard-container, .pipeline-container {
        padding: 5px !important;
      }
      .speedometer-grid, .team-grid, .summary-stats {
        grid-template-columns: 1fr !important;
        gap: 10px !important;
      }
      .speedometer-card, .team-card, .summary-card {
        padding: 10px !important;
        border-radius: 10px !important;
      }
      .header h1 {
        font-size: 1.1em !important;
      }
    }
    </style>
    <style>
    .pipeline-summary-stats {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
      margin-top: 10px;
    }
    .pipeline-summary-stat {
      background: #f8fafc;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      border: 1px solid #e2e8f0;
      font-size: 1.1em;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .pipeline-summary-stat-label {
      font-size: 0.95em;
      color: #64748b;
      margin-bottom: 5px;
    }
    .pipeline-summary-stat-value {
      font-size: 1.3em;
      font-weight: 700;
      color: #1e293b;
    }
    </style>
    <style>
    .header h1,
    .pipeline-header h1 {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 2.5em;
      font-weight: 800;
      color: #1e293b;
      margin: 0 0 10px 0;
      text-shadow: none;
    }
    </style>
    <style>
    .person-title {
        font-size: 1.05em;
        font-weight: 500;
        color: #7f5af0;
        letter-spacing: 0.5px;
        margin-bottom: 2px;
        margin-top: 0px;
        text-align: center;
        text-transform: capitalize;
    }
    .card-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 10px;
    }
    </style>
    <style>

    </style>
    <style>
    @media (max-width: 600px) {
      .stats-container, .team-stats {
        flex-direction: column !important;
        display: flex !important;
        gap: 8px !important;
        padding: 8px !important;
      }
      .stat-item, .team-stat-item {
        min-width: unset !important;
        margin: 0 0 6px 0 !important;
        padding: 6px 4px !important;
        font-size: 0.98em !important;
      }
      .monthly-chart {
        padding: 10px !important;
      }
      .chart-bars {
        gap: 10px !important;
        padding: 8px 2px !important;
      }
      .chart-bar {
        min-width: 18px !important;
      }
      .bar-value {
        font-size: 0.9em !important;
        padding: 2px 5px !important;
      }
    }

    /* Stratejik Fırsatlar Styles */
    .strategic-opportunities-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .strategic-opportunity-card {
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #2563EB;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .strategic-opportunity-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #10b981, #3b82f6, #f59e0b, #ef4444);
        border-radius: 12px 12px 0 0;
    }
    
    .strategic-opportunity-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        border-color: #3b82f6;
    }
    
    .strategic-opportunity-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
    }
    
    .strategic-opportunity-title {
        font-size: 1.2em;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
        cursor: pointer;
        transition: color 0.3s ease;
    }
    
    .strategic-opportunity-title:hover {
        color: #3b82f6;
    }
    
    .strategic-opportunity-price {
        font-size: 1.4em;
        font-weight: 700;
        color: #059669;
        background: #f0fdf4;
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid #bbf7d0;
        box-shadow: 0 2px 4px rgba(5, 150, 105, 0.1);
    }
    
    .strategic-opportunity-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 20px;
    }
    
    .strategic-opportunity-detail {
        display: flex;
        flex-direction: column;
        background: white;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }
    
    .strategic-opportunity-detail-label {
        font-size: 0.85em;
        color: #64748b;
        font-weight: 500;
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .strategic-opportunity-detail-value {
        font-size: 1em;
        color: #1e293b;
        font-weight: 500;
    }
    
    .strategic-opportunity-owner {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 15px;
        background: white;
        border-radius: 10px;
        border-left: 4px solid #2563EB;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .strategic-opportunity-owner-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #2563EB, #1d4ed8);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 1em;
        box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
    }
    
    .strategic-opportunity-owner-info {
        flex: 1;
    }
    
    .strategic-opportunity-owner-name {
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 2px;
    }
    
    .strategic-opportunity-owner-title {
        font-size: 0.85em;
        color: #64748b;
    }
    
    .strategic-opportunity-status {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85em;
        font-weight: 500;
        text-align: center;
        margin-top: 10px;
    }
    
    .status-evaluation {
        background: #fef3c7;
        color: #92400e;
        border: 1px solid #fbbf24;
    }
    
    .status-proposal {
        background: #dbeafe;
        color: #1e40af;
        border: 1px solid #60a5fa;
    }
    
    .status-negotiation {
        background: #fce7f3;
        color: #be185d;
        border: 1px solid #f472b6;
    }
    
    .status-closing {
        background: #dcfce7;
        color: #166534;
        border: 1px solid #4ade80;
    }
    
    .strategic-opportunity-products {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 20px;
    }
    
    .product-tag {
        display: inline-block;
        padding: 6px 12px;
        background: linear-gradient(135deg, #e0f2fe, #b3e5fc);
        color: #0277bd;
        border-radius: 20px;
        font-size: 0.85em;
        font-weight: 500;
        border: 1px solid #81d4fa;
        transition: all 0.3s ease;
    }
    
    .product-tag:hover {
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(2, 119, 189, 0.2);
    }
    
    .status-input {
        padding: 6px 10px;
        border-radius: 6px;
        border: 1px solid #d1d5db;
        font-size: 0.9em;
        background: white;
        width: 100%;
        transition: all 0.3s ease;
        box-sizing: border-box;
    }
    
    .status-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        background: #f8fafc;
    }
    
    .status-input:hover {
        border-color: #9ca3af;
    }
    
    .strategic-btn:hover {
        background: linear-gradient(135deg, #059669, #047857) !important;
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4) !important;
    }
    
    .commit-btn:hover {
        background: linear-gradient(135deg, #d97706, #b45309) !important;
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4) !important;
    }
    
    .remove-strategic-btn:hover {
        background: #b91c1c !important;
        transform: scale(1.05);
    }
    
    .edit-strategic-btn:hover {
        background: #2563eb !important;
        transform: scale(1.05);
    }
    
    .edit-strategic-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    
    .edit-strategic-input {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }
    
    .edit-strategic-input label {
        font-weight: 600;
        color: #374151;
        font-size: 0.9em;
    }
    
    .edit-strategic-input input,
    .edit-strategic-input select {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 0.9em;
        transition: border-color 0.3s ease;
    }
    
    .edit-strategic-input input:focus,
    .edit-strategic-input select:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .edit-strategic-buttons {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 20px;
    }
    
    .edit-strategic-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        font-size: 0.9em;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .edit-strategic-btn-secondary {
        background: #6b7280;
        color: white;
    }
    
    .edit-strategic-btn-primary {
        background: #3b82f6;
        color: white;
    }
    
    .edit-strategic-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    /* Temmuz Commitment Styles */
    .opportunity-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    .opportunity-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #2563EB;
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .opportunity-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
    }

    .opportunity-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
    }

    .opportunity-title {
        font-size: 1.2em;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
        line-height: 1.3;
    }

    .opportunity-amount {
        font-size: 1.3em;
        font-weight: 700;
        color: #059669;
        text-align: right;
    }

    .opportunity-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-bottom: 15px;
    }

    .opportunity-detail {
        display: flex;
        flex-direction: column;
    }

    .opportunity-detail-label {
        font-size: 0.85em;
        color: #64748b;
        margin-bottom: 4px;
        font-weight: 500;
    }

    .opportunity-detail-value {
        font-size: 1em;
        color: #1e293b;
        font-weight: 500;
    }

    .opportunity-owner {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px;
        background: #f8fafc;
        border-radius: 8px;
        border-left: 3px solid #2563EB;
    }

    .opportunity-owner-icon {
        width: 32px;
        height: 32px;
        background: #2563EB;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.9em;
    }

    .opportunity-owner-info {
        flex: 1;
    }

    .opportunity-owner-name {
        font-weight: 600;
        color: #1e293b;
        font-size: 0.95em;
    }

    .opportunity-owner-title {
        font-size: 0.8em;
        color: #64748b;
        margin-top: 2px;
    }

    .product-badge {
        display: inline-block;
        padding: 4px 8px;
        background: #e0f2fe;
        color: #0277bd;
        border-radius: 12px;
        font-size: 0.8em;
        font-weight: 500;
        margin: 2px;
    }
    .opportunity-actions {
        display: flex;
        justify-content: flex-end;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #e2e8f0;
    }
    
    .edit-btn {
        background: #2563EB;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9em;
        font-weight: 500;
        transition: all 0.3s ease;
    }
    
    .edit-btn:hover {
        background: #1d4ed8;
        transform: translateY(-1px);
    }
    
    .edit-amount-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    
    .edit-amount-input {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }
    
    .edit-amount-input label {
        font-weight: 600;
        color: #374151;
        font-size: 0.9em;
    }
    
    .edit-amount-input input {
        padding: 10px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 1em;
        background: #f9fafb;
    }
    
    .edit-amount-input input:focus {
        outline: none;
        border-color: #2563EB;
        background: white;
    }
    
    .edit-amount-buttons {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 10px;
    }
    
    .edit-amount-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s ease;
    }
    
    .edit-amount-btn-primary {
        background: #2563EB;
        color: white;
    }
    
    .edit-amount-btn-primary:hover {
        background: #1d4ed8;
    }
    
    .edit-amount-btn-secondary {
        background: #6b7280;
        color: white;
    }
    
    .edit-amount-btn-secondary:hover {
        background: #4b5563;
    }

    /* Filter Styles */
    .filter-section {
        background: white;
        border-radius: 12px;
        padding: 20px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        border: 1px solid #e2e8f0;
    }

    .filter-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #f1f5f9;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .filter-header:hover {
        background: #f8fafc;
        border-radius: 8px;
        padding: 10px;
        margin: -10px -10px 5px -10px;
    }

    .filter-header-left {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .filter-header h3 {
        margin: 0;
        color: #1e293b;
        font-size: 1.1em;
        font-weight: 600;
    }

    .filter-header-icon {
        font-size: 1.2em;
        color: #2563EB;
    }

    .filter-toggle-arrow {
        font-size: 1.2em;
        color: #64748b;
        transition: transform 0.3s ease;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
        user-select: none;
    }

    .filter-toggle-arrow:hover {
        background: #e2e8f0;
        color: #2563EB;
    }

    .filter-toggle-arrow.collapsed {
        transform: rotate(-90deg);
    }

    .filter-content {
        transition: all 0.3s ease;
        overflow: hidden;
        max-height: 1000px; /* Set a reasonable max-height for expanded state */
    }

    .filter-content.collapsed {
        max-height: 0;
        opacity: 0;
        margin: 0;
        padding: 0;
    }

    /* Default collapsed state for all filter sections */
    .filter-content {
        max-height: 0;
        opacity: 0;
        margin: 0;
        padding: 0;
    }

    .filter-content.expanded {
        max-height: 1000px;
        opacity: 1;
        margin: initial;
        padding: initial;
    }

    .filter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
    }

    .filter-item {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .filter-label {
        font-size: 0.85em;
        color: #64748b;
        font-weight: 500;
        margin-bottom: 2px;
    }

    .filter-input {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 0.9em;
        background: #f9fafb;
        transition: all 0.3s ease;
    }

    .filter-input:focus {
        outline: none;
        border-color: #2563EB;
        background: white;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .filter-select {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 0.9em;
        background: #f9fafb;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .filter-select:focus {
        outline: none;
        border-color: #2563EB;
        background: white;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .filter-actions {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        align-items: center;
        padding-top: 15px;
        border-top: 1px solid #e2e8f0;
    }

    .filter-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9em;
        font-weight: 500;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .filter-btn-primary {
        background: #2563EB;
        color: white;
    }

    .filter-btn-primary:hover {
        background: #1d4ed8;
        transform: translateY(-1px);
    }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Hamburger Menu Styles */
        .hamburger-menu {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
        }
        
        .hamburger-btn {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 4px;
        }
        
        .hamburger-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border-color: #cbd5e1;
        }
        
        .hamburger-line {
            width: 20px;
            height: 2px;
            background: #475569;
            transition: all 0.3s ease;
            border-radius: 1px;
        }
        
        .hamburger-btn.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        
        .hamburger-btn.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }
        
        .hamburger-btn.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(5px);
        }
        
        .menu-content {
            position: fixed;
            top: 0;
            left: -350px;
            width: 350px;
            height: 100%;
            background: white;
            box-shadow: 4px 0 20px rgba(0,0,0,0.2);
            transition: left 0.3s ease;
            overflow-y: auto;
            z-index: 1002;
        }
        
        .menu-content.active {
            left: 0;
        }
        
        .menu-header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .menu-header h3 {
            margin: 0;
            font-size: 1.3em;
        }
        
        .pipeline-container {
            display: none;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            min-height: 100vh;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
        }
        
        .pipeline-header {
            text-align: center;
            color: #1e293b;
            margin-bottom: 30px;
        }
        
        .pipeline-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #1e293b;
        }
        
        .pipeline-header p {
            font-size: 1.1em;
            color: #64748b;
            margin: 0;
        }
        
        .pipeline-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .pipeline-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #2563EB;
            transition: all 0.3s ease;
        }
        
        .pipeline-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .pipeline-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .customer-name {
            font-size: 1.3em;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }
        
        .pipeline-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .status-prospecting {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-qualified {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .status-proposal {
            background: #fce7f3;
            color: #be185d;
        }
        
        .status-negotiation {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-closed {
            background: #dcfce7;
            color: #166534;
        }
        
        .pipeline-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .pipeline-detail-item {
            display: flex;
            flex-direction: column;
        }
        
        .pipeline-detail-label {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 4px;
            font-weight: 500;
        }
        
        .pipeline-detail-value {
            font-size: 1em;
            color: #1e293b;
            font-weight: 500;
        }
        
        .pipeline-amount {
            font-size: 1.4em;
            font-weight: 700;
            color: #059669;
            text-align: right;
        }
        
        .pipeline-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .pipeline-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .pipeline-btn-primary {
            background: #2563EB;
            color: white;
        }
        
        .pipeline-btn-primary:hover {
            background: #1d4ed8;
        }
        
        .pipeline-btn-secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        
        .pipeline-btn-secondary:hover {
            background: #e2e8f0;
        }
        
        .pipeline-detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .pipeline-detail-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 3px solid #2563EB;
        }
        
        .pipeline-detail-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .pipeline-detail-card-header h4 {
            margin: 0;
            color: #1e293b;
            font-size: 1.1em;
        }
        
        .pipeline-detail-card-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .pipeline-detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
        }
        
        .detail-label {
            font-weight: 500;
            color: #64748b;
            font-size: 0.9em;
        }
        
        .detail-value {
            color: #1e293b;
            font-weight: 500;
        }
        
        .detail-value.amount {
            color: #059669;
            font-weight: 600;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .summary-stat {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .summary-stat-label {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 5px;
        }
        
        .summary-stat-value {
            font-size: 1.2em;
            font-weight: 600;
            color: #1e293b;
        }
        
        .menu-body {
            padding: 20px;
        }
        
        .menu-section {
            margin-bottom: 25px;
        }
        
        .menu-section h4 {
            color: #333;
            margin: 0 0 15px 0;
            font-size: 1.1em;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 8px;
        }
        
        .menu-section {
            margin-bottom: 25px;
        }
        
        .menu-section h4 {
            color: #333;
            margin: 0 0 15px 0;
            font-size: 1.1em;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 8px;
        }
        .menu-btn {
            display: block;
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 8px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 14px;
        }
        
        .menu-btn:hover {
            transform: translateX(5px);
        }
        
        .menu-btn-primary {
            background: linear-gradient(135deg, #475569 0%, #64748b 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(71, 85, 105, 0.3);
        }
        
        .menu-btn-primary:hover {
            background: linear-gradient(135deg, #334155 0%, #475569 100%);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(71, 85, 105, 0.4);
        }
        
        .menu-btn-secondary {
            background: linear-gradient(135deg, #94a3b8 0%, #cbd5e1 100%);
            color: #1e293b;
            box-shadow: 0 2px 8px rgba(148, 163, 184, 0.3);
        }
        
        .menu-btn-secondary:hover {
            background: linear-gradient(135deg, #64748b 0%, #94a3b8 100%);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(148, 163, 184, 0.4);
        }
        
        .menu-btn-google {
            background: linear-gradient(135deg, #0ea5e9 0%, #38bdf8 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(14, 165, 233, 0.3);
        }
        
        .menu-btn-google:hover {
            background: linear-gradient(135deg, #0284c7 0%, #0ea5e9 100%);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.4);
        }
        
        .menu-btn-google-green {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        .menu-btn-google-green:hover {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        
        .file-input-menu {
            padding: 10px 15px;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            margin-bottom: 8px;
            color: #64748b;
            font-weight: 500;
        }
        
        .file-input-menu:hover {
            border-color: #94a3b8;
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
            transform: translateX(5px);
            color: #475569;
        }
        
        .header {
            text-align: center;
            color: #1e293b;
            margin-bottom: 30px;
            margin-top: 20px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            margin: 10px 0;
            opacity: 0.9;
        }
        
        .control-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .control-panel h3 {
            margin: 0 0 15px 0;
            color: #333;
        }
        
        .upload-section {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        .file-input {
            padding: 10px 15px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-input:hover {
            border-color: #667eea;
            background: #e8f0fe;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #2563EB;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .data-input {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .data-input textarea {
            width: 100%;
            height: 120px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            resize: vertical;
        }
        
        .speedometer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .speedometer-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
            cursor: grab;
            position: relative;
            user-select: none;
        }
        
        .speedometer-card.dragging {
            cursor: grabbing;
            transform: rotate(5deg) scale(1.05);
            box-shadow: 0 12px 40px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .speedometer-card.drag-over {
            border: 2px dashed #3b82f6;
            background: #f0f9ff;
        }
        
        /* Mail Settings Styles */
        .mail-settings-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .mail-settings-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .mail-settings-card h3 {
            margin: 0 0 25px 0;
            color: #1e293b;
            font-size: 1.5rem;
        }
        
        .mail-settings-form {
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        .form-group small {
            display: block;
            margin-top: 5px;
            color: #6b7280;
            font-size: 12px;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }
        
        .checkbox-item span {
            font-weight: 500;
        }
        
        .mail-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }
        
        .mail-status {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e2e8f0;
        }
        
        .mail-status h4 {
            margin: 0 0 15px 0;
            color: #1e293b;
        }
        
        .mail-status p {
            margin: 8px 0;
            color: #475569;
        }
        
        .mail-status strong {
            color: #1e293b;
        }
        
        .speedometer-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            border-color: #3b82f6;
        }
        
        .speedometer-card.inactive-card {
            opacity: 0.6;
            filter: grayscale(50%);
        }
        
        .speedometer-card.inactive-card:hover {
            transform: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-color: rgba(255,255,255,0.2);
        }
        
        .speedometer-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10b981, #3b82f6, #f59e0b, #ef4444);
            border-radius: 16px 16px 0 0;
        }
        
        .speedometer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .speedometer-header h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
        }
        
        .performance-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .performance-excellent {
            background: #dcfce7;
            color: #166534;
        }
        
        .performance-good {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .performance-average {
            background: #fef3c7;
            color: #92400e;
        }
        
        .performance-poor {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .speedometer-gauge {
            text-align: center;
            margin: 20px 0;
        }
        
        .gauge-svg {
            width: 100%;
            max-width: 200px;
            height: auto;
        }
        
        .percentage-text {
            font-size: 24px;
            font-weight: 700;
            fill: #1f2937;
        }
        
        .target-text {
            font-size: 12px;
            fill: #6b7280;
            font-weight: 500;
        }
        
        .speedometer-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 4px;
            font-weight: 500;
        }
        
        .stat-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
        }
        
        .speedometer-footer {
            text-align: center;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #f1f5f9;
        }
        
        .detail-link {
            color: #3b82f6;
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        .detail-link:hover {
            color: #1d4ed8;
        }
        
        /* Yıllık Dashboard özel stilleri */
        #yearlyDashboardContainer .header {
            text-align: center;
            color: #1e293b;
            margin-bottom: 30px;
            margin-top: 20px;
        }
        
        #yearlyDashboardContainer .header h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        #yearlyDashboardContainer .header p {
            font-size: 1.2em;
            margin: 10px 0;
            opacity: 0.9;
        }
        
        #yearlyDashboardContainer .summary-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        #yearlyDashboardContainer .speedometer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-top: 30px;
        }
        
        .edit-icon {
            background: transparent;
            color: #2563EB;
            border: none;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            margin-left: 10px;
            opacity: 0;
            transform: scale(0.8);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }
        
        .speedometer-card:hover .edit-icon {
            opacity: 1;
            transform: scale(1);
        }
        
        .edit-icon:hover {
            background: #2563EB;
            color: white;
            transform: scale(1.1);
        }
        

        

        
        .detail-value.editable {
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 6px;
            position: relative;
        }
        
        .detail-value.editable:hover {
            background: #F0F9FF;
            color: #2563EB;
        }
        
        .detail-value.editing {
            background: #fff3cd;
            border: 2px solid #ffc107;
            position: relative;
            z-index: 1000;
        }
        
        .detail-value input {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 6px 10px;
            font-size: 16px;
            width: 100px;
            text-align: center;
            margin-right: 5px;
        }
        
        .sales-source-chart {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }
        
        .sales-source-chart canvas {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .detail-value .edit-buttons {
            display: inline-flex;
            gap: 3px;
            vertical-align: middle;
        }
        
        .detail-value .edit-buttons button {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 3px 6px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 20px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .detail-value .edit-buttons button:hover {
            background: #218838;
        }
        .detail-value .edit-buttons .cancel-btn {
            background: #6c757d;
        }
        
        .detail-value .edit-buttons .cancel-btn:hover {
            background: #5a6268;
        }
        
        /* Modal içindeki düzenleme alanları için özel stiller */
        .modal-content .detail-value.editing {
            max-width: 100%;
            overflow: visible;
        }
        
        .modal-content .detail-value input {
            max-width: 80px;
            font-size: 14px;
        }
        
        .modal-content .detail-value .edit-buttons {
            flex-shrink: 0;
        }
        .inline-edit {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 6px;
            margin: 2px 0;
        }
        
        .inline-edit input {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 14px;
            width: 100px;
        }
        
        .inline-edit button {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .inline-edit button:hover {
            background: #218838;
        }
        
        .inline-edit .cancel-btn {
            background: #6c757d;
        }
        
        .inline-edit .cancel-btn:hover {
            background: #5a6268;
        }
        
        .speedometer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
        }
        
        .speedometer-card::after {
            content: "📊 Detayları Göster";
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 0.8em;
            color: #666;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .speedometer-card:hover::after {
            opacity: 1;
        }
        
        .card-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .card-header h3 {
            margin: 0;
            font-size: 1.4em;
            color: #333;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .speedometer-container {
            position: relative;
            width: 280px;
            height: 180px;
            margin: 0 auto;
        }
        
        .speedometer-svg {
            width: 100%;
            height: 100%;
        }
        
        .stats-container {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .stat-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        .stat-value:hover {
            background: #e8f0fe;
            color: #667eea;
        }
        
        .stat-value.editing {
            background: #fff3cd;
            border: 2px solid #ffc107;
        }
        
        .achievement-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            color: white;
        }
        
        .badge-excellent { background: #108981; }
        .badge-good { background: #9CA3AF; color: white; }
        .badge-needs-improvement { background: #dc3545; }
        
        .summary-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            text-align: center;
        }
        
        .summary-stat {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .summary-stat h4 {
            margin: 0 0 10px 0;
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .summary-stat .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
        }
        
        .instructions {
            background: #e8f4f8;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
        }
        
        .instructions h4 {
            margin: 0 0 10px 0;
            color: #17a2b8;
        }
        
        .instructions ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .last-updated {
            text-align: center;
            color: #666;
            font-size: 0.9em;
            margin-top: 20px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 90%;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 15px;
        }

        .modal-title {
            font-size: 1.8em;
            color: #111827;
            font-weight: 600;
            margin: 0;
        }

        .close-btn {
            background: #f8f9fa;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #666;
        }

        .close-btn:hover {
            background: #dc3545;
            color: white;
            transform: scale(1.1);
        }

        .detail-section {
            margin-bottom: 25px;
        }

        .detail-section h3 {
            color: #111827;
            font-size: 1.3em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .detail-item {
            background: #F0F9FF;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #2563EB;
        }

        .detail-item h4 {
            margin: 0 0 8px 0;
            color: #666;
            font-size: 0.9em;
            /* text-transform: uppercase; */
        }

        .detail-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
        }
        
        .monthly-chart {
            background: #f8f9fa;
            padding: 40px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .chart-bars {
            display: flex;
            align-items: end;
            gap: 40px;
            height: 150px;
            padding: 20px 10px;
            justify-content: space-around;
            overflow: visible;
        }

        .chart-bar {
            background: linear-gradient(180deg, #7f5af0 0%, #2cb67d 100%);
            border-radius: 16px 16px 0 0;
            min-width: 38px;
            position: relative;
            transition: all 0.3s cubic-bezier(.4,2,.6,1);
            box-shadow: 0 4px 24px 0 rgba(127,90,240,0.10), 0 1.5px 0 #2cb67d;
            animation: barFadeIn 0.7s cubic-bezier(.4,2,.6,1) both;
        }
        .chart-bar:hover {
            opacity: 0.95;
            transform: scale(1.15);
            box-shadow: 0 8px 32px 0 rgba(127,90,240,0.18), 0 2px 0 #2cb67d;
            z-index: 2;
        }
        .chart-bars .chart-bar:nth-child(1) { animation-delay: 0.05s; }
        .chart-bars .chart-bar:nth-child(2) { animation-delay: 0.10s; }
        .chart-bars .chart-bar:nth-child(3) { animation-delay: 0.15s; }
        .chart-bars .chart-bar:nth-child(4) { animation-delay: 0.20s; }
        .chart-bars .chart-bar:nth-child(5) { animation-delay: 0.25s; }
        .chart-bars .chart-bar:nth-child(6) { animation-delay: 0.30s; }

        @keyframes barFadeIn {
          from { opacity: 0; transform: translateY(40px); }
          to   { opacity: 1; transform: translateY(0); }
        }

        .bar-value {
            position: absolute;
            top: -38px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            color: #222;
            font-weight: 700;
            font-size: 1em;
            padding: 3px 10px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(127,90,240,0.10);
            margin-bottom: 6px;
            white-space: nowrap;
            width: max-content;
            z-index: 3;
        }

        .bar-label {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            color: #666;
            font-weight: 500;
            white-space: nowrap;
            width: max-content;
        }

        .performance-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .indicator {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            color: white;
        }

        .indicator-excellent { background: #108981; }
        .indicator-good { background: #9CA3AF; color: white; }
        .indicator-warning { background: #fd7e14; }
        .indicator-danger { background: #dc3545; }

        .target-progress {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .progress-bar {
            background: #e9ecef;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #108981, #2563EB);
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 0.8em;
        }

        /* Ekip Kartları Stilleri */
        .team-section {
            margin-top: 40px;
            padding: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .team-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .team-header h2 {
            font-size: 2.2em;
            color: #1e293b;
            margin-bottom: 10px;
        }
        
        .team-header p {
            font-size: 1.1em;
            color: #64748b;
            margin: 0;
        }
        
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .team-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #2563EB;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .team-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .team-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .team-member-name {
            font-size: 1.3em;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }
        
        .team-performance-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .performance-excellent {
            background: #d1fae5;
            color: #065f46;
        }
        
        .performance-good {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .performance-average {
            background: #fef3c7;
            color: #92400e;
        }
        
        .performance-poor {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .team-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .team-stat-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .team-stat-label {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 5px;
        }
        
        .team-stat-value {
            font-size: 1.2em;
            font-weight: 600;
            color: #1e293b;
        }
        
        .team-progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .team-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #dc3545 0%, #ffc107 50%, #28a745 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        /* Opportunity Card Styles */
        .opportunity-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .opportunity-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #2563EB;
        }
        
        .opportunity-status.proposal {
            background: #fce7f3;
            color: #be185d;
        }
        
        .opportunity-status.qualified {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .opportunity-status.prospecting {
            background: #fef3c7;
            color: #92400e;
        }
        
        .opportunity-status.negotiation {
            background: #fef3c7;
            color: #92400e;
        }
        
        .opportunity-status.closed-won {
            background: #dcfce7;
            color: #166534;
        }
        
        .opportunity-status.closed-lost {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .opportunity-status.closed {
            background: #dcfce7;
            color: #166534;
        }
        
        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .opportunities-container {
            max-height: 300px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f1f5f9;
        }
        
        .opportunities-container::-webkit-scrollbar {
            width: 6px;
        }
        
        .opportunities-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        
        .opportunities-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        .opportunities-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Modal Performans Detay Stilleri */
        .performance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .performance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #2563EB;
        }
        
        .performance-label {
            font-weight: 600;
            color: #64748b;
        }
        
        .performance-value {
            font-weight: 700;
            color: #1e293b;
            font-size: 1.1em;
        }
        
        @media (max-width: 768px) {
            .speedometer-grid {
                grid-template-columns: 1fr;
            }
            
            .team-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .menu-content {
                width: 300px;
            }
        }

        @media (max-width: 480px) {
            .summary-stats {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .menu-content {
                width: 280px;
            }
        }

        .header-flex {
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }
        .header-center {
          flex: 0 1 auto;
          text-align: center;
          margin: 0 auto;
          width: 100%;
        }
        .header-side {
          flex: 0 0 auto;
        }
        @media (max-width: 600px) {
          .header-center {
            font-size: 1em;
          }
        }
    </style>
    <style>
    @media (max-width: 600px) {
      .modal-content {
        max-width: 98vw !important;
        min-width: unset !important;
        padding: 10px !important;
        border-radius: 10px !important;
      }
      .modal-header h2, .modal-title {
        font-size: 1.2em !important;
      }
      .modal-header .close-btn {
        top: 8px !important;
        right: 8px !important;
        width: 32px !important;
        height: 32px !important;
        font-size: 1.3em !important;
      }
      #loginForm > div, #loginForm input, #loginForm button {
        max-width: 98vw !important;
        min-width: unset !important;
        font-size: 1em !important;
      }
      .dashboard-container, .pipeline-container {
        padding: 5px !important;
      }
      .speedometer-grid, .team-grid, .summary-stats {
        grid-template-columns: 1fr !important;
        gap: 10px !important;
      }
      .speedometer-card, .team-card, .summary-card {
        padding: 10px !important;
        border-radius: 10px !important;
      }
      .header h1 {
        font-size: 1.1em !important;
      }
    }
    </style>
    <style>
    .pipeline-summary-stats {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
      margin-top: 10px;
    }
    .pipeline-summary-stat {
      background: #f8fafc;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      border: 1px solid #e2e8f0;
      font-size: 1.1em;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .pipeline-summary-stat-label {
      font-size: 0.95em;
      color: #64748b;
      margin-bottom: 5px;
    }
    .pipeline-summary-stat-value {
      font-size: 1.3em;
      font-weight: 700;
      color: #1e293b;
    }
    </style>
    <style>
    .header h1,
    .pipeline-header h1 {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 2.5em;
      font-weight: 800;
      color: #1e293b;
      margin: 0 0 10px 0;
      text-shadow: none;
    }
    </style>
    <style>
    .person-title {
        font-size: 1.05em;
        font-weight: 500;
        color: #7f5af0;
        letter-spacing: 0.5px;
        margin-bottom: 2px;
        margin-top: 0px;
        text-align: center;
        text-transform: capitalize;
    }
    .card-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 10px;
    }
    </style>
    <style>
    @media (max-width: 600px) {
      .stats-container, .team-stats {
        flex-direction: column !important;
        display: flex !important;
        gap: 8px !important;
        padding: 8px !important;
      }
      .stat-item, .team-stat-item {
        min-width: unset !important;
        margin: 0 0 6px 0 !important;
        padding: 6px 4px !important;
        font-size: 0.98em !important;
      }
      .monthly-chart {
        padding: 10px !important;
      }
      .chart-bars {
        gap: 10px !important;
        padding: 8px 2px !important;
      }
      .chart-bar {
        min-width: 18px !important;
      }
      .bar-value {
        font-size: 0.9em !important;
        padding: 2px 5px !important;
      }
    }

    /* Stratejik Fırsatlar Styles */
    .strategic-opportunities-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .strategic-opportunity-card {
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #2563EB;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .strategic-opportunity-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #10b981, #3b82f6, #f59e0b, #ef4444);
        border-radius: 12px 12px 0 0;
    }
    
    .strategic-opportunity-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        border-color: #3b82f6;
    }
    
    .strategic-opportunity-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
    }
    
    .strategic-opportunity-title {
        font-size: 1.2em;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
        cursor: pointer;
        transition: color 0.3s ease;
    }
    
    .strategic-opportunity-title:hover {
        color: #3b82f6;
    }
    
    .strategic-opportunity-price {
        font-size: 1.4em;
        font-weight: 700;
        color: #059669;
        background: #f0fdf4;
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid #bbf7d0;
        box-shadow: 0 2px 4px rgba(5, 150, 105, 0.1);
    }
    
    .strategic-opportunity-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 20px;
    }
    
    .strategic-opportunity-detail {
        display: flex;
        flex-direction: column;
        background: white;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }
    
    .strategic-opportunity-detail-label {
        font-size: 0.85em;
        color: #64748b;
        font-weight: 500;
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .strategic-opportunity-detail-value {
        font-size: 1em;
        color: #1e293b;
        font-weight: 500;
    }
    
    .strategic-opportunity-owner {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 15px;
        background: white;
        border-radius: 10px;
        border-left: 4px solid #2563EB;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .strategic-opportunity-owner-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #2563EB, #1d4ed8);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 1em;
        box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
    }
    .strategic-opportunity-owner-info {
        flex: 1;
    }
    
    .strategic-opportunity-owner-name {
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 2px;
    }
    
    .strategic-opportunity-owner-title {
        font-size: 0.85em;
        color: #64748b;
    }
    
    .strategic-opportunity-status {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85em;
        font-weight: 500;
        text-align: center;
        margin-top: 10px;
    }
    
    .status-evaluation {
        background: #fef3c7;
        color: #92400e;
        border: 1px solid #fbbf24;
    }
    
    .status-proposal {
        background: #dbeafe;
        color: #1e40af;
        border: 1px solid #60a5fa;
    }
    
    .status-negotiation {
        background: #fce7f3;
        color: #be185d;
        border: 1px solid #f472b6;
    }
    
    .status-closing {
        background: #dcfce7;
        color: #166534;
        border: 1px solid #4ade80;
    }
    
    .strategic-opportunity-products {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 20px;
    }
    
    .product-tag {
        display: inline-block;
        padding: 6px 12px;
        background: linear-gradient(135deg, #e0f2fe, #b3e5fc);
        color: #0277bd;
        border-radius: 20px;
        font-size: 0.85em;
        font-weight: 500;
        border: 1px solid #81d4fa;
        transition: all 0.3s ease;
    }
    
    .product-tag:hover {
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(2, 119, 189, 0.2);
    }
    
    .status-input {
        padding: 6px 10px;
        border-radius: 6px;
        border: 1px solid #d1d5db;
        font-size: 0.9em;
        background: white;
        width: 100%;
        transition: all 0.3s ease;
        box-sizing: border-box;
    }
    
    .status-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        background: #f8fafc;
    }
    
    .status-input:hover {
        border-color: #9ca3af;
    }
    
    .strategic-btn:hover {
        background: #2563eb !important;
        transform: scale(1.05);
    }
    
    .remove-strategic-btn:hover {
        background: #b91c1c !important;
        transform: scale(1.05);
    }
    
    .edit-strategic-btn:hover {
        background: #2563eb !important;
        transform: scale(1.05);
    }
    
    .edit-strategic-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    
    .edit-strategic-input {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }
    
    .edit-strategic-input label {
        font-weight: 600;
        color: #374151;
        font-size: 0.9em;
    }
    
    .edit-strategic-input input,
    .edit-strategic-input select {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 0.9em;
        transition: border-color 0.3s ease;
    }
    
    .edit-strategic-input input:focus,
    .edit-strategic-input select:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .edit-strategic-buttons {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 20px;
    }
    
    .edit-strategic-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        font-size: 0.9em;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .edit-strategic-btn-secondary {
        background: #6b7280;
        color: white;
    }
    
    .edit-strategic-btn-primary {
        background: #3b82f6;
        color: white;
    }
    
    .edit-strategic-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    /* Temmuz Commitment Styles */
    .opportunity-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .opportunity-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #2563EB;
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .opportunity-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
    }

    .opportunity-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
    }

    .opportunity-title {
        font-size: 1.2em;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
        line-height: 1.3;
    }

    .opportunity-amount {
        font-size: 1.3em;
        font-weight: 700;
        color: #059669;
        text-align: right;
    }

    .opportunity-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-bottom: 15px;
    }

    .opportunity-detail {
        display: flex;
        flex-direction: column;
    }

    .opportunity-detail-label {
        font-size: 0.85em;
        color: #64748b;
        margin-bottom: 4px;
        font-weight: 500;
    }

    .opportunity-detail-value {
        font-size: 1em;
        color: #1e293b;
        font-weight: 500;
    }

    .opportunity-owner {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px;
        background: #f8fafc;
        border-radius: 8px;
        border-left: 3px solid #2563EB;
    }

    .opportunity-owner-icon {
        width: 32px;
        height: 32px;
        background: #2563EB;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.9em;
    }

    .opportunity-owner-info {
        flex: 1;
    }

    .opportunity-owner-name {
        font-weight: 600;
        color: #1e293b;
        font-size: 0.95em;
    }

    .opportunity-owner-title {
        font-size: 0.8em;
        color: #64748b;
        margin-top: 2px;
    }

    .product-badge {
        display: inline-block;
        padding: 4px 8px;
        background: #e0f2fe;
        color: #0277bd;
        border-radius: 12px;
        font-size: 0.8em;
        font-weight: 500;
        margin: 2px;
    }
    
    .opportunity-actions {
        display: flex;
        justify-content: flex-end;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #e2e8f0;
    }
    
    .edit-btn {
        background: #2563EB;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9em;
        font-weight: 500;
        transition: all 0.3s ease;
    }
    
    .edit-btn:hover {
        background: #1d4ed8;
        transform: translateY(-1px);
    }
    
    .edit-amount-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    .edit-amount-input {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }
    
    .edit-amount-input label {
        font-weight: 600;
        color: #374151;
        font-size: 0.9em;
    }
    
    .edit-amount-input input {
        padding: 10px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 1em;
        background: #f9fafb;
    }
    
    .edit-amount-input input:focus {
        outline: none;
        border-color: #2563EB;
        background: white;
    }
    
    .edit-amount-buttons {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 10px;
    }
    
    .edit-amount-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s ease;
    }
    
    .edit-amount-btn-primary {
        background: #2563EB;
        color: white;
    }
    
    .edit-amount-btn-primary:hover {
        background: #1d4ed8;
    }
    
    .edit-amount-btn-secondary {
        background: #6b7280;
        color: white;
    }
    
    .edit-amount-btn-secondary:hover {
        background: #4b5563;
    }

    /* Filter Styles */
    .filter-section {
        background: white;
        border-radius: 12px;
        padding: 20px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        border: 1px solid #e2e8f0;
    }

    .filter-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #f1f5f9;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .filter-header:hover {
        background: #f8fafc;
        border-radius: 8px;
        padding: 10px;
        margin: -10px -10px 5px -10px;
    }

    .filter-header-left {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .filter-header h3 {
        margin: 0;
        color: #1e293b;
        font-size: 1.1em;
        font-weight: 600;
    }

    .filter-header-icon {
        font-size: 1.2em;
        color: #2563EB;
    }

    .filter-toggle-arrow {
        font-size: 1.2em;
        color: #64748b;
        transition: transform 0.3s ease;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
        user-select: none;
    }

    .filter-toggle-arrow:hover {
        background: #e2e8f0;
        color: #2563EB;
    }

    .filter-toggle-arrow.collapsed {
        transform: rotate(-90deg);
    }

    .filter-content {
        transition: all 0.3s ease;
        overflow: hidden;
        max-height: 1000px; /* Set a reasonable max-height for expanded state */
    }

    .filter-content.collapsed {
        max-height: 0;
        opacity: 0;
        margin: 0;
        padding: 0;
    }

    /* Default collapsed state for all filter sections */
    .filter-content {
        max-height: 0;
        opacity: 0;
        margin: 0;
        padding: 0;
    }

    .filter-content.expanded {
        max-height: 1000px;
        opacity: 1;
        margin: initial;
        padding: initial;
    }

    .filter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
    }

    .filter-item {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .filter-label {
        font-size: 0.85em;
        color: #64748b;
        font-weight: 500;
        margin-bottom: 2px;
    }
    .filter-input {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 0.9em;
        background: #f9fafb;
        transition: all 0.3s ease;
    }

    .filter-input:focus {
        outline: none;
        border-color: #2563EB;
        background: white;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .filter-select {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 0.9em;
        background: #f9fafb;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .filter-select:focus {
        outline: none;
        border-color: #2563EB;
        background: white;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .filter-actions {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        align-items: center;
        padding-top: 15px;
        border-top: 1px solid #e2e8f0;
    }

    .filter-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9em;
        font-weight: 500;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .filter-btn-primary {
        background: #2563EB;
        color: white;
    }

    .filter-btn-primary:hover {
        background: #1d4ed8;
        transform: translateY(-1px);
    }

    .filter-btn-secondary {
        background: #f1f5f9;
        color: #64748b;
        border: 1px solid #e2e8f0;
    }

    .filter-btn-secondary:hover {
        background: #e2e8f0;
        color: #475569;
    }

    .filter-results {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 0.9em;
        color: #64748b;
        margin-left: auto;
    }

    .filter-results-count {
        font-weight: 600;
        color: #2563EB;
    }

    .filter-clear {
        color: #ef4444;
        cursor: pointer;
        font-size: 0.8em;
        text-decoration: underline;
    }

    .filter-clear:hover {
        color: #dc2626;
    }



    @media (max-width: 768px) {
        .filter-grid {
            grid-template-columns: 1fr;
        }
        
        .filter-actions {
            flex-direction: column;
            align-items: stretch;
        }
        
        .filter-btn {
            justify-content: center;
        }
    }

    /* Module Export Menu Styles */
    .module-export-menu {
        position: relative;
        display: inline-block;
    }

    .module-export-btn {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        padding: 8px 16px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9em;
        color: #64748b;
        transition: all 0.2s ease;
        font-weight: 500;
        white-space: nowrap;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .module-export-btn:hover {
        background: #f1f5f9;
        color: #475569;
        border-color: #cbd5e1;
        transform: translateY(-1px);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .module-export-btn.active {
        background: #e2e8f0;
        color: #1e293b;
        border-color: #94a3b8;
    }

    /* Mobilde export butonlarını gizle */
    @media (max-width: 768px) {
        .module-export-menu {
            display: none;
        }
    }

    .module-export-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        min-width: 120px;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-5px);
        transition: all 0.2s ease;
        margin-top: 4px;
    }

    .module-export-dropdown.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

    .module-export-item {
        padding: 10px 16px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9em;
        color: #64748b;
        transition: all 0.2s ease;
        border-bottom: 1px solid #f1f5f9;
        font-weight: 500;
    }

    .module-export-item:last-child {
        border-bottom: none;
    }

    .module-export-item:hover {
        background: #f8fafc;
        color: #475569;
    }

    

    .module-export-item-icon {
        font-size: 1.3em;
        width: 24px;
        text-align: center;
        opacity: 0.8;
        transition: all 0.3s ease;
    }

    .module-export-item:hover .module-export-item-icon {
        opacity: 1;
        transform: scale(1.1);
    }

    .export-success-message {
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        padding: 16px 20px;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        z-index: 10000;
        font-weight: 600;
        font-size: 0.95em;
        animation: slideInRight 0.4s ease;
        backdrop-filter: blur(10px);
    }

    @keyframes slideInRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

    @media (max-width: 768px) {
        .opportunity-grid {
            grid-template-columns: 1fr;
        }
        
        .opportunity-details {
            grid-template-columns: 1fr;
        }
    }

    /* Manuel Giriş Modal Stilleri */
    .manual-input-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 10000;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .manual-input-content {
        background: white;
        border-radius: 8px;
        width: 90%;
        max-width: 1200px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    
    .manual-input-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid #eee;
        background: #f8f9fa;
        border-radius: 8px 8px 0 0;
    }
    
    .manual-input-header h3 {
        margin: 0;
        color: #333;
    }
    
    .close-btn {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #666;
    }
    
    .close-btn:hover {
        color: #333;
    }
    
    .manual-input-body {
        padding: 20px;
    }
    
    .input-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 1px solid #eee;
        border-radius: 8px;
        background: #fafafa;
    }
    
    .input-section h4 {
        margin: 0 0 15px 0;
        color: #333;
    }
    

    

    
    .export-btn {
        background: #17a2b8;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
    }
    
    .export-btn:hover {
        background: #138496;
    }

    </style>
</head>
<body>
    <!-- Hamburger Menu -->
    <div class="hamburger-menu">
        <button class="hamburger-btn" onclick="toggleMenu()">
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
        </button>
    </div>
    
    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay" onclick="closeMenu()"></div>
    
    <!-- Menu Content -->
            <div class="menu-content" id="menuContent">
            <div class="menu-header">
                <h3>Dashboard Menü</h3>
            </div>
            <div class="menu-body">
                                  <div class="menu-section">
                      <button class="menu-btn menu-btn-primary" onclick="showDashboard()">
                          📊 Temmuz Dashboard
                      </button>
                      <button class="menu-btn menu-btn-primary" onclick="showAugustDashboard()">
                          📊 Ağustos Dashboard
                      </button>
                      <button class="menu-btn menu-btn-primary" onclick="showSeptemberDashboard()">
                          📊 Eylül Dashboard
                      </button>
                      <button class="menu-btn menu-btn-primary" onclick="showYearlyDashboard()">
                          📈 Yıllık Dashboard
                      </button>
                </div>
                
            </div>
        </div>

    <div class="dashboard-container" id="dashboardContainer">
        <div class="header">
            <div class="header-flex">
                <div class="header-center">
                    <h1>Temmuz Performans Dashboard</h1>
                    <p>Temmuz 2025 Satış Hedefleri ve Gerçekleşen Satışlar</p>
                </div>
                <div class="header-side" id="userInfo" style="text-align: right; display: none; position: absolute; right: 0; top: 0;">
                    <div style="font-size: 0.9em; color: #6b7280; margin-bottom: 5px;">
                        Hoş geldiniz, <span id="userEmail"></span>
                    </div>
                    <button class="btn btn-secondary" onclick="logoutUser()" style="padding: 8px 16px; font-size: 0.8em;">
                        🚪 Çıkış Yap
                    </button>
                </div>
            </div>
        </div>
        

        
        <!-- Export Menu -->
        <div class="module-export-menu" style="position: absolute; top: 20px; right: 20px;">
            <button class="module-export-btn" onclick="toggleExportMenu('monthlyExport')">
                Export
                <span style="font-size: 0.8em;">▼</span>
            </button>
            <div class="module-export-dropdown" id="monthlyExport">
                <div class="module-export-item" onclick="exportMonthlyData('excel')">
                    <span class="module-export-item-icon">📊</span>
                    Excel (.xlsx)
                </div>
                <div class="module-export-item" onclick="exportMonthlyData('pdf')">
                    <span class="module-export-item-icon">📋</span>
                    PDF Raporu
                </div>
            </div>
        </div>
        

        
        <div class="summary-card" id="summaryCard">
            <div class="summary-stats" id="summaryStats">
            </div>
        </div>
        

        
        <div class="speedometer-grid" id="speedometerGrid">
        </div>
        
        <div class="last-updated" id="lastUpdated"></div>
    </div>




    <!-- Login Modal -->
    <div class="modal-overlay" id="loginModal" style="display: none; z-index:3000;">
        <div class="modal-content" style="max-width: 400px; position:relative; z-index:3001;">
            <div class="modal-header">
                <h2 class="modal-title">🔐 Giriş Yapın</h2>
                <button class="close-btn" onclick="closeLoginForm()" style="position:absolute;top:15px;right:15px;">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align:center; margin-bottom:18px; color:#2563EB; font-weight:500;">Düzenleme yapmak için yönetici girişi yapmalısınız.</div>
                <div id="loginForm">
                    <form onsubmit="loginUser(); return false;">
                        <div style="margin-bottom: 15px; max-width:320px; margin-left:auto; margin-right:auto;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Email:</label>
                            <input type="email" id="loginEmail" placeholder="email@example.com" style="width: 100%; max-width:320px; margin-left: auto; margin-right: auto; display: block; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background:#f1f6ff; font-size: 1em; margin-bottom: 15px; box-sizing: border-box;" required>
                        </div>
                        <div style="margin-bottom: 15px; max-width:320px; margin-left:auto; margin-right:auto;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Şifre:</label>
                            <input type="password" id="loginPassword" placeholder="Şifreniz" style="width: 100%; max-width:320px; margin-left: auto; margin-right: auto; display: block; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background:#f1f6ff; font-size: 1em; margin-bottom: 15px; box-sizing: border-box;" required>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%; max-width:320px; margin-left:auto; margin-right:auto; display:block; margin-bottom: 10px;">🔐 Giriş Yap</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Detaylı Analiz</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody">
            </div>
        </div>
    </div>
    <!-- Ağustos Dashboard Container -->
    <div class="dashboard-container" id="augustDashboardContainer" style="display: none;">
        <div class="header">
            <div class="header-flex">
                <div class="header-center">
                    <h1>Ağustos Performans Dashboard</h1>
                    <p>Ağustos 2025 Satış Hedefleri ve Gerçekleşen Satışlar</p>
                </div>
            </div>
        </div>
        
        <!-- Export Menu -->
        <div class="module-export-menu" style="position: absolute; top: 20px; right: 20px;">
            <button class="module-export-btn" onclick="toggleExportMenu('augustExport')">
                Export
                <span style="font-size: 0.8em;">▼</span>
            </button>
            <div class="module-export-dropdown" id="augustExport">
                <div class="module-export-item" onclick="exportAugustData('excel')">
                    <span class="module-export-item-icon">📊</span>
                    Excel (.xlsx)
                </div>
                <div class="module-export-item" onclick="exportAugustData('pdf')">
                    <span class="module-export-item-icon">📋</span>
                    PDF Raporu
                </div>
            </div>
        </div>
        
        <!-- Ağustos Özet İstatistikler -->
        <div class="summary-card" id="augustSummaryCard">
            <div class="summary-stats" id="augustSummaryStats"></div>
        </div>
        

        
        <!-- Ağustos Speedometer Grid -->
        <div class="speedometer-grid" id="augustSpeedometerGrid"></div>
    </div>

    <!-- Eylül Dashboard Container -->
    <div class="dashboard-container" id="septemberDashboardContainer" style="display: none;">
        <div class="header">
            <div class="header-flex">
                <div class="header-center">
                    <h1>Eylül Performans Dashboard</h1>
                    <p>Eylül 2025 Satış Hedefleri ve Gerçekleşen Satışlar</p>
                </div>
            </div>
        </div>

        <!-- Export Menu -->
        <div class="module-export-menu" style="position: absolute; top: 20px; right: 20px;">
            <button class="module-export-btn" onclick="toggleExportMenu('septemberExport')">
                Export
                <span style="font-size: 0.8em;">▼</span>
            </button>
            <div class="module-export-dropdown" id="septemberExport">
                <div class="module-export-item" onclick="exportSeptemberData('excel')">
                    <span class="module-export-item-icon">📊</span>
                    Excel (.xlsx)
                </div>
                <div class="module-export-item" onclick="exportSeptemberData('pdf')">
                    <span class="module-export-item-icon">📋</span>
                    PDF Raporu
                </div>
            </div>
        </div>

        <!-- Eylül Özet İstatistikler -->
        <div class="summary-card" id="septemberSummaryCard">
            <div class="summary-stats" id="septemberSummaryStats"></div>
        </div>

        <!-- Eylül Speedometer Grid -->
        <div class="speedometer-grid" id="septemberSpeedometerGrid"></div>
    </div>

    <!-- Yıllık Dashboard Container -->
    <div class="dashboard-container" id="yearlyDashboardContainer" style="display: none;">
        <div class="header">
            <div class="header-flex">
                <div class="header-center">
                    <h1>Yıllık Satış Dashboard</h1>
                    <p>Satış Ekibinin Yıllık Performans Analizi</p>
                </div>
            </div>
        </div>
        

        
        <!-- Export Menu -->
        <div class="module-export-menu" style="position: absolute; top: 20px; right: 20px;">
            <button class="module-export-btn" onclick="toggleExportMenu('yearlyExport')">
                Export
                <span style="font-size: 0.8em;">▼</span>
            </button>
            <div class="module-export-dropdown" id="yearlyExport">
                <div class="module-export-item" onclick="exportYearlyData('excel')">
                    <span class="module-export-item-icon">📊</span>
                    Excel (.xlsx)
                </div>
                <div class="module-export-item" onclick="exportYearlyData('pdf')">
                    <span class="module-export-item-icon">📋</span>
                    PDF Raporu
                </div>
            </div>
        </div>
        
        <!-- Yıllık Özet İstatistikler -->
        <div class="summary-card" id="yearlySummaryCard">
            <div class="summary-stats" id="yearlySummaryStats"></div>
        </div>
        
        <!-- Satış Kaynağı Dağılım Grafiği -->
        <div class="summary-card sales-source-distribution-card" id="salesSourceDistributionCard">
            <div class="card-header">
                <div class="header-content">
                    <div class="header-left">
                        <h3>📊 Satış Kaynağına Göre Dağılım</h3>
                        <p>Yıl boyunca satış kaynaklarının satış yöneticileri arasındaki paylaşımı</p>
                    </div>
                </div>
                <button class="toggle-btn" onclick="toggleSalesSourceDistribution()" title="Aç/Kapat">
                    <span class="toggle-icon" id="salesSourceToggleIcon">▼</span>
                </button>
            </div>
            <div class="card-body" id="salesSourceCardBody">
                <!-- JavaScript ile doldurulacak -->
            </div>
        </div>
        
        <!-- Yıllık Speedometer Grid -->
        <div class="speedometer-grid" id="yearlySpeedometerGrid"></div>
    </div>



    <!-- Stratejik Fırsatlar Modülü -->
    <div class="dashboard-container" id="strategicOpportunitiesSection" style="display: none;">
        <div class="header">
            <div class="header-flex">
                <div class="header-center">
                    <h1>🎯 Stratejik Fırsatlar</h1>
                    <p>Önemli fırsatlar ve detayları</p>
                </div>
            </div>
        </div>
        

        
        <!-- Export Menu -->
        <div class="module-export-menu" style="position: absolute; top: 20px; right: 20px;">
            <button class="module-export-btn" onclick="toggleExportMenu('strategicExport')">
                Export
                <span style="font-size: 0.8em;">▼</span>
            </button>
            <div class="module-export-dropdown" id="strategicExport">
                <div class="module-export-item" onclick="exportStrategicData('excel')">
                    <span class="module-export-item-icon">📊</span>
                    Excel (.xlsx)
                </div>
                <div class="module-export-item" onclick="exportStrategicData('pdf')">
                    <span class="module-export-item-icon">📋</span>
                    PDF Raporu
                </div>
            </div>
        </div>
        
        <!-- Stratejik Fırsatlar Özet İstatistikler -->
        <div class="summary-card" id="strategicOpportunitiesSummaryCard">
            <div class="summary-stats" id="strategicOpportunitiesSummaryStats"></div>
        </div>
        
        <!-- Stratejik Fırsatlar Filtre Bölümü -->
        <div class="filter-section" id="strategicOpportunitiesFilterSection">
            <div class="filter-header" onclick="toggleFilterSection('strategicOpportunitiesFilterSection')">
                <div class="filter-header-left">
                    <span class="filter-header-icon">🔍</span>
                    <h3>Stratejik Fırsatlar Filtreleri</h3>
                </div>
                <span class="filter-toggle-arrow collapsed" id="strategicOpportunitiesFilterArrow">▶</span>
            </div>
            
            <div class="filter-content" id="strategicOpportunitiesFilterContent">
                <div class="filter-grid">
                    <div class="filter-item">
                        <label class="filter-label">Firma Adı</label>
                        <input type="text" class="filter-input" id="companySearch" placeholder="Firma adı girin...">
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Fırsat Sahibi</label>
                        <select class="filter-select" id="ownerFilter">
                            <option value="">Tümü</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Güncel Durum</label>
                        <input type="text" class="filter-input" id="statusFilter" placeholder="Durum ara...">
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Minimum Fiyat (₺)</label>
                        <input type="number" class="filter-input" id="minPrice" placeholder="0">
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Maksimum Fiyat (₺)</label>
                        <input type="number" class="filter-input" id="maxPrice" placeholder="Sınırsız">
                    </div>
                </div>
                
                <div class="filter-actions">
                    <div class="filter-results">
                        <span>Gösterilen: <span class="filter-results-count" id="strategicFilterCount">0</span> fırsat</span>
                        <span class="filter-clear" onclick="clearStrategicFilters()">Filtreleri Temizle</span>
                    </div>
                    <button class="filter-btn filter-btn-secondary" onclick="clearStrategicFilters()">
                        🗑️ Temizle
                    </button>
                    <button class="filter-btn filter-btn-primary" onclick="filterStrategicOpportunities()">
                        🔍 Filtrele
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Stratejik Fırsatlar Grid -->
        <div class="strategic-opportunities-grid" id="strategicOpportunitiesGrid"></div>
    </div>


    <script>
        // Hamburger Menu Functions
        function toggleMenu() {
            const btn = document.querySelector('.hamburger-btn');
            const overlay = document.getElementById('menuOverlay');
            const content = document.getElementById('menuContent');
            
            btn.classList.toggle('active');
            overlay.style.display = overlay.style.display === 'block' ? 'none' : 'block';
            content.classList.toggle('active');
        }
        
        function closeMenu() {
            const btn = document.querySelector('.hamburger-btn');
            const overlay = document.getElementById('menuOverlay');
            const content = document.getElementById('menuContent');
            
            btn.classList.remove('active');
            overlay.style.display = 'none';
            content.classList.remove('active');
        }
        
        // Filter Section Toggle Function
        function toggleFilterSection(sectionId) {
            const section = document.getElementById(sectionId);
            const content = section.querySelector('.filter-content');
            const arrow = section.querySelector('.filter-toggle-arrow');
            
            if (content.classList.contains('expanded')) {
                // Collapse the section
                content.classList.remove('expanded');
                arrow.classList.add('collapsed');
                arrow.textContent = '▶';
            } else {
                // Expand the section
                content.classList.add('expanded');
                arrow.classList.remove('collapsed');
                arrow.textContent = '▼';
            }
        }
        
        // Pipeline Data - 303 fırsat gömülü veriler
        let pipelineData = [
            {
                id: 1,
                customerName: "ABC Şirketi",
                contactPerson: "Fahri Aktoz",
                salesRep: "Ahmet Yılmaz",
                businessPartner: "Tech Solutions",
                amount: 150000,
                expectedClose: "2024-08-15",
                creator: "Mehmet Demir",
                creatorTeam: "Satış Ekibi A",
                registrationDate: "2024-07-01",
                productCode: "Netahsilat",
                erp: "SAP",
                opportunityType: "Yeni Müşteri",
                status: "Aktif"
            },
            {
                id: 2,
                customerName: "XYZ Holding",
                contactPerson: "Umut Karaerarslan",
                salesRep: "Fatma Kaya",
                businessPartner: "Digital Partners",
                amount: 250000,
                expectedClose: "2024-08-20",
                creator: "Ali Veli",
                creatorTeam: "Satış Ekibi B",
                registrationDate: "2024-07-02",
                productCode: "Netekstre",
                erp: "Oracle",
                opportunityType: "Mevcut Müşteri",
                status: "Aktif"
            },
            {
                id: 3,
                customerName: "DEF Teknoloji",
                contactPerson: "Hüseyin Çakmak",
                salesRep: "Ayşe Özkan",
                businessPartner: "Innovation Corp",
                amount: 180000,
                expectedClose: "2024-08-25",
                creator: "Can Yıldız",
                creatorTeam: "Satış Ekibi C",
                registrationDate: "2024-07-03",
                productCode: "PosRapor",
                erp: "Microsoft Dynamics",
                opportunityType: "Yeni Müşteri",
                status: "Aktif"
            },
            {
                id: 4,
                customerName: "GHI Finans",
                contactPerson: "Sebahat Çay",
                salesRep: "Zeynep Arslan",
                businessPartner: "Finance Solutions",
                amount: 320000,
                expectedClose: "2024-08-30",
                creator: "Burak Şahin",
                creatorTeam: "Satış Ekibi A",
                registrationDate: "2024-07-04",
                productCode: "TÖS",
                erp: "SAP",
                opportunityType: "Mevcut Müşteri",
                status: "Aktif"
            },
            {
                id: 5,
                customerName: "JKL Enerji",
                contactPerson: "Damla Kalemtaş",
                salesRep: "Elif Demir",
                businessPartner: "Energy Partners",
                amount: 200000,
                expectedClose: "2024-09-05",
                creator: "Deniz Kaya",
                creatorTeam: "Satış Ekibi B",
                registrationDate: "2024-07-05",
                productCode: "DBS",
                erp: "Oracle",
                opportunityType: "Yeni Müşteri",
                status: "Aktif"
            },
            {
                id: 6,
                customerName: "MNO Sağlık",
                contactPerson: "Güven Gürkan Salıkoç",
                salesRep: "Selin Yıldız",
                businessPartner: "Health Tech",
                amount: 280000,
                expectedClose: "2024-09-10",
                creator: "Emre Özkan",
                creatorTeam: "Satış Ekibi C",
                registrationDate: "2024-07-06",
                productCode: "Netahsilat",
                erp: "Microsoft Dynamics",
                opportunityType: "Mevcut Müşteri",
                status: "Aktif"
            },
            {
                id: 7,
                customerName: "PQR Eğitim",
                contactPerson: "Tuğçe Bugakaptan",
                salesRep: "Merve Arslan",
                businessPartner: "Education Solutions",
                amount: 160000,
                expectedClose: "2024-09-15",
                creator: "Kaan Şahin",
                creatorTeam: "Satış Ekibi A",
                registrationDate: "2024-07-07",
                productCode: "Netekstre",
                erp: "SAP",
                opportunityType: "Yeni Müşteri",
                status: "Aktif"
            },
            {
                id: 8,
                customerName: "STU Lojistik",
                contactPerson: "Egehan Öncü",
                salesRep: "Büşra Demir",
                businessPartner: "Logistics Corp",
                amount: 220000,
                expectedClose: "2024-09-20",
                creator: "Ozan Kaya",
                creatorTeam: "Satış Ekibi B",
                registrationDate: "2024-07-08",
                productCode: "PosRapor",
                erp: "Oracle",
                opportunityType: "Mevcut Müşteri",
                status: "Aktif"
            },
            {
                id: 9,
                customerName: "VWX İnşaat",
                contactPerson: "Doğukan Kalyoncu",
                salesRep: "Esra Yıldız",
                businessPartner: "Construction Tech",
                amount: 350000,
                expectedClose: "2024-09-25",
                creator: "Taha Özkan",
                creatorTeam: "Satış Ekibi C",
                registrationDate: "2024-07-09",
                productCode: "TÖS",
                erp: "Microsoft Dynamics",
                opportunityType: "Yeni Müşteri",
                status: "Aktif"
            },
            {
                id: 10,
                customerName: "YZA Turizm",
                contactPerson: "Betül Köse",
                salesRep: "İrem Arslan",
                businessPartner: "Tourism Solutions",
                amount: 190000,
                expectedClose: "2024-09-30",
                creator: "Arda Şahin",
                creatorTeam: "Satış Ekibi A",
                registrationDate: "2024-07-10",
                productCode: "DBS",
                erp: "SAP",
                opportunityType: "Mevcut Müşteri",
                status: "Aktif"
            }
        ];
        
        // Stratejik Fırsatlar Data
        let strategicOpportunitiesData = [];
        
        // Stratejik fırsatlar verilerini localStorage'dan yükle
        function loadStrategicOpportunitiesData() {
            const savedData = localStorage.getItem('strategicOpportunitiesData');
            if (savedData) {
                try {
                    strategicOpportunitiesData = JSON.parse(savedData);
                    console.log('Strategic opportunities data loaded from localStorage:', strategicOpportunitiesData.length, 'records');
                } catch (error) {
                    console.error('Error loading strategic opportunities data from localStorage:', error);
                    strategicOpportunitiesData = [];
                }
            } else {
                console.log('No strategic opportunities data in localStorage, starting with empty array');
                strategicOpportunitiesData = [];
            }
        }
        
        // Stratejik fırsatlar verilerini localStorage'a kaydet
        function saveStrategicOpportunitiesData() {
            localStorage.setItem('strategicOpportunitiesData', JSON.stringify(strategicOpportunitiesData));
            console.log('Strategic opportunities data saved to localStorage:', strategicOpportunitiesData.length, 'records');
            
            // Buluta da kaydet
            if (currentUser) {
                saveUserData();
            }
        }
        
        // Temmuz Commitment Data
        let julyCommitmentData = [];
        
        // Temmuz Commitment verilerini localStorage'dan yükle
        function loadJulyCommitmentData() {
            const savedData = localStorage.getItem('julyCommitmentData');
            if (savedData) {
                try {
                    julyCommitmentData = JSON.parse(savedData);
                    console.log('July commitment data loaded from localStorage:', julyCommitmentData.length, 'records');
                } catch (error) {
                    console.error('Error loading july commitment data from localStorage:', error);
                    julyCommitmentData = [];
                }
            } else {
                console.log('No july commitment data in localStorage, using empty array');
                julyCommitmentData = [];
            }
        }
        
        // Temmuz Commitment verilerini localStorage'a kaydet
        function saveJulyCommitmentData() {
            localStorage.setItem('julyCommitmentData', JSON.stringify(julyCommitmentData));
            console.log('July commitment data saved to localStorage:', julyCommitmentData.length, 'records');
            
            // Buluta da kaydet
            if (currentUser) {
                saveUserData();
            }
        }
        

        
        // Pipeline verilerini localStorage'dan yükle
        function loadPipelineData() {
            const savedData = localStorage.getItem('pipelineData');
            if (savedData) {
                try {
                    pipelineData = JSON.parse(savedData);
                    console.log('Pipeline data loaded from localStorage:', pipelineData.length, 'records');
                    
                    // Dropdown'ları sadece gerektiğinde doldur
                    if (!document.getElementById('pipelineSalesRepFilter').children.length > 1) {
                        populatePipelineDropdowns();
                    }
                } catch (error) {
                    console.error('Error loading pipeline data from localStorage:', error);
                    // Hata durumunda varsayılan verileri kullan
                    console.log('Using default pipeline data');
                }
            } else {
                console.log('No pipeline data in localStorage, using default data');
            }
        }
        
        // Pipeline verilerini localStorage'a kaydet
        function savePipelineData() {
            localStorage.setItem('pipelineData', JSON.stringify(pipelineData));
            console.log('Pipeline data saved to localStorage:', pipelineData.length, 'records');
            
            // Buluta da kaydet
            if (currentUser) {
                saveUserData();
            }
        }
        
        // İlk yüklemede pipeline verilerini localStorage'a kaydet
        function initializePipelineData() {
            const savedData = localStorage.getItem('pipelineData');
            if (!savedData) {
                // İlk kez yükleniyorsa pipeline verilerini kaydet
                savePipelineData();
                console.log('Pipeline data initialized and saved to localStorage');
            }
        }
        
        // Show/Hide Functions
        function showDashboard() {
            // Sayfa ilk yüklendiğinde Ağustos dashboard'ını göster
            if (!window.dashboardInitialized) {
                document.getElementById('dashboardContainer').style.display = 'none';
                document.getElementById('augustDashboardContainer').style.display = 'block';
                document.getElementById('yearlyDashboardContainer').style.display = 'none';
                document.getElementById('septemberDashboardContainer').style.display = 'none';
                window.activeDashboard = 'august';
                renderAugustDashboard();
                window.dashboardInitialized = true;
            } else {
                // Sonraki çağrılarda Temmuz dashboard'unu göster
                document.getElementById('dashboardContainer').style.display = 'block';
                document.getElementById('augustDashboardContainer').style.display = 'none';
                document.getElementById('septemberDashboardContainer').style.display = 'none';
                document.getElementById('yearlyDashboardContainer').style.display = 'none';
                window.activeDashboard = 'july';
                renderDashboard();
            }
            closeMenu();
        }

        function showSeptemberDashboard() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('augustDashboardContainer').style.display = 'none';
            document.getElementById('yearlyDashboardContainer').style.display = 'none';
            document.getElementById('septemberDashboardContainer').style.display = 'block';
            window.activeDashboard = 'september';
            renderSeptemberDashboard();
            closeMenu();
        }
        
        function showAugustDashboard() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('augustDashboardContainer').style.display = 'block';
            document.getElementById('yearlyDashboardContainer').style.display = 'none';
            document.getElementById('septemberDashboardContainer').style.display = 'none';
            // Ağustos dashboard'unun aktif olduğunu işaretle
            window.activeDashboard = 'august';
            renderAugustDashboard();
            closeMenu();
        }
        
        function showYearlyDashboard() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('augustDashboardContainer').style.display = 'none';
            document.getElementById('septemberDashboardContainer').style.display = 'none';
            document.getElementById('yearlyDashboardContainer').style.display = 'block';
            // Yıllık dashboard için activeDashboard'u ayarla
            window.activeDashboard = 'yearly';
            renderYearlyDashboard();
            closeMenu();
        }
        
        function showJulyCommitment() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('augustDashboardContainer').style.display = 'none';
            document.getElementById('septemberDashboardContainer').style.display = 'none';
            document.getElementById('pipelineContainer').style.display = 'none';
            document.getElementById('yearlyDashboardContainer').style.display = 'none';
            document.getElementById('julyCommitmentContainer').style.display = 'block';
            // Temmuz commitment dashboard için activeDashboard'u ayarla
            window.activeDashboard = 'july';
            renderJulyCommitment();
            closeMenu();
        }
        
        function showStrategicOpportunities() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('augustDashboardContainer').style.display = 'none';
            document.getElementById('septemberDashboardContainer').style.display = 'none';
            document.getElementById('pipelineContainer').style.display = 'none';
            document.getElementById('yearlyDashboardContainer').style.display = 'none';
            document.getElementById('julyCommitmentContainer').style.display = 'none';
            document.getElementById('strategicOpportunitiesSection').style.display = 'block';
            // Strategic opportunities dashboard için activeDashboard'u ayarla
            window.activeDashboard = 'strategic';
            renderStrategicOpportunities();
            closeMenu();
        }
        

        
        function showPipeline() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('augustDashboardContainer').style.display = 'none';
            document.getElementById('septemberDashboardContainer').style.display = 'none';
            document.getElementById('yearlyDashboardContainer').style.display = 'none';
            document.getElementById('julyCommitmentContainer').style.display = 'none';
            document.getElementById('pipelineContainer').style.display = 'block';
            // Pipeline dashboard için activeDashboard'u ayarla
            window.activeDashboard = 'pipeline';
            renderPipelineManagerCards();
            renderPipelineSummaryStats();
            closeMenu();
        }
        
        function renderPipelineManagerCards() {
            // Pipeline metriklerini hesapla ve kartları render et
            renderPipelineMetricsCards();
            
            // Dropdown'ları sadece ilk kez veya gerektiğinde doldur
            if (!document.getElementById('pipelineSalesRepFilter').children.length > 1) {
                populatePipelineDropdowns();
            }
        }
        
        function renderPipelineMetricsCards() {
            const teamGrid = document.getElementById('teamGrid');
            teamGrid.innerHTML = '';
            console.log('Rendering pipeline cards...');
            console.log('Team Grid Element:', teamGrid);
            // Her satış yöneticisi için pipeline büyüklüğünü hesapla ve sıralama için dizi oluştur
            // Aylık hedefi olmayan kişileri filtrele (target = 0 olanlar)
            const pipelineStats = salesData
                .filter(person => person.target > 0) // Sadece aylık hedefi olan kişileri dahil et
                .map(person => {
                    const personOpportunities = pipelineData.filter(opportunity => opportunity.contactPerson === person.name);
                    const personPipelineValue = personOpportunities.reduce((sum, opportunity) => sum + opportunity.amount, 0);
                    return { person, personPipelineValue, personOpportunities };
                });
            // Pipeline büyüklüğüne göre azalan sırala
            pipelineStats.sort((a, b) => b.personPipelineValue - a.personPipelineValue);
            pipelineStats.forEach(({ person, personPipelineValue, personOpportunities }) => {
                // Bu kişinin pipeline fırsatlarını filtrele - Satış Yöneticisi alanına göre
                const personOpportunityCount = personOpportunities.length;
                const personTargetToPipelineRatio = personPipelineValue > 0 ? (person.target / personPipelineValue * 100) : 0;
                
                // Performans badge'i belirle
                let performanceClass = 'performance-poor';
                let performanceText = 'Düşük';
                
                if (personTargetToPipelineRatio >= 200) {
                    performanceClass = 'performance-excellent';
                    performanceText = 'Mükemmel';
                } else if (personTargetToPipelineRatio >= 150) {
                    performanceClass = 'performance-good';
                    performanceText = 'İyi';
                } else if (personTargetToPipelineRatio >= 100) {
                    performanceClass = 'performance-average';
                    performanceText = 'Orta';
                }
                
                const card = document.createElement('div');
                card.className = 'team-card';
                card.onclick = () => showPipelineMemberDetail(person, personOpportunities);
                
                card.innerHTML = `
                    <div class="team-card-header">
                        <h3 class="team-member-name">${person.name}</h3>
                    </div>
                    
                    <div class="team-stats">
                        <div class="team-stat-item">
                            <div class="team-stat-label">Pipeline Büyüklüğü</div>
                            <div class="team-stat-value">₺${personPipelineValue.toLocaleString('tr-TR')}</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Hedef/Pipeline Oranı</div>
                            <div class="team-stat-value">${personTargetToPipelineRatio.toFixed(1)}%</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Fırsat Adedi</div>
                            <div class="team-stat-value">${personOpportunityCount}</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Hedef</div>
                            <div class="team-stat-value">₺${person.target.toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                    
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: ${Math.min(personTargetToPipelineRatio, 300)}%; background: ${personTargetToPipelineRatio >= 100 ? '#10b981' : '#f59e0b'};"></div>
                    </div>
                    
                    <div style="margin-top: 10px; font-size: 0.85em; color: #64748b;">
                        📊 ${personOpportunityCount} fırsat | 🎯 ${personTargetToPipelineRatio >= 100 ? 'Hedef aşıldı' : 'Hedef altında'} | 💰 ${personOpportunities.filter(o => o.amount > 100000).length} büyük fırsat | 💰 ₺${personPipelineValue.toLocaleString('tr-TR')}
                    </div>
                    
                    <div style="margin-top: 15px; text-align: center; font-size: 0.9em; color: #6b7280; font-style: italic;">
                        👆 Detayları görmek için tıklayın
                    </div>
                `;
                
                teamGrid.appendChild(card);
            });
        }
        function renderTeamCards() {
            const teamGrid = document.getElementById('teamGrid');
            teamGrid.innerHTML = '';
            
            // salesData'dan ekip verilerini al
            const teamMembers = salesData.map(person => ({
                name: person.name,
                target: person.target,
                actual: person.actual,
                performanceRate: person.performanceKPIs.targetRealizationRate,
                newCustomers: person.performanceKPIs.newCustomerSales,
                contacts: person.performanceKPIs.newCustomerContacts,
                referrals: person.performanceKPIs.groupCompanyReferrals
            }));
            
            teamMembers.forEach(member => {
                // Performans badge'i belirle
                let performanceClass = 'performance-poor';
                let performanceText = 'Düşük';
                
                if (member.performanceRate >= 50) {
                    performanceClass = 'performance-excellent';
                    performanceText = 'Mükemmel';
                } else if (member.performanceRate >= 30) {
                    performanceClass = 'performance-good';
                    performanceText = 'İyi';
                } else if (member.performanceRate >= 10) {
                    performanceClass = 'performance-average';
                    performanceText = 'Orta';
                }
                
                const card = document.createElement('div');
                card.className = 'team-card';
                card.onclick = () => showTeamMemberDetail(member);
                
                card.innerHTML = `
                    <div class="team-card-header">
                        <h3 class="team-member-name">${member.name}</h3>
                        <span class="team-performance-badge ${performanceClass}">${performanceText}</span>
                    </div>
                    
                    <div class="team-stats">
                        <div class="team-stat-item">
                            <div class="team-stat-label">Hedef</div>
                            <div class="team-stat-value">₺${member.target.toLocaleString('tr-TR')}</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Gerçekleşen</div>
                            <div class="team-stat-value">₺${member.actual.toLocaleString('tr-TR')}</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Performans</div>
                            <div class="team-stat-value">${member.performanceRate.toFixed(1)}%</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Yeni Müşteri</div>
                            <div class="team-stat-value">${member.newCustomers}</div>
                        </div>
                    </div>
                    
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: ${Math.min(member.performanceRate, 100)}%"></div>
                    </div>
                    
                    <div style="margin-top: 10px; font-size: 0.85em; color: #64748b;">
                        📞 ${member.contacts} temas | 🤝 ${member.referrals} yönlendirme
                    </div>
                `;
                
                teamGrid.appendChild(card);
            });
        }
        
        function showPipelineMemberDetail(person, opportunities) {
            // Modal'ı aç ve pipeline detaylarını göster
            const modalTitle = document.getElementById('modalTitle');
            modalTitle.textContent = `${person.name} - Pipeline Fırsatları`;
            
            // Fırsatları tutar büyüklüğüne göre sırala (büyükten küçüğe)
            const sortedOpportunities = opportunities.sort((a, b) => b.amount - a.amount);
            
            const personPipelineValue = sortedOpportunities.reduce((sum, opportunity) => sum + opportunity.amount, 0);
            const personTargetToPipelineRatio = personPipelineValue > 0 ? (person.target / personPipelineValue * 100) : 0;
            
            let modalContent = '';
            

            
            // Fırsat kartları bölümü
            if (sortedOpportunities.length > 0) {
                modalContent += '<div class="modal-section">';
                modalContent += '<h3>📋 Fırsat Kartları (Tutar Büyüklüğüne Göre Sıralı)</h3>';
                modalContent += '<div class="opportunities-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; max-height: 600px; overflow-y: auto; padding: 10px;">';
                
                sortedOpportunities.forEach(opportunity => {
                    modalContent += `
                        <div class="opportunity-card" style="background: white; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); transition: all 0.3s ease; border-left: 3px solid #2563EB; cursor: pointer;">
                            <div class="opportunity-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <h4 style="margin: 0; color: #1f2937; font-size: 1.1em; font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${opportunity.customerName}</h4>
                                <span class="opportunity-status" style="padding: 4px 8px; border-radius: 12px; font-size: 0.75em; font-weight: 500; ${opportunity.amount >= 500000 ? 'background: #dc2626; color: white;' : opportunity.amount >= 200000 ? 'background: #ea580c; color: white;' : opportunity.amount >= 100000 ? 'background: #ca8a04; color: white;' : 'background: #059669; color: white;'}">${opportunity.amount >= 500000 ? 'Büyük' : opportunity.amount >= 200000 ? 'Orta' : opportunity.amount >= 100000 ? 'Küçük' : 'Mini'}</span>
                            </div>
                            
                            <div class="opportunity-stats" style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;">
                                <div class="stat-item">
                                    <div class="stat-label" style="font-size: 0.7em; color: #6b7280; margin-bottom: 2px;">Satış Yöneticisi</div>
                                    <div class="stat-value" style="font-weight: 500; color: #374151; font-size: 0.85em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${opportunity.contactPerson || 'Belirtilmemiş'}</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label" style="font-size: 0.7em; color: #6b7280; margin-bottom: 2px;">Müşteri Temsilcisi</div>
                                    <div class="stat-value" style="font-weight: 500; color: #374151; font-size: 0.85em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${opportunity.salesRep || 'Belirtilmemiş'}</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label" style="font-size: 0.7em; color: #6b7280; margin-bottom: 2px;">İş Ortağı</div>
                                    <div class="stat-value" style="font-weight: 500; color: #374151; font-size: 0.85em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${opportunity.businessPartner || 'Belirtilmemiş'}</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label" style="font-size: 0.7em; color: #6b7280; margin-bottom: 2px;">Tahmini Kapanış</div>
                                    <div class="stat-value" style="font-weight: 500; color: #374151; font-size: 0.85em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${opportunity.expectedClose || 'Belirtilmemiş'}</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label" style="font-size: 0.7em; color: #6b7280; margin-bottom: 2px;">Ürün Grubu</div>
                                    <div class="stat-value" style="font-weight: 500; color: #374151; font-size: 0.85em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${opportunity.productCode || 'Belirtilmemiş'}</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label" style="font-size: 0.7em; color: #6b7280; margin-bottom: 2px;">Satış Tipi</div>
                                    <div class="stat-value" style="font-weight: 500; color: #374151; font-size: 0.85em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${opportunity.opportunityType || 'Belirtilmemiş'}</div>
                                </div>
                            </div>
                            
                            <div class="opportunity-amount" style="text-align: center; font-weight: 700; color: #059669; font-size: 1.2em; padding: 8px; background: #f0fdf4; border-radius: 6px; border: 1px solid #bbf7d0; margin-bottom: 10px;">
                                💰 ₺${opportunity.amount.toLocaleString('tr-TR')}
                            </div>
                            
                            <div class="opportunity-actions" style="display: flex; gap: 8px; justify-content: center;">
                                <button class="strategic-btn" onclick="addToStrategicOpportunitiesAndUpdateButton(this, '${opportunity.customerName}', '${opportunity.contactPerson}', '${opportunity.productCode}', ${opportunity.amount}, '${opportunity.expectedClose}')" style="background: linear-gradient(135deg, #10b981, #059669); color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 0.8em; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);">
                                    🎯 Stratejik
                                </button>
                                <button class="commit-btn" onclick="addToJulyCommitmentAndUpdateButton(this, '${opportunity.customerName}', '${opportunity.contactPerson}', '${opportunity.productCode}', ${opportunity.amount}, '${opportunity.expectedClose}')" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 0.8em; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);">
                                    📅 Commit
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                modalContent += '</div>';
                modalContent += '</div>';
            } else {
                modalContent += '<div class="modal-section" style="margin-top: 30px; text-align: center; color: #6b7280;">';
                modalContent += '<h3>📋 Fırsat Bulunamadı</h3>';
                modalContent += '<p>Bu satış yöneticisinin henüz pipeline fırsatı bulunmuyor.</p>';
                modalContent += '</div>';
            }
            
            document.getElementById('modalBody').innerHTML = modalContent;
            document.getElementById('modalOverlay').style.display = 'flex';
        }
        function showTeamMemberDetail(member) {
            // Modal'ı aç ve ekip üyesi detaylarını göster
            const modalTitle = document.getElementById('modalTitle');
            modalTitle.textContent = `${member.name} - Detaylı Performans`;
            
            // salesData'dan bu kişinin tam verilerini bul
            const personData = salesData.find(person => person.name === member.name);
            
            let modalContent = '';
            
            modalContent += '<div class="modal-section">';
            modalContent += '<h3>📊 Performans Özeti</h3>';
            modalContent += '<div class="performance-summary">';
            modalContent += `<div class="performance-item">
                <span class="performance-label">Hedef:</span>
                <span class="performance-value">₺${member.target.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">Gerçekleşen:</span>
                <span class="performance-value">₺${member.actual.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">Performans Oranı:</span>
                <span class="performance-value">${member.performanceRate.toFixed(1)}%</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">İskonto Oranı:</span>
                <span class="performance-value">${personData.performanceKPIs.discountRate.toFixed(1)}%</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">Yeni Müşteri Edinim:</span>
                <span class="performance-value">${member.newCustomers} adet</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">Müşteri Temasları:</span>
                <span class="performance-value">${member.contacts} adet</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">Grup Firma Yönlendirme:</span>
                <span class="performance-value">${member.referrals} adet</span>
            </div>`;
            modalContent += '</div>';
            
            // Ürün satışları bölümü
            modalContent += '<div class="modal-section" style="margin-top: 30px;">';
            modalContent += '<h3>🛍️ Ürün Satış Dağılımı</h3>';
            modalContent += '<div class="performance-summary">';
            modalContent += `<div class="performance-item">
                <span class="performance-label">Netahsilat:</span>
                <span class="performance-value">₺${personData.productSales.netTahsilat.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">Net Ekstre:</span>
                <span class="performance-value">₺${personData.productSales.netEkstre.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">PosRapor:</span>
                <span class="performance-value">₺${personData.productSales.posRapor.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">TÖS:</span>
                <span class="performance-value">₺${personData.productSales.tos.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">Online DBS:</span>
                <span class="performance-value">₺${personData.productSales.onlineDBS.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">NAP:</span>
                <span class="performance-value">₺${personData.productSales.nap.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += `<div class="performance-item">
                <span class="performance-label">UniDOX:</span>
                <span class="performance-value">₺${personData.productSales.unidox.toLocaleString('tr-TR')}</span>
            </div>`;
            modalContent += '</div>';
            modalContent += '</div>';
            
            document.getElementById('modalBody').innerHTML = modalContent;
            document.getElementById('modalOverlay').style.display = 'flex';
        }
        

        

        

        
        // Inline Edit Functions
        function startInlineEdit(index, field) {
            if (!isAdmin) {
                requireAdminAuth();
                return;
            }
            const element = document.getElementById(field + '-' + index);
            
            // Eğer zaten düzenleme modundaysa, iptal et
            if (element.querySelector('input')) {
                return;
            }
            
            const person = salesData[index];
            const currentValue = person[field];
            
            // Düzenleme moduna geç
            element.classList.add('editing');
            element.innerHTML = '<div class="inline-edit"><input type="number" value="' + currentValue + '" id="edit-' + field + '-' + index + '" onkeypress="handleInlineEditKey(event, ' + index + ', \'' + field + '\')"><button onclick="saveInlineEdit(' + index + ', \'' + field + '\')">✓</button><button class="cancel-btn" onclick="cancelInlineEdit(' + index + ', \'' + field + '\')">✗</button></div>';
            
            // Input'a odaklan
            setTimeout(() => {
                const input = document.getElementById('edit-' + field + '-' + index);
                input.focus();
                input.select();
            }, 100);
        }
        
        function toggleInlineEdit(index) {
            // Bu fonksiyon artık kullanılmıyor, ama geriye uyumluluk için bırakıyoruz
            startInlineEdit(index, 'target');
        }
        
        function saveInlineEdit(index, field) {
            const input = document.getElementById('edit-' + field + '-' + index);
            const value = parseInt(input.value) || 0;
            const person = salesData[index];
            
            // Değeri güncelle
            person[field] = value;
            
            // Hedef gerçekleşme oranını hesapla
            person.performanceKPIs.targetRealizationRate = person.target > 0 ? (person.actual / person.target) * 100 : 0;
            
            // Aylık veriyi güncelle
            const monthlyTarget = person.target / 12;
            person.monthlyData = [
                monthlyTarget * 0.9,
                monthlyTarget * 0.8,
                monthlyTarget * 1.1,
                monthlyTarget * 1.0,
                monthlyTarget * 1.2,
                monthlyTarget * 0.95,
                person.actual
            ];
            
            // Verileri kaydet ve dashboard'u yenile
            saveData();
            renderDashboard();
            
            // Başarı mesajı göster
            const fieldName = field === 'target' ? 'Hedef' : 'Gerçekleşen';
            showNotification(fieldName + ' başarıyla güncellendi!', 'success');
        }
        
        function cancelInlineEdit(index, field) {
            const element = document.getElementById(field + '-' + index);
            const person = salesData[index];
            
            // Düzenleme modundan çık
            element.classList.remove('editing');
            element.innerHTML = '₺' + person[field].toLocaleString('tr-TR');
        }
        
        function handleInlineEditKey(event, index, field) {
            if (event.key === 'Enter') {
                saveInlineEdit(index, field);
            } else if (event.key === 'Escape') {
                cancelInlineEdit(index, field);
            }
        }
        
        // Modal Edit Functions - Direkt Tıklama ile Düzenleme
        
        function startModalEdit(personIndex, field, monthIndex = null) {
            if (!isAdmin) {
                requireAdminAuth();
                return;
            }
            let elementId = 'modal-' + field + '-' + personIndex;
            if (monthIndex !== null) {
                elementId = 'modal-' + field + '-' + monthIndex + '-' + personIndex;
            }
            
            const element = document.getElementById(elementId);
            if (!element || element.querySelector('input')) return;
            
            const person = salesData[personIndex];
            let currentValue;
            
            if (field === 'target' || field === 'actual') {
                currentValue = person[field];
            } else if (field === 'monthly') {
                currentValue = person.monthlyData[monthIndex];
            } else if (field === 'targetRealizationRate' || field === 'discountRate') {
                currentValue = person.performanceKPIs[field];
            } else if (field === 'newCustomerSales' || field === 'newCustomerContacts' || field === 'groupCompanyReferrals') {
                currentValue = person.performanceKPIs[field];
            } else {
                currentValue = person.productSales[field];
            }
            
            // Düzenleme moduna geç
            element.classList.add('editing');
            
            let inputId = 'modal-edit-' + field + '-' + personIndex;
            if (monthIndex !== null) {
                inputId += '-' + monthIndex;
            }
            
            let inputHtml = '<input type="number" value="' + currentValue + '" id="' + inputId + '" onkeypress="handleModalEditKey(event, ' + personIndex + ', \'' + field + '\', ' + (monthIndex !== null ? monthIndex : 'null') + ')">';
            
            inputHtml += '<div class="edit-buttons">';
            inputHtml += '<button type="button" onclick="saveModalEdit(' + personIndex + ', \'' + field + '\', ' + (monthIndex !== null ? monthIndex : 'null') + ')">✓</button>';
            inputHtml += '<button type="button" class="cancel-btn" onclick="cancelModalEdit(' + personIndex + ', \'' + field + '\', ' + (monthIndex !== null ? monthIndex : 'null') + ')">✗</button>';
            inputHtml += '</div>';
            
            element.innerHTML = inputHtml;
            
            // Input'a odaklan
            setTimeout(() => {
                const input = document.getElementById('modal-edit-' + field + '-' + personIndex + (monthIndex !== null ? '-' + monthIndex : ''));
                if (input) {
                    input.focus();
                    input.select();
                }
            }, 100);
        }
        
        function saveModalEdit(personIndex, field, monthIndex = null) {
            let inputId = 'modal-edit-' + field + '-' + personIndex;
            if (monthIndex !== null) {
                inputId += '-' + monthIndex;
            }
            
            const input = document.getElementById(inputId);
            if (!input) return;
            
            let value = parseFloat(input.value) || 0;
            const person = salesData[personIndex];
            
            // Değeri güncelle
            if (field === 'target' || field === 'actual') {
                person[field] = value;
            } else if (field === 'monthly') {
                person.monthlyData[monthIndex] = value;
            } else if (field === 'targetRealizationRate' || field === 'discountRate') {
                person.performanceKPIs[field] = value;
            } else if (field === 'newCustomerSales' || field === 'newCustomerContacts' || field === 'groupCompanyReferrals') {
                person.performanceKPIs[field] = parseInt(value) || 0;
            } else {
                // Ürün satışları güncelleniyor
                person.productSales[field] = value;
                // Gerçekleşen tutarını otomatik güncelle
                updateActualFromProductSales(personIndex);
            }
            
            // Hedef gerçekleşme oranını hesapla (eğer manuel olarak değiştirilmediyse)
            if (field !== 'targetRealizationRate') {
                person.performanceKPIs.targetRealizationRate = person.target > 0 ? (person.actual / person.target) * 100 : 0;
            }
            
            // Aylık veriyi güncelle (eğer manuel olarak değiştirilmediyse)
            if (field !== 'monthly') {
                const monthlyTarget = person.target / 12;
                person.monthlyData = [
                    monthlyTarget * 0.9,
                    monthlyTarget * 0.8,
                    monthlyTarget * 1.1,
                    monthlyTarget * 1.0,
                    monthlyTarget * 1.2,
                    monthlyTarget * 0.95,
                    person.actual
                ];
            }
            
            // Verileri kaydet ve dashboard'u yenile
            saveData();
            renderDashboard();
            
            // Başarı mesajı göster
            const fieldNames = {
                'target': 'Hedef',
                'actual': 'Gerçekleşen',
                'netTahsilat': 'Netahsilat',
                'netEkstre': 'Net Ekstre',
                'posRapor': 'PosRapor',
                'tos': 'TÖS',
                'onlineDBS': 'Online DBS',
                'nap': 'NAP',
                'unidox': 'UniDOX',
                'monthly': monthNames[monthIndex] + ' Aylık Veri',
                'targetRealizationRate': 'Hedef Gerçekleşme Oranı',
                'discountRate': 'İskonto Oranı',
                'newCustomerSales': 'Yeni Müşteri Edinim',
                'newCustomerContacts': 'Yeni Müşteri Temas',
                'groupCompanyReferrals': 'Grup Firma Yönlendirme'
            };
            showNotification(fieldNames[field] + ' başarıyla güncellendi!', 'success');
            
            // Modal'ı yenile
            setTimeout(() => {
                showPersonDetail(person);
            }, 100);
        }
        
        function cancelModalEdit(personIndex, field, monthIndex = null) {
            let elementId = 'modal-' + field + '-' + personIndex;
            if (monthIndex !== null) {
                elementId = 'modal-' + field + '-' + monthIndex + '-' + personIndex;
            }
            
            const element = document.getElementById(elementId);
            if (!element) return;
            
            const person = salesData[personIndex];
            let currentValue;
            let displayValue;
            
            if (field === 'target' || field === 'actual') {
                currentValue = person[field];
                displayValue = '₺' + currentValue.toLocaleString('tr-TR');
            } else if (field === 'monthly') {
                currentValue = person.monthlyData[monthIndex];
                displayValue = '₺' + (currentValue/1000).toFixed(0) + 'K';
            } else if (field === 'targetRealizationRate' || field === 'discountRate') {
                currentValue = person.performanceKPIs[field];
                displayValue = currentValue.toFixed(1) + '%';
            } else if (field === 'newCustomerSales' || field === 'newCustomerContacts' || field === 'groupCompanyReferrals') {
                currentValue = person.performanceKPIs[field];
                displayValue = currentValue + ' Adet';
            } else {
                currentValue = person.productSales[field];
                displayValue = '₺' + currentValue.toLocaleString('tr-TR');
            }
            
            // Düzenleme modundan çık
            element.classList.remove('editing');
            element.innerHTML = displayValue;
        }
        function handleModalEditKey(event, personIndex, field, monthIndex = null) {
            if (event.key === 'Enter') {
                saveModalEdit(personIndex, field, monthIndex);
            } else if (event.key === 'Escape') {
                cancelModalEdit(personIndex, field, monthIndex);
            }
        }
        
        // Ürün satışlarından gerçekleşen tutarını otomatik güncelle
        function updateActualFromProductSales(personIndex) {
            const person = salesData[personIndex];
            const productSales = person.productSales;
            
            // Tüm ürün satışlarının toplamını hesapla (Temmuz ayı)
            const totalActual = productSales.netTahsilat + 
                               productSales.netEkstre + 
                               productSales.posRapor + 
                               productSales.tos + 
                               productSales.onlineDBS + 
                               productSales.nap + 
                               productSales.unidox;
            
            // Gerçekleşen tutarını güncelle (Temmuz ayı)
            person.actual = totalActual;
            
            // Hedef gerçekleşme oranını da güncelle
            if (person.target > 0) {
                person.performanceKPIs.targetRealizationRate = (totalActual / person.target) * 100;
            }
            
            // monthlyData[6] değerini de güncelle (Temmuz ayı)
            if (person.monthlyData && person.monthlyData.length > 6) {
                person.monthlyData[6] = totalActual;
            }
            
            console.log(`updateActualFromProductSales: ${person.name} - Temmuz ayı ürün satışları: ₺${totalActual.toLocaleString('tr-TR')}, Actual güncellendi: ₺${person.actual.toLocaleString('tr-TR')}, monthlyData[6] güncellendi: ₺${person.monthlyData[6].toLocaleString('tr-TR')}`);
        }
        
        function showNotification(message, type = 'info') {
            // Basit bildirim sistemi
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#108981' : '#2563EB'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-weight: 500;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            // CSS animasyonu ekle
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // 3 saniye sonra kaldır
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 3000);
        }
        let salesData = [
            {
                name: "Fahri Aktoz",
                title: "Müdür",
                target: 1120000, // Temmuz hedefi
                actual: 470000, // Temmuz ayı ürün satışları toplamı
                yearlyTarget: 7600000, // Yıllık hedef (7.6M TL)
                monthlyData: [969250, 1090000, 2266250, 840000, 420000, 1155020, 470000, 500000], // Ocak-Temmuz + Ağustos (Ağustos: 500k netTahsilat)
                augustTarget: 1250000, // Ağustos hedefi
                augustActual: 500000, // Ağustos gerçekleşen (500k netTahsilat)
                augustTargetRealizationRate: 40.0, // 500000 / 1250000 * 100 (Ağustos hedefi gerçekleşme oranı)
                productSales: {
                    netTahsilat: 470000, // Temmuz ayı netTahsilat (actual ile aynı)
                    netEkstre: 0, // Temmuz ayı verisi yok
                    posRapor: 0, // Temmuz ayı verisi yok
                    tos: 0, // Temmuz ayı verisi yok
                    onlineDBS: 0, // Temmuz ayı verisi yok
                    nap: 0, // Temmuz ayı verisi yok
                    unidox: 0 // Temmuz ayı verisi yok
                },
                performanceKPIs: {
                    targetRealizationRate: 42.0, // 470000 / 1120000 * 100 (Temmuz hedefi gerçekleşme oranı)
                    yearlyTargetRealizationRate: 108.4, // 8246360 / 7600000 * 100 (Yıllık hedef gerçekleşme oranı - Tüm Ağustos verileri dahil)
                    discountRate: 0,
                    newCustomerSales: 1,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                satisKaynagi: "SDR", // Ana satış kaynağı
                satisKaynagiDagilimi: {
                    mevcutMusteri: 4102520, // Görsel verisi
                    disTalep: 1736000, // Görsel verisi
                    sdr: 1772000, // Görsel verisi
                    isOrtagi: 100000, // Görsel verisi
                    satisEkibi: 0 // Görsel verisi
                },
                // Yıllık ürün kırılımı verileri (Temmuz dashboard'unda gösterilmeyecek)
                yearlyProductSales: {
                    netTahsilat: 5341520, // Yıllık toplam netTahsilat (4961520 + 130000 Hüseyin + 80000 Egehan Ağustos)
                    netEkstre: 1360000, // Yıllık toplam netEkstre (1290000 + 70000 Hüseyin Ağustos)
                    posRapor: 708840, // Yıllık toplam posRapor (620000 + 33840 + 56000 Hüseyin Ağustos)
                    tos: 240000, // Yıllık toplam tos
                    onlineDBS: 540000, // Yıllık toplam onlineDBS
                    nap: 210000, // Yıllık toplam nap
                    unidox: 95000 // Yıllık toplam unidox (95000 Hüseyin Ağustos)
                }
            },
            {
                name: "Umut Karaerarslan",
                title: "Kıdemli Uzman",
                target: 840000, // Temmuz hedefi
                actual: 576302, // Ürün satışları toplamı: 381422 + 158880 + 0 + 36000 + 0 + 0 + 0
                yearlyTarget: 5480000, // Yıllık hedef
                monthlyData: [483744, 405291, 609648, 489146, 370773, 538146, 576302, 0], // Ocak-Temmuz + Ağustos (henüz veri yok)
                augustTarget: 750000, // Ağustos hedefi
                productSales: {
                    netTahsilat: 381422,
                    netEkstre: 158880, // 73880 + 85000
                    posRapor: 0,
                    tos: 36000,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 68.6, // 576302 / 840000 * 100
                    discountRate: 0,
                    newCustomerSales: 5, // 5 yeni müşteri
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                satisKaynagi: "Mevcut Müşteri",
                satisKaynagiDagilimi: {
                    mevcutMusteri: 1129776, // Görsel verisi
                    disTalep: 1236047, // Görsel verisi
                    sdr: 569992, // Görsel verisi
                    isOrtagi: 155833, // Görsel verisi
                    satisEkibi: 381402 // Görsel verisi
                }
            },
            {
                name: "Hüseyin Çakmak",
                title: "Müdür",
                target: 1232000, // Temmuz hedefi
                actual: 1217182, // Ürün satışları toplamı: 875000 + 291154 + 51028 + 0 + 0 + 0 + 0
                yearlyTarget: 6732000, // Yıllık hedef
                monthlyData: [840256, 103500, 425000, 469383, 338948, 1029167, 1217182, 384840], // Ocak-Temmuz + Ağustos (Ağustos: 384840)
                augustTarget: 1250000, // Ağustos hedefi
                augustActual: 384840, // Ağustos gerçekleşen (384840)
                productSales: {
                    netTahsilat: 1005000, // 875000 + 130000 (Ağustos Dış Talep)
                    netEkstre: 361154, // 291154 + 70000 (Ağustos İş Ortağı)
                    posRapor: 141868, // 51028 + 33840 (Ağustos Mevcut Müşteri) + 56000 (Ağustos İş Ortağı)
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 95000 // 95000 (Ağustos Mevcut Müşteri Kronospan)
                },
                performanceKPIs: {
                    targetRealizationRate: 98.8, // 1217182 / 1232000 * 100
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                satisKaynagi: "SDR",
                satisKaynagiDagilimi: {
                    mevcutMusteri: 1259740, // Görsel verisi
                    disTalep: 2066968, // Görsel verisi
                    sdr: 287264, // Görsel verisi
                    isOrtagi: 591558, // Görsel verisi
                    satisEkibi: 565997 // Görsel verisi
                }
            },
            {
                name: "Sebahat Çay",
                title: "Müdür",
                target: 952000, // Temmuz hedefi
                actual: 529106, // Ürün satışları toplamı: 273728 + 218100 + 37278 + 0 + 0 + 0 + 0
                yearlyTarget: 5962000, // Yıllık hedef
                monthlyData: [396000, 816600, 822079, 808919, 200450, 705276, 529106, 0], // Ocak-Temmuz + Ağustos (henüz veri yok)
                augustTarget: 950000, // Ağustos hedefi
                productSales: {
                    netTahsilat: 273728,
                    netEkstre: 218100,
                    posRapor: 37278,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 55.6, // 529106 / 952000 * 100
                    discountRate: 0,
                    newCustomerSales: 3, // 3 yeni müşteri
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                satisKaynagi: "İş Ortaklıkları",
                satisKaynagiDagilimi: {
                    mevcutMusteri: 359780, // Görsel verisi
                    disTalep: 1541017, // Görsel verisi
                    sdr: 1770474, // Görsel verisi
                    isOrtagi: 158400, // Görsel verisi
                    satisEkibi: 448759 // Görsel verisi
                }
            },
            {
                name: "Damla Kalemtaş",
                title: "Müdür Yardımcısı",
                target: 840000, // Temmuz hedefi
                actual: 462040, // Ürün satışları toplamı: 348000 + 114040 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 3090000, // Yıllık hedef
                monthlyData: [0, 0, 0, 590565, 690364, 253000, 462040, 91000], // Ocak-Temmuz + Ağustos (Ağustos: 73000 Netekstre + 18000 Netahsilat)
                augustTarget: 950000, // Ağustos hedefi
                augustActual: 91000, // Ağustos gerçekleşen (73000 Netekstre + 18000 Netahsilat)
                productSales: {
                    netTahsilat: 366000, // 57000 + 291000 + 18000 (Ağustos)
                    netEkstre: 187040, // 80000 + 34040 + 73000 (Ağustos)
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 55.0, // 462040 / 840000 * 100
                    discountRate: 0,
                    newCustomerSales: 4, // 4 yeni satış
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 1 // 1 Mevcut müşteri referansı
                },
                satisKaynagi: "Satış Ekibi",
                satisKaynagiDagilimi: {
                    mevcutMusteri: 912236, // Görsel verisi
                    disTalep: 824733, // Görsel verisi
                    sdr: 350000, // Görsel verisi
                    isOrtagi: 0, // Görsel verisi
                    satisEkibi: 0 // Görsel verisi
                }
            },
            {
                name: "Güven Gürkan Salıkoç",
                title: "Kıdemli Uzman",
                target: 900000, // Temmuz hedefi
                actual: 728900, // Ürün satışları toplamı: 419900 + 309000 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 5865000, // Yıllık hedef
                monthlyData: [363640, 309100, 283806, 1071554, 142942, 318420, 728900, 60000], // Ocak-Temmuz + Ağustos (Ağustos: 60000 Netahsilat)
                augustTarget: 750000, // Ağustos hedefi
                augustActual: 60000, // Ağustos gerçekleşen (60000 Netahsilat)
                productSales: {
                    netTahsilat: 479900, // 286300 + 133600 + 60000 (Ağustos)
                    netEkstre: 309000, // 0 + 309000
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 81.0, // 728900 / 900000 * 100
                    discountRate: 0,
                    newCustomerSales: 6, // 6 yeni satış
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 1 // 1 mevcut müşteri referansı
                },
                satisKaynagi: "Dış Talep",
                satisKaynagiDagilimi: {
                    mevcutMusteri: 357750, // Görsel verisi
                    disTalep: 1456182, // Görsel verisi
                    sdr: 207872, // Görsel verisi
                    isOrtagi: 0, // Görsel verisi
                    satisEkibi: 1256558 // Görsel verisi
                }
            },
            {
                name: "Tuğçe Bugakaptan",
                title: "Kıdemli Uzman",
                target: 850000, // Temmuz hedefi
                actual: 486509, // Ürün satışları toplamı: 324069 + 162440 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 5865000, // Yıllık hedef
                monthlyData: [197988, 405654, 327796, 393035, 526667, 492219, 486509, 0], // Ocak-Temmuz + Ağustos (henüz veri yok)
                augustTarget: 750000, // Ağustos hedefi
                productSales: {
                    netTahsilat: 324069, // 276269 + 47800
                    netEkstre: 162440, // 0 + 162440
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 57.2, // 486509 / 850000 * 100
                    discountRate: 0,
                    newCustomerSales: 5, // 5 yeni müşteri
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 2 // 2 mevcut müşteri referansı
                },
                satisKaynagi: "Mevcut Müşteri",
                satisKaynagiDagilimi: {
                    mevcutMusteri: 477428, // Görsel verisi
                    disTalep: 1222467, // Görsel verisi
                    sdr: 452215, // Görsel verisi
                    isOrtagi: 269667, // Görsel verisi
                    satisEkibi: 259090 // Görsel verisi
                }
            },
            {
                name: "Muhammed Sivaslıgil",
                title: "Eski Çalışan",
                target: 0, // Aylık hedefi yok (işten ayrıldı)
                actual: 0, // Ürün satışları toplamı: 0 + 0 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 3870000, // Yıllık hedef
                monthlyData: [147925, 330000, 108800, 313220, 0, 0, 0], // Ocak-Haziran + Temmuz
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0, // 0 / 0 * 100
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: true, // Temmuz dashboard'da görünsün, yıllıkta silik olacak
                satisKaynagi: "SDR",
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 0, // Eski çalışan
                    isOrtagi: 0,
                    satisEkibi: 0
                }
            },
            {
                name: "Batuhan Arısüt",
                title: "Eski Çalışan",
                target: 0, // Aylık hedefi yok (işten ayrıldı)
                actual: 0, // Ürün satışları toplamı: 0 + 0 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 2050000, // Yıllık hedef
                monthlyData: [158450, 0, 0, 74320, 0, 62700, 0], // Ocak-Haziran + Temmuz
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0, // 0 / 0 * 100
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: true, // Temmuz dashboard'da görünmeyecek, yıllıkta silik olacak
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 0, // Eski çalışan
                    isOrtagi: 0,
                    satisEkibi: 0
                }
            },
            {
                name: "İlter Demirci",
                title: "Eski Çalışan",
                target: 0, // Aylık hedefi yok (işten ayrıldı)
                actual: 0, // Ürün satışları toplamı: 0 + 0 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 3160000, // Yıllık hedef
                monthlyData: [0, 48278, 245595, 76075, 0, 0, 0], // Ocak-Haziran + Temmuz
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0, // 0 / 0 * 100
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: true, // Temmuz dashboard'da görünmeyecek, yıllıkta silik olacak
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 0, // Eski çalışan
                    isOrtagi: 0,
                    satisEkibi: 0
                }
            },
            {
                name: "Egehan Öncü",
                title: "Müdür Yardımcısı",
                target: 672000, // Temmuz hedefi
                actual: 376000, // Ürün satışları toplamı: 270000 + 45000 + 0 + 0 + 0 + 61000
                yearlyTarget: 2322000, // Yıllık hedef
                monthlyData: [0, 0, 0, 79850, 0, 198964, 376000, 80000], // Ocak-Temmuz + Ağustos (Ağustos: 80000 Netahsilat)
                augustTarget: 850000, // Ağustos hedefi
                augustActual: 80000, // Ağustos gerçekleşen (80000 Netahsilat)
                productSales: {
                    netTahsilat: 350000, // 270000 + 80000 (Ağustos Dış Talep)
                    netEkstre: 45000,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 61000,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 56.0, // 376000 / 672000 * 100
                    discountRate: 0,
                    newCustomerSales: 4, // 4 yeni satış
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: false, // Aktif çalışan - her iki dashboard'da da görünecek
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0, // Görsel verisi
                    disTalep: 734814, // Görsel verisi
                    sdr: 0, // Görsel verisi
                    isOrtagi: 0, // Görsel verisi
                    satisEkibi: 0 // Görsel verisi
                }
            },
            {
                name: "Doğukan Kalyoncu",
                title: "Müdür",
                target: 784000, // Temmuz hedefi
                actual: 66000, // Ürün satışları toplamı: 0 + 66000 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 784000, // Yıllık hedef
                monthlyData: [0, 0, 0, 0, 0, 0, 66000, 0], // Ocak-Temmuz + Ağustos (henüz veri yok)
                augustTarget: 750000, // Ağustos hedefi
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 66000, // 0 + 66000
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 8.4, // 66000 / 784000 * 100
                    discountRate: 0,
                    newCustomerSales: 1, // 1 yeni satış
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: false, // Aktif çalışan - her iki dashboard'da da görünecek
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 66000, // Net Ekstre
                    isOrtagi: 0,
                    satisEkibi: 0
                }
            },
            {
                name: "Betül Köse",
                title: "Kıdemli Uzman",
                target: 280000, // Temmuz hedefi
                actual: 0, // Ürün satışları toplamı: 0 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 280000, // Yıllık hedef
                monthlyData: [0, 0, 0, 0, 0, 0, 0, 0], // Ocak-Temmuz + Ağustos (henüz veri yok)
                augustTarget: 250000, // Ağustos hedefi
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0, // 0 / 280000 * 100
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: false, // Aktif çalışan - her iki dashboard'da da görünecek
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 0,
                    isOrtagi: 0,
                    satisEkibi: 0
                }
            },
            {
                name: "Gizem Güler Ilısu",
                title: "Kıdemli Uzman",
                target: 280000, // Temmuz hedefi
                actual: 0, // Ürün satışları toplamı: 0 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 280000, // Yıllık hedef
                monthlyData: [0, 0, 0, 0, 0, 0, 0], // Ocak-Haziran + Temmuz
                augustTarget: 250000, // Ağustos hedefi
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0, // 0 / 280000 * 100
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: false, // Aktif çalışan - her iki dashboard'da da görünecek
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 0,
                    isOrtagi: 0,
                    satisEkibi: 0
                }
            },
            {
                name: "Özge Kaçaroğlu",
                title: "Kıdemli Uzman",
                target: 250000, // Temmuz hedefi
                actual: 0, // Ürün satışları toplamı: 0 + 0 + 0 + 0 + 0 + 0
                yearlyTarget: 250000, // Yıllık hedef
                monthlyData: [0, 0, 0, 0, 0, 0, 0], // Ocak-Haziran + Temmuz
                augustTarget: 250000, // Ağustos hedefi
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0, // 0 / 250000 * 100
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: false, // Aktif çalışan - her iki dashboard'da da görünecek
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 0,
                    isOrtagi: 0,
                    satisEkibi: 0
                }
            },
            {
                name: "Umut Çakıroğlu",
                title: "Satış Direktörü",
                target: 0, // Satış Direktörü - hedef verilmez
                actual: 330000, // Temmuz gerçekleşen
                yearlyTarget: 0, // Satış Direktörü - yıllık hedef verilmez
                monthlyData: [0, 0, 0, 0, 85160, 118625, 330000], // Ocak-Haziran + Temmuz
                augustTarget: 0, // Satış Direktörü - ağustos hedefi verilmez
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0, // Satış Direktörü - hedef olmadığı için 0
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: true, // Dashboard'larda görünmeyecek ama ciroya eklenecek
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 0,
                    isOrtagi: 0,
                    satisEkibi: 330000 // Temmuz gerçekleşen
                }
            },
            {
                name: "Ali Altınay",
                title: "Bölge Müdürü",
                target: 400000, // Temmuz hedefi
                actual: 0, // Temmuz gerçekleşen
                yearlyTarget: 4800000, // Yıllık hedef (4.8M TL)
                monthlyData: [178000, 259458, 194904, 0, 265000, -30000, 0], // Ocak-Haziran + Temmuz
                augustTarget: 500000, // Ağustos hedefi
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0.0, // 0 / 400000 * 100
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                },
                isInactive: true, // Dashboard'larda görünmeyecek ama ciroya eklenecek
                satisKaynagiDagilimi: {
                    mevcutMusteri: 0,
                    disTalep: 0,
                    sdr: 0,
                    isOrtagi: 0,
                    satisEkibi: 0
                }
            }
        ];
        const monthNames = ['Ocak', 'Şubat', 'Mart', 'Nisan', 'Mayıs', 'Haziran', 'Temmuz', 'Ağustos'];

        function getIndicatorClass(value) {
            if (value >= 80) return 'indicator-excellent';
            if (value >= 60) return 'indicator-good';
            if (value >= 40) return 'indicator-warning';
            return 'indicator-danger';
        }

        function getDiscountIndicatorClass(discountRate) {
            if (discountRate <= 10) return 'indicator-excellent';
            if (discountRate <= 15) return 'indicator-good';
            if (discountRate <= 20) return 'indicator-warning';
            return 'indicator-danger';
        }

        function getCountIndicatorClass(count) {
            if (count >= 10) return 'indicator-excellent';
            if (count >= 5) return 'indicator-good';
            if (count >= 2) return 'indicator-warning';
            return 'indicator-danger';
        }

        function showPersonDetail(personData) {
            const modal = document.getElementById('modalOverlay');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            // Kişinin index'ini bul
            const personIndex = salesData.findIndex(p => p.name === personData.name);
            
            // Aktif dashboard'u kontrol et
            const activeDashboard = window.activeDashboard || 'august';
            
            modalTitle.textContent = personData.name + ' - Detaylı Analiz';
            
            const percentage = personData.target > 0 ? (personData.actual / personData.target) * 100 : 0;
            
            let modalContent = '';
            
            // Ürün Kırılımı - Dashboard'a göre farklı veriler göster
            if (activeDashboard === 'july') {
                // Temmuz dashboard'unda tüm kişiler için Temmuz ayı ürün kırılımı (tutarlılık için)
                const julyTotal = personData.actual || 0;
                const netTahsilatJuly = personData.productSales.netTahsilat || 0;
                const netEkstreJuly = personData.productSales.netEkstre || 0;
                const posRaporJuly = personData.productSales.posRapor || 0;
                const tosJuly = personData.productSales.tos || 0;
                const onlineDBSJuly = personData.productSales.onlineDBS || 0;
                const napJuly = personData.productSales.nap || 0;
                const unidoxJuly = personData.productSales.unidox || 0;
                
                modalContent += '<div class="detail-section">';
                modalContent += '<h3>🛍️ Temmuz Ayı Ürün Kırılımı</h3>';
                modalContent += '<div class="detail-grid">';
                modalContent += '<div class="detail-item"><h4>Netahsilat</h4><div class="detail-value editable" id="modal-netTahsilat-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'netTahsilat\')">₺' + netTahsilatJuly.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (julyTotal > 0 ? ((netTahsilatJuly / julyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>Net Ekstre</h4><div class="detail-value editable" id="modal-netEkstre-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'netEkstre\')">₺' + netEkstreJuly.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (julyTotal > 0 ? ((netEkstreJuly / julyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>PosRapor</h4><div class="detail-value editable" id="modal-posRapor-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'posRapor\')">₺' + posRaporJuly.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (julyTotal > 0 ? ((posRaporJuly / julyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>TÖS</h4><div class="detail-value editable" id="modal-tos-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'tos\')">₺' + tosJuly.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (julyTotal > 0 ? ((tosJuly / julyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>Online DBS</h4><div class="detail-value editable" id="modal-onlineDBS-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'onlineDBS\')">₺' + onlineDBSJuly.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (julyTotal > 0 ? ((onlineDBSJuly / julyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>NAP</h4><div class="detail-value editable" id="modal-nap-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'netEkstre\')">₺' + napJuly.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (julyTotal > 0 ? ((napJuly / julyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>UniDOX</h4><div class="detail-value editable" id="modal-unidox-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'netEkstre\')">₺' + unidoxJuly.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (julyTotal > 0 ? ((unidoxJuly / julyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '</div>';
                modalContent += '<div style="text-align: center; margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">';
                modalContent += '<strong>Temmuz Toplam: ₺' + julyTotal.toLocaleString('tr-TR') + '</strong>';
                modalContent += '</div></div>';
            } else if (activeDashboard === 'august') {
                // Ağustos dashboard'unda sadece netTahsilat (diğer veriler henüz yok)
                modalContent += '<div class="detail-section">';
                modalContent += '<h3>🛍️ Ağustos Ayı Ürün Kırılımı</h3>';
                modalContent += '<div class="detail-grid">';
                modalContent += '<div class="detail-item"><h4>Netahsilat</h4><div class="detail-value editable" id="modal-netTahsilat-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'netTahsilat\')">₺' + (personData.augustActual || 0).toLocaleString('tr-TR') + '</div></div>';
                modalContent += '<div class="detail-item"><h4>Net Ekstre</h4><div class="detail-value">₺0</div></div>';
                modalContent += '<div class="detail-item"><h4>PosRapor</h4><div class="detail-value">₺0</div></div>';
                modalContent += '<div class="detail-item"><h4>TÖS</h4><div class="detail-value">₺0</div></div>';
                modalContent += '<div class="detail-item"><h4>Online DBS</h4><div class="detail-value">₺0</div></div>';
                modalContent += '<div class="detail-item"><h4>NAP</h4><div class="detail-value">₺0</div></div>';
                modalContent += '<div class="detail-item"><h4>UniDOX</h4><div class="detail-value">₺0</div></div>';
                modalContent += '</div></div>';
            } else if (activeDashboard === 'yearly') {
                // Yıllık dashboard'da yıllık toplam ürün kırılımı (monthlyData toplamı)
                const yearlyTotal = personData.monthlyData ? personData.monthlyData.reduce((sum, val) => sum + val, 0) : personData.actual;
                const netTahsilatTotal = personData.productSales.netTahsilat || 0;
                const netEkstreTotal = personData.productSales.netEkstre || 0;
                const posRaporTotal = personData.productSales.posRapor || 0;
                const tosTotal = personData.productSales.tos || 0;
                const onlineDBSTotal = personData.productSales.onlineDBS || 0;
                const napTotal = personData.productSales.nap || 0;
                const unidoxTotal = personData.productSales.unidox || 0;
                
                modalContent += '<div class="detail-section">';
                modalContent += '<h3>🛍️ Yıllık Ürün Kırılımı (Ocak - Temmuz)</h3>';
                modalContent += '<div class="detail-grid">';
                modalContent += '<div class="detail-item"><h4>Netahsilat</h4><div class="detail-value editable" id="modal-netTahsilat-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'netTahsilat\')">₺' + netTahsilatTotal.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (yearlyTotal > 0 ? ((netTahsilatTotal / yearlyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>Net Ekstre</h4><div class="detail-value editable" id="modal-netEkstre-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'netEkstre\')">₺' + netEkstreTotal.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (yearlyTotal > 0 ? ((netEkstreTotal / yearlyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>PosRapor</h4><div class="detail-value editable" id="modal-posRapor-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'posRapor\')">₺' + posRaporTotal.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (yearlyTotal > 0 ? ((posRaporTotal / yearlyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>TÖS</h4><div class="detail-value editable" id="modal-tos-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'tos\')">₺' + tosTotal.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (yearlyTotal > 0 ? ((tosTotal / yearlyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>Online DBS</h4><div class="detail-value editable" id="modal-onlineDBS-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'onlineDBS\')">₺' + onlineDBSTotal.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (yearlyTotal > 0 ? ((onlineDBSTotal / yearlyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>NAP</h4><div class="detail-value editable" id="modal-nap-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'nap\')">₺' + napTotal.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (yearlyTotal > 0 ? ((napTotal / yearlyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '<div class="detail-item"><h4>UniDOX</h4><div class="detail-value editable" id="modal-unidox-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'unidox\')">₺' + unidoxTotal.toLocaleString('tr-TR') + '</div><div class="detail-percentage">' + (yearlyTotal > 0 ? ((unidoxTotal / yearlyTotal) * 100).toFixed(1) : '0') + '%</div></div>';
                modalContent += '</div>';
                modalContent += '<div style="text-align: center; margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">';
                modalContent += '<strong>Yıllık Toplam: ₺' + yearlyTotal.toLocaleString('tr-TR') + '</strong>';
                modalContent += '</div></div>';
            }
            
            // Satış Kaynağına Göre Dağılım Grafiği
            modalContent += '<div class="detail-section">';
            modalContent += '<h3>📊 Satış Kaynağına Göre Dağılım</h3>';
            modalContent += '<div class="sales-source-grid" id="personSalesSourceGrid-' + personIndex + '">';
            modalContent += '</div>';
            modalContent += '</div>';
            

            
            // Dashboard bilgisi ekle
            if (activeDashboard === 'august') {
                modalContent += '<div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px; margin: 15px 0; text-align: center; color: #856404;">';
                modalContent += '<strong>📊 Ağustos Dashboard</strong><br>';
                modalContent += '<small>Bu veriler Ağustos ayı için henüz girilmemiştir. Gerçek veriler girildiğinde yıllık dashboard\'a otomatik olarak eklenecektir.</small>';
                modalContent += '</div>';
            } else if (activeDashboard === 'yearly') {
                modalContent += '<div style="background: #d1ecf1; border: 1px solid #bee5eb; padding: 10px; border-radius: 5px; margin: 15px 0; text-align: center; color: #0c5460;">';
                modalContent += '<strong>📊 Yıllık Dashboard</strong><br>';
                modalContent += '<small>Bu veriler Ocak - Temmuz aylarının toplamıdır. Yıllık dashboard\'da tüm ürün kırılımı ve satış kaynağı verileri görüntülenmektedir.</small>';
                modalContent += '</div>';
            }
            
            // Hedef Durumu
            const yearlyTarget = personData.yearlyTarget || personData.target; // Yıllık hedef doğrudan yearlyTarget'tan alınır
            // Yıllık gerçekleşen hesaplama - İlk 7 ayın monthlyData toplamını hesapla
            let yearlyActual;
            if (personData.monthlyData && personData.monthlyData.length >= 7) {
                // İlk 7 ayın monthlyData toplamını hesapla (yıllık toplam)
                yearlyActual = personData.monthlyData.reduce((sum, val) => sum + val, 0);
                console.log(`${personData.name} modal'da yıllık toplam: ₺${yearlyActual.toLocaleString('tr-TR')} (monthlyData toplamı)`);
            } else {
                yearlyActual = personData.actual;
            }
            const yearlyPercentage = yearlyTarget > 0 ? Math.min((yearlyActual / yearlyTarget) * 100, 100) : 0;
            
            modalContent += '<div class="detail-section">';
            modalContent += '<h3>📊 Hedef Durumu <span style="font-size: 0.8em; color: #666; font-weight: normal;">(Yıllık)</span></h3>';
            modalContent += '<div class="target-progress">';
            modalContent += '<div style="display: flex; justify-content: space-between; margin-bottom: 15px; font-weight: 600;">';
            modalContent += '<span>Yıllık Hedef: <span class="detail-value editable" id="modal-yearly-target-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'yearlyTarget\')">₺' + yearlyTarget.toLocaleString('tr-TR') + '</span></span>';
            modalContent += '<span>Yıllık Gerçekleşen: <span class="detail-value editable" id="modal-yearly-actual-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'yearlyActual\')">₺' + yearlyActual.toLocaleString('tr-TR') + '</span></span>';
            modalContent += '</div>';
            modalContent += '<div class="progress-bar">';
            modalContent += '<div class="progress-fill" style="width: ' + Math.min(yearlyPercentage, 100) + '%">';
            modalContent += '<div class="progress-text">' + yearlyPercentage.toFixed(1) + '%</div>';
            modalContent += '</div></div>';
            modalContent += '<div style="text-align: center; margin-top: 15px; color: #666; font-weight: 500;">';
            modalContent += 'Yıllık Kalan: ₺' + (yearlyTarget - yearlyActual).toLocaleString('tr-TR');
            modalContent += '</div></div></div>';
            
            // Aylık Hedef Durumu - Tutarlı hesaplama
            const monthlyTarget = personData.target; // Aylık hedef
            const monthlyActual = personData.actual; // Aylık gerçekleşen (productSales toplamı)
            const monthlyPercentage = monthlyTarget > 0 ? Math.min((monthlyActual / monthlyTarget) * 100, 100) : 0;
            
            modalContent += '<div class="detail-section">';
            modalContent += '<h3>📊 Hedef Durumu <span style="font-size: 0.8em; color: #666; font-weight: normal;">(Aylık)</span></h3>';
            modalContent += '<div class="target-progress">';
            modalContent += '<div style="display: flex; justify-content: space-between; margin-bottom: 15px; font-weight: 600;">';
            modalContent += '<span>Aylık Hedef: <span class="detail-value editable" id="modal-monthly-target-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'monthlyTarget\')">₺' + monthlyTarget.toLocaleString('tr-TR') + '</span></span>';
            modalContent += '<span>Aylık Gerçekleşen: <span class="detail-value editable" id="modal-monthly-actual-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'monthlyActual\')">₺' + monthlyActual.toLocaleString('tr-TR') + '</span></span>';
            modalContent += '</div>';
            modalContent += '<div class="progress-bar">';
            modalContent += '<div class="progress-fill" style="width: ' + Math.min(monthlyPercentage, 100) + '%">';
            modalContent += '<div class="progress-text">' + monthlyPercentage.toFixed(1) + '%</div>';
            modalContent += '</div></div>';
            modalContent += '<div style="text-align: center; margin-top: 15px; color: #666; font-weight: 500;">';
            modalContent += 'Aylık Kalan: ₺' + (monthlyTarget - monthlyActual).toLocaleString('tr-TR');
            modalContent += '</div></div></div>';
            
            // Aylık Performans
            modalContent += '<div class="detail-section">';
            modalContent += '<h2 style="font-size: 1.5em; margin-bottom: 18px; display: flex; align-items: center; gap: 10px;">';
            if (activeDashboard === 'august') {
                modalContent += '<span style="font-size: 1.2em;">📈</span> Aylık Performans (Ocak - Temmuz)';
            } else if (activeDashboard === 'yearly') {
                modalContent += '<span style="font-size: 1.2em;">📈</span> Aylık Performans (Ocak - Temmuz)';
            } else {
                modalContent += '<span style="font-size: 1.2em;">📈</span> Aylık Performans (Ocak - Haziran)';
            }
            modalContent += '</h2>';
            modalContent += '<div class="monthly-chart">';
            modalContent += '<div class="chart-bars">';
            
            let monthlyData;
            if (activeDashboard === 'august' || activeDashboard === 'yearly') {
                // Ağustos ve yıllık dashboard'da Temmuz verilerini de dahil et
                monthlyData = personData.monthlyData.slice(0, 7);
            } else {
                // Temmuz dashboard'da sadece ilk 6 ay
                monthlyData = personData.monthlyData.slice(0, 6);
            }
            const maxValue = Math.max.apply(Math, monthlyData);
            
            for (let i = 0; i < monthlyData.length; i++) {
                const value = monthlyData[i];
                const height = maxValue > 0 ? (value / maxValue) * 120 : 0;
                
                modalContent += '<div class="chart-bar" style="height: ' + height + 'px;">';
                modalContent += '<div class="bar-value editable" id="modal-monthly-' + i + '-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'monthly\', ' + i + ')">₺' + (value/1000).toFixed(0) + 'K</div>';
                modalContent += '<div class="bar-label">' + monthNames[i] + '</div>';
                modalContent += '</div>';
            }
            
            modalContent += '</div></div></div>';
            
            // Performans Göstergeleri
            modalContent += '<div class="detail-section">';
            modalContent += '<h3>🎯 Aylık Performans Göstergeleri</h3>';
            modalContent += '<div class="performance-indicators">';
            modalContent += '<div class="indicator ' + getIndicatorClass(personData.performanceKPIs.targetRealizationRate) + '">';
            modalContent += '<h4>TL Hedef Gerçekleşme</h4>';
            modalContent += '<div class="editable" id="modal-targetRealizationRate-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'targetRealizationRate\')" style="font-size: 1.5em; font-weight: bold; cursor: pointer;">' + personData.performanceKPIs.targetRealizationRate.toFixed(1) + '%</div>';
            modalContent += '</div>';
            modalContent += '<div class="indicator ' + getDiscountIndicatorClass(personData.performanceKPIs.discountRate) + '">';
            modalContent += '<h4>İskonto Oranı</h4>';
            modalContent += '<div class="editable" id="modal-discountRate-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'discountRate\')" style="font-size: 1.5em; font-weight: bold; cursor: pointer;">' + personData.performanceKPIs.discountRate.toFixed(1) + '%</div>';
            modalContent += '</div>';
            modalContent += '<div class="indicator ' + getCountIndicatorClass(personData.performanceKPIs.newCustomerSales) + '">';
            modalContent += '<h4>Yeni Müşteri Edinim</h4>';
            modalContent += '<div class="editable" id="modal-newCustomerSales-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'newCustomerSales\')" style="font-size: 1.5em; font-weight: bold; cursor: pointer;">' + personData.performanceKPIs.newCustomerSales + ' Adet</div>';
            modalContent += '</div>';
            modalContent += '<div class="indicator ' + getCountIndicatorClass(personData.performanceKPIs.newCustomerContacts) + '">';
            modalContent += '<h4>Yeni Müşteri Temas</h4>';
            modalContent += '<div class="editable" id="modal-newCustomerContacts-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'newCustomerContacts\')" style="font-size: 1.5em; font-weight: bold; cursor: pointer;">' + personData.performanceKPIs.newCustomerContacts + ' Adet</div>';
            modalContent += '</div>';
            modalContent += '<div class="indicator ' + getCountIndicatorClass(personData.performanceKPIs.groupCompanyReferrals) + '">';
            modalContent += '<h4>Grup Firma Yönlendirme</h4>';
            modalContent += '<div class="editable" id="modal-groupCompanyReferrals-' + personIndex + '" onclick="startModalEdit(' + personIndex + ', \'groupCompanyReferrals\')" style="font-size: 1.5em; font-weight: bold; cursor: pointer;">' + personData.performanceKPIs.groupCompanyReferrals + ' Adet</div>';
            modalContent += '</div>';
            modalContent += '</div></div>';
            
            modalBody.innerHTML = modalContent;
            modal.style.display = 'flex';
            
            // Satış kaynağı kutucuklarını render et
            renderPersonSalesSourceGrid(personData, personIndex);
            

        }

        function renderPersonSalesSourceGrid(personData, personIndex) {
            const grid = document.getElementById('personSalesSourceGrid-' + personIndex);
            if (!grid) return;
            
            // Dashboard'a göre satış kaynağı türlerini belirle
            let salesSourceTypes;
            if (activeDashboard === 'august') {
                salesSourceTypes = ['Henüz Veri Yok'];
            } else if (activeDashboard === 'yearly') {
                salesSourceTypes = [
                    'Dış Talep',
                    'SDR',
                    'Mevcut Müşteri',
                    'İş Ortaklıkları',
                    'Şirket'
                ];
            } else {
                salesSourceTypes = [
                    'Dış Talep',
                    'SDR',
                    'Mevcut Müşteri',
                    'İş Ortaklıkları',
                    'Şirket'
                ];
            }
            
            // Satış kaynağı türlerine göre dağılımı hesapla
            const salesSourceData = {};
            salesSourceTypes.forEach(type => salesSourceData[type] = 0);
            
            // Dashboard'a göre satış kaynağı verilerini ayarla
            if (activeDashboard === 'august') {
                // Ağustos dashboard'da Ağustos verilerini kullan
                if (personData.name === "Fahri Aktoz" && personData.augustActual) {
                    // Fahri için Ağustos netTahsilat verisi
                    if (personData.satisKaynagi) {
                        salesSourceData[personData.satisKaynagi] = personData.augustActual || 0;
                        // Ağustos için satış kaynağı türlerini güncelle
                        salesSourceTypes = [personData.satisKaynagi];
                    }
                } else {
                    // Diğerleri için henüz Ağustos verisi yok
                    salesSourceData['Henüz Veri Yok'] = 0;
                }
            } else if (activeDashboard === 'yearly') {
                // Yıllık dashboard'da yıllık toplam verileri kullan
                if (personData.satisKaynagiDagilimi) {
                    salesSourceData['Mevcut Müşteri'] = personData.satisKaynagiDagilimi.mevcutMusteri || 0;
                    salesSourceData['Dış Talep'] = personData.satisKaynagiDagilimi.disTalep || 0;
                    salesSourceData['SDR'] = personData.satisKaynagiDagilimi.sdr || 0;
                    salesSourceData['İş Ortaklıkları'] = personData.satisKaynagiDagilimi.isOrtagi || 0;
                    salesSourceData['Şirket'] = personData.satisKaynagiDagilimi.satisEkibi || 0;
                } else {
                    // Eski yöntem - ana satış kaynağına yıllık toplam tutarı ata
                    if (personData.satisKaynagi) {
                        const yearlyTotal = personData.monthlyData ? personData.monthlyData.reduce((sum, val) => sum + val, 0) : personData.actual;
                        salesSourceData[personData.satisKaynagi] = yearlyTotal || 0;
                    }
                }
            } else {
                // Temmuz dashboard'da aylık verileri kullan
                if (personData.satisKaynagiDagilimi) {
                    salesSourceData['Mevcut Müşteri'] = personData.satisKaynagiDagilimi.mevcutMusteri || 0;
                    salesSourceData['Dış Talep'] = personData.satisKaynagiDagilimi.disTalep || 0;
                    salesSourceData['SDR'] = personData.satisKaynagiDagilimi.sdr || 0;
                    salesSourceData['İş Ortaklıkları'] = personData.satisKaynagiDagilimi.isOrtagi || 0;
                    salesSourceData['Şirket'] = personData.satisKaynagiDagilimi.satisEkibi || 0;
                } else {
                    // Eski yöntem - ana satış kaynağına aylık tutarı ata
                    if (personData.satisKaynagi) {
                        salesSourceData[personData.satisKaynagi] = personData.actual || 0;
                    }
                }
            }
            
            // Toplam değeri hesapla
            const total = Object.values(salesSourceData).reduce((sum, val) => sum + val, 0);
            
            if (total === 0) {
                // Veri yoksa mesaj göster
                grid.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">Satış kaynağı verisi bulunamadı</div>';
                return;
            }
            
            // HTML kutucukları oluştur
            let html = '';
            
            // Renkler (satış kaynağı türleri için)
            const colors = [
                '#3B82F6', // Dış Talep - Mavi
                '#F59E0B', // SDR - Turuncu
                '#6B7280', // Mevcut Müşteri - Gri
                '#FCD34D', // İş Ortakları - Sarı
                '#1E40AF'  // Şirket - Koyu Mavi
            ];
            
            // Her satış kaynağı için kutucuk oluştur
            salesSourceTypes.forEach((type, index) => {
                const value = salesSourceData[type] || 0;
                if (value > 0) {
                    const percentage = ((value / total) * 100).toFixed(1);
                    const color = colors[index % colors.length];
                    
                    html += '<div class="sales-source-card" style="background: white; border: 2px solid ' + color + '; border-radius: 8px; padding: 15px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">';
                    html += '<div style="font-size: 14px; color: #666; margin-bottom: 8px;">' + type + '</div>';
                    html += '<div style="font-size: 18px; font-weight: bold; color: #333; margin-bottom: 5px;">₺' + (value/1000).toFixed(0) + 'K</div>';
                    html += '<div style="font-size: 12px; color: #666;">%' + percentage + '</div>';
                    html += '</div>';
                }
            });
            
            // Toplam kutucuğu ekle
            html += '<div class="sales-source-card" style="background: #f8f9fa; border: 2px solid #6c757d; border-radius: 8px; padding: 15px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">';
            html += '<div style="font-size: 14px; color: #666; margin-bottom: 8px;">Toplam</div>';
            html += '<div style="font-size: 18px; font-weight: bold; color: #333;">₺' + (total/1000).toFixed(0) + 'K</div>';
            html += '</div>';
            
            // Grid'e HTML'i ekle
            grid.innerHTML = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; padding: 20px;">' + html + '</div>';
        }

        

        function closeModal(event) {
            if (event && event.target !== event.currentTarget) return;
            document.getElementById('modalOverlay').style.display = 'none';
        }

        function createSpeedometer(data, index) {
            const percentage = data.target > 0 ? (data.actual / data.target) * 100 : 0;


            
            const angle = 180 - Math.min(percentage / 100, 1) * 180;
            const needleRad = (angle * Math.PI) / 180;
            const needleLength = 80;
            const needleX = needleLength * Math.cos(needleRad);
            const needleY = -needleLength * Math.sin(needleRad);
            
            let badgeClass = "badge-excellent";
            let badgeText = "Mükemmel";
            
            if (percentage < 50) {
                badgeClass = "badge-needs-improvement";
                badgeText = "Hedef Altında";
            } else if (percentage < 80) {
                badgeClass = "badge-good";
                badgeText = "İyi";
            }
            
            const cleanName = data.name.replace(/\s+/g, '').replace(/[^a-zA-Z0-9]/g, '');
            
            // Ağustos dashboard için özel SVG oluştur
            let svg;
            if (window.activeDashboard === 'august' || window.activeDashboard === 'september') {
                // Ağustos için gradient ID'yi farklı yap
                const gradId = (window.activeDashboard === 'september' ? 'september' : 'august') + '-gradient-' + cleanName;
                svg = '<svg class="speedometer-svg" viewBox="0 0 280 180"><defs><linearGradient id="' + gradId + '" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#dc3545;stop-opacity:1" /><stop offset="50%" style="stop-color:#ffc107;stop-opacity:1" /><stop offset="100%" style="stop-color:#28a745;stop-opacity:1" /></linearGradient></defs><path d="M 40 140 A 100 100 0 0 1 240 140" fill="none" stroke="#e9ecef" stroke-width="20" stroke-linecap="round"/><path d="M 40 140 A 100 100 0 0 1 240 140" fill="none" stroke="url(#' + gradId + ')" stroke-width="20" stroke-linecap="round" stroke-dasharray="' + (percentage > 0 ? (percentage / 100 * 314) : 0) + ' 314"/><g transform="translate(140, 140)"><line x1="0" y1="0" x2="' + needleX + '" y2="' + needleY + '" stroke="#333" stroke-width="3" stroke-linecap="round"/><circle cx="0" cy="0" r="8" fill="#333"/><circle cx="0" cy="0" r="4" fill="white"/></g><text x="140" y="120" text-anchor="middle" font-size="24" font-weight="bold" fill="#333">' + percentage.toFixed(0) + '%</text><g transform="translate(140, 140)"><text x="-75" y="55" text-anchor="middle" font-size="12" fill="#666">0%</text><text x="0" y="-95" text-anchor="middle" font-size="12" fill="#666">50%</text><text x="75" y="55" text-anchor="middle" font-size="12" fill="#666">100%</text><line x1="-70" y1="70" x2="-60" y2="60" stroke="#999" stroke-width="2"/><line x1="70" y1="70" x2="60" y2="60" stroke="#999" stroke-width="2"/></g></svg>';
            } else {
                // Temmuz için normal SVG
                svg = '<svg class="speedometer-svg" viewBox="0 0 280 180"><defs><linearGradient id="gradient-' + cleanName + '" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#dc3545;stop-opacity:1" /><stop offset="50%" style="stop-color:#ffc107;stop-opacity:1" /><stop offset="100%" style="stop-color:#28a745;stop-opacity:1" /></linearGradient></defs><path d="M 40 140 A 100 100 0 0 1 240 140" fill="none" stroke="#e9ecef" stroke-width="20" stroke-linecap="round"/><path d="M 40 140 A 100 100 0 0 1 240 140" fill="none" stroke="url(#gradient-' + cleanName + ')" stroke-width="20" stroke-linecap="round" stroke-dasharray="' + (percentage > 0 ? (percentage / 100 * 314) : 0) + ' 314"/><g transform="translate(140, 140)"><line x1="0" y1="0" x2="' + needleX + '" y2="' + needleY + '" stroke="#333" stroke-width="3" stroke-linecap="round"/><circle cx="0" cy="0" r="8" fill="#333"/><circle cx="0" cy="0" r="4" fill="white"/></g><text x="140" y="120" text-anchor="middle" font-size="24" font-weight="bold" fill="#666">' + percentage.toFixed(0) + '%</text><g transform="translate(140, 140)"><text x="-75" y="55" text-anchor="middle" font-size="12" fill="#666">0%</text><text x="0" y="-95" text-anchor="middle" font-size="12" fill="#666">50%</text><text x="75" y="55" text-anchor="middle" font-size="12" fill="#666">100%</text><line x1="-70" y1="70" x2="-60" y2="60" stroke="#999" stroke-width="2"/><line x1="70" y1="70" x2="60" y2="60" stroke="#999" stroke-width="2"/></g></svg>';
            }
            

            

            
            return '<div class="speedometer-card" onclick="showPersonDetail(' + JSON.stringify(data).replace(/"/g, '&quot;') + ')" data-index="' + (index ?? '') + '">' +
                '<div class="achievement-badge ' + badgeClass + '">' + badgeText + '</div>' +
                '<div class="card-header">' +
                    '<h3 style="margin-bottom: 2px;">' + data.name + '</h3>' +
                    (data.title ? '<div class="person-title">' + capitalizeTitle(data.title) + '</div>' : '') +
                '</div>' +
                '<div class="speedometer-container">' + svg + '</div>' +
                '<div class="stats-container" id="stats-' + (index ?? '') + '">' +
                    '<div class="stat-item"><div class="stat-label">Hedef</div><div class="stat-value" id="target-' + (index ?? '') + '">₺' + data.target.toLocaleString('tr-TR') + '</div></div>' +
                    '<div class="stat-item"><div class="stat-label">Gerçekleşen</div><div class="stat-value" id="actual-' + (index ?? '') + '">₺' + data.actual.toLocaleString('tr-TR') + '</div></div>' +
                    '<div class="stat-item"><div class="stat-label">Başarı</div><div class="stat-value">' + percentage.toFixed(0) + '%</div></div>' +
                '</div>' +
            '</div>';
        }
        function renderSummary() {
                            // Temmuz dashboard ile aynı filtreyi kullan (kartlar için)
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && 
                person.name !== "Ali Altınay" && 
                !person.isInactive
            );
            
            // Toplam hedef ve gerçekleşen hesaplamaları için tüm aktif kişileri dahil et (Umut Çakıroğlu dahil)
            const allActiveData = salesData.filter(person => 
                person.name !== "Ali Altınay"
            );
            
            const totalTarget = allActiveData.reduce(function(sum, item) {
                return sum + item.target;
            }, 0);
            
            // Tüm aktif kişilerin person.actual değerlerini topla (Umut Çakıroğlu dahil)
            const totalActual = allActiveData.reduce(function(sum, item) {
                return sum + item.actual;
            }, 0);
            
            const successRate = totalTarget > 0 ? (totalActual / totalTarget) * 100 : 0;
            // Sadece görünür kişi kartlarını say (Umut Çakıroğlu hariç)
            const totalCount = visibleData.length;
            document.getElementById('summaryStats').innerHTML = '<div class="summary-stat"><h4>Toplam Hedef</h4><div class="value">₺' + totalTarget.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Gerçekleşen</h4><div class="value">₺' + totalActual.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Başarı Oranı</h4><div class="value">' + successRate.toFixed(0) + '%</div></div><div class="summary-stat"><h4>Satış Yöneticisi</h4><div class="value">' + totalCount + '</div></div>';
        }
        
        function renderAugustSummary() {
            // Ağustos dashboard ile aynı filtreyi kullan (kartlar için)
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && 
                person.name !== "Ali Altınay" && 
                !person.isInactive
            );
            
            // Ağustos hedefleri ve gerçekleşenleri hesapla
            const totalTarget = visibleData.reduce((sum, person) => sum + (person.augustTarget || 0), 0);
            const totalActual = visibleData.reduce((sum, person) => {
                if (person.name === "Fahri Aktoz") {
                    return sum + (person.augustActual || 0); // Fahri'nin Ağustos verisi
                } else if (person.name === "Damla Kalemtaş") {
                    return sum + (person.augustActual || 0); // Damla'nın Ağustos verisi
                } else if (person.name === "Güven Gürkan Salıkoç") {
                    return sum + (person.augustActual || 0); // Güven'in Ağustos verisi
                } else if (person.name === "Hüseyin Çakmak") {
                    return sum + (person.augustActual || 0); // Hüseyin'in Ağustos verisi
                } else if (person.name === "Egehan Öncü") {
                    return sum + (person.augustActual || 0); // Egehan'ın Ağustos verisi
                }
                return sum + 0; // Diğerleri için henüz veri yok
            }, 0);
            const successRate = totalTarget > 0 ? (totalActual / totalTarget) * 100 : 0;
            const totalCount = visibleData.length;
            
            // Ağustos summary için yeni bir element oluştur veya mevcut olanı kullan
            const augustSummaryElement = document.getElementById('augustSummaryStats') || document.getElementById('summaryStats');
            augustSummaryElement.innerHTML = '<div class="summary-stat"><h4>Toplam Hedef</h4><div class="value">₺' + totalTarget.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Gerçekleşen</h4><div class="value">₺' + totalActual.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Başarı Oranı</h4><div class="value">' + successRate.toFixed(0) + '%</div></div><div class="summary-stat"><h4>Satış Yöneticisi</h4><div class="value">' + totalCount + '</div></div>';
        }

        function renderDashboard() {
            const grid = document.getElementById('speedometerGrid');
            let html = '';
            
            // Umut Çakıroğlu, Ali Altınay ve pasif çalışanları gizle (kartları görünmesin)
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && 
                person.name !== "Ali Altınay" && 
                !person.isInactive
            );
            
            // Kartları başarı oranına göre azalan sırala (gerçekleşen/hedef oranı)
            const sortedData = [...visibleData].sort((a, b) => {
                const aRate = a.target > 0 ? (a.actual / a.target) * 100 : 0;
                const bRate = b.target > 0 ? (b.actual / b.target) * 100 : 0;
                return bRate - aRate;
            });
            for (let i = 0; i < sortedData.length; i++) {
                html += createSpeedometer(sortedData[i], salesData.indexOf(sortedData[i]));
            }
            grid.innerHTML = html;
            
            // Drag & Drop fonksiyonlarını ekle
            initializeDragAndDrop('speedometerGrid');
            renderSummary();
        }
        
        function renderAugustDashboard() {
            const grid = document.getElementById('augustSpeedometerGrid');
            let html = '';
            
            // Umut Çakıroğlu, Ali Altınay ve pasif çalışanları gizle (kartları görünmesin)
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && 
                person.name !== "Ali Altınay" && 
                !person.isInactive
            );
            
            // Ağustos için verileri hazırla
            const augustData = visibleData.map(person => {
                if (person.name === "Fahri Aktoz") {
                    // Fahri için Ağustos verilerini kullan
                    const fahriData = {
                        ...person,
                        actual: person.augustActual || 0, // Ağustos gerçekleşen
                        target: person.augustTarget || 0, // Ağustos hedefi
                        satisKaynagi: "SDR", // Ağustos'ta SDR kaynağından
                        productSales: {
                            netTahsilat: person.augustActual || 0, // Ağustos netTahsilat
                            netEkstre: 0,
                            posRapor: 0,
                            tos: 0,
                            onlineDBS: 0,
                            nap: 0,
                            unidox: 0
                        },
                        performanceKPIs: {
                            targetRealizationRate: person.augustTargetRealizationRate || 0,
                            discountRate: 0,
                            newCustomerSales: 0,
                            newCustomerContacts: 0,
                            groupCompanyReferrals: 0
                        }
                    };

                    return fahriData;
                } else if (person.name === "Damla Kalemtaş") {
                    // Damla için Ağustos verilerini kullan
                    const damlaData = {
                        ...person,
                        actual: person.augustActual || 0, // Ağustos gerçekleşen
                        target: person.augustTarget || 0, // Ağustos hedefi
                        satisKaynagi: "Satış Ekibi", // Ağustos'ta Satış Ekibi kaynağından
                        productSales: {
                            netTahsilat: 18000, // Ağustos Netahsilat (Dış Talep)
                            netEkstre: 73000, // Ağustos Netekstre (Mevcut Müşteri)
                            posRapor: 0,
                            tos: 0,
                            onlineDBS: 0,
                            nap: 0,
                            unidox: 0
                        },
                        performanceKPIs: {
                            targetRealizationRate: person.augustTarget > 0 ? (person.augustActual / person.augustTarget) * 100 : 0,
                            discountRate: 0,
                            newCustomerSales: 0,
                            newCustomerContacts: 0,
                            groupCompanyReferrals: 0
                        }
                    };

                    return damlaData;
                } else if (person.name === "Güven Gürkan Salıkoç") {
                    // Güven için Ağustos verilerini kullan
                    const guvenData = {
                        ...person,
                        actual: person.augustActual || 0, // Ağustos gerçekleşen
                        target: person.augustTarget || 0, // Ağustos hedefi
                        satisKaynagi: "Dış Talep", // Ağustos'ta Dış Talep kaynağından
                        productSales: {
                            netTahsilat: 60000, // Ağustos Netahsilat (Dış Talep)
                            netEkstre: 0,
                            posRapor: 0,
                            tos: 0,
                            onlineDBS: 0,
                            nap: 0,
                            unidox: 0
                        },
                        performanceKPIs: {
                            targetRealizationRate: person.augustTarget > 0 ? (person.augustActual / person.augustTarget) * 100 : 0,
                            discountRate: 0,
                            newCustomerSales: 0,
                            newCustomerContacts: 0,
                            groupCompanyReferrals: 0
                        }
                    };

                    return guvenData;
                } else if (person.name === "Hüseyin Çakmak") {
                    // Hüseyin için Ağustos verilerini kullan
                    const huseyinData = {
                        ...person,
                        actual: person.augustActual || 0, // Ağustos gerçekleşen
                        target: person.augustTarget || 0, // Ağustos hedefi
                        satisKaynagi: "SDR", // Ağustos'ta SDR kaynağından
                        productSales: {
                            netTahsilat: 130000, // Ağustos Netahsilat (Dış Talep)
                            netEkstre: 70000, // Ağustos Netekstre (İş Ortağı)
                            posRapor: 89840, // Ağustos PosRapor (33840 Mevcut Müşteri + 56000 İş Ortağı)
                            tos: 0,
                            onlineDBS: 0,
                            nap: 0,
                            unidox: 95000 // Ağustos UniDOX (Mevcut Müşteri Kronospan)
                        },
                        performanceKPIs: {
                            targetRealizationRate: person.augustTarget > 0 ? (person.augustActual / person.augustTarget) * 100 : 0,
                            discountRate: 0,
                            newCustomerSales: 0,
                            newCustomerContacts: 0,
                            groupCompanyReferrals: 0
                        }
                    };

                    return huseyinData;
                } else if (person.name === "Egehan Öncü") {
                    // Egehan için Ağustos verilerini kullan
                    const egehanData = {
                        ...person,
                        actual: person.augustActual || 0, // Ağustos gerçekleşen
                        target: person.augustTarget || 0, // Ağustos hedefi
                        satisKaynagi: "Dış Talep", // Ağustos'ta Dış Talep kaynağından
                        productSales: {
                            netTahsilat: 80000, // Ağustos Netahsilat (Dış Talep)
                            netEkstre: 0,
                            posRapor: 0,
                            tos: 0,
                            onlineDBS: 0,
                            nap: 0,
                            unidox: 0
                        },
                        performanceKPIs: {
                            targetRealizationRate: person.augustTarget > 0 ? (person.augustActual / person.augustTarget) * 100 : 0,
                            discountRate: 0,
                            newCustomerSales: 0,
                            newCustomerContacts: 0,
                            groupCompanyReferrals: 0
                        }
                    };

                    return egehanData;
                } else {
                    // Diğer kişiler için sıfır değerler
                    return {
                        ...person,
                        actual: 0, // Ağustos verileri henüz girilmemiş
                        target: person.augustTarget || 0, // Ağustos hedefleri
                        productSales: {
                            netTahsilat: 0,
                            posRapor: 0,
                            tos: 0,
                            onlineDBS: 0,
                            nap: 0,
                            unidox: 0
                        },
                        performanceKPIs: {
                            targetRealizationRate: 0,
                            discountRate: 0,
                            newCustomerSales: 0,
                            newCustomerContacts: 0,
                            groupCompanyReferrals: 0
                        }
                    };
                }
            });
            
            // Kartları başarı oranına göre azalan sırala (gerçekleşen/hedef oranı)
            const sortedData = [...augustData].sort((a, b) => {
                const aRate = a.target > 0 ? (a.actual / a.target) * 100 : 0;
                const bRate = b.target > 0 ? (b.actual / b.target) * 100 : 0;
                return bRate - aRate; // En yüksek oran en üstte
            });
            
            for (let i = 0; i < sortedData.length; i++) {
                const personIndex = salesData.findIndex(p => p.name === sortedData[i].name);
                html += createSpeedometer(sortedData[i], personIndex);
            }
            grid.innerHTML = html;
            
            // Drag & Drop fonksiyonlarını ekle
            initializeDragAndDrop('augustSpeedometerGrid');
            renderAugustSummary();
        }

        function renderSeptemberDashboard() {
            const grid = document.getElementById('septemberSpeedometerGrid');
            let html = '';

            // Eylül'de de aynı görünürlük filtresi
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && 
                person.name !== "Ali Altınay" && 
                !person.isInactive
            );

            // Eylül hedefleri
            const septemberTargets = {
                "Betül Köse": 450000,
                "Damla Kalemtaş": 850000,
                "Egehan Öncü": 850000,
                "Fahri Aktoz": 1250000,
                "Güven Gürkan Salıkoç": 650000,
                "Hüseyin Çakmak": 1250000,
                "Özge Kaçaroğlu": 450000,
                "Sebahat Çay": 1300000,
                "Tuğçe Bugakaptan": 850000,
                "Umut Karaerarslan": 850000,
                "Gizem Güler Ilısu": 450000
            };

            // Görseldeki tablo Eylül ayı satış satırlarını temsil ediyor
            // Aşağıdaki eylulSalesLines objesi, kişi adını anahtar; ürün ve tutar toplamlarını değer olarak tutar
            const eylulSalesLines = {
                "Betül Köse": { netTahsilat: 97458 + 102000, netEkstre: 135000, posRapor: 80000 },
                "Damla Kalemtaş": { netTahsilat: 120000 + 72000, netEkstre: 25000, posRapor: 0 },
                "Egehan Öncü": { netTahsilat: 96192 + 250000 + 160000, netEkstre: 39000 + 65000, posRapor: 85000 + 60000 },
                "Fahri Aktoz": { netTahsilat: 0, netEkstre: 110000, posRapor: 0 },
                "Güven Gürkan Salıkoç": { netTahsilat: 89500 + 89500 + 100000, netEkstre: 36866, posRapor: 0 },
                "Hüseyin Çakmak": { netTahsilat: 250000, netEkstre: 33896 + 105000 + 105000, posRapor: 60000 + 33666 + 105000 + 105000 },
                "Özge Kaçaroğlu": { netTahsilat: 55000, netEkstre: 0, posRapor: 0 },
                "Sebahat Çay": { netTahsilat: 149944, netEkstre: 50000, posRapor: 50000 },
                "Tuğçe Bugakaptan": { netTahsilat: 48499 + 200000, netEkstre: 53040 + 55896 + 73093, posRapor: 0 },
                "Umut Karaerarslan": { netTahsilat: 160000 + 90000 + 96822 + 143896 + 250000 + 339276, netEkstre: 0, posRapor: 0 }
            };

            // Veriler birleşik tutuluyor

            // Hedefi Eylül için Ağustos hedefiyle aynı tut; veri yoksa 0
            const septemberData = visibleData.map(person => {
                const sums = eylulSalesLines[person.name] || { netTahsilat: 0, netEkstre: 0, posRapor: 0 };
                const actual = (sums.netTahsilat || 0) + (sums.netEkstre || 0) + (sums.posRapor || 0);
                return {
                    ...person,
                    actual: actual,
                    target: septemberTargets[person.name] || person.septemberTarget || person.augustTarget || person.target || 0,
                    productSales: {
                        netTahsilat: sums.netTahsilat || 0,
                        netEkstre: sums.netEkstre || 0,
                        posRapor: sums.posRapor || 0,
                        tos: 0,
                        onlineDBS: 0,
                        nap: 0,
                        unidox: 0
                    }
                };
            });

            // Başarı oranına göre sırala
            const sortedData = [...septemberData].sort((a, b) => {
                const aRate = a.target > 0 ? (a.actual / a.target) * 100 : 0;
                const bRate = b.target > 0 ? (b.actual / b.target) * 100 : 0;
                return bRate - aRate;
            });

            for (let i = 0; i < sortedData.length; i++) {
                const personIndex = salesData.findIndex(p => p.name === sortedData[i].name);
                html += createSpeedometer(sortedData[i], personIndex);
            }
            grid.innerHTML = html;

            // Drag & Drop
            initializeDragAndDrop('septemberSpeedometerGrid');
            renderSeptemberSummary(eylulSalesLines);
        }

        function renderSeptemberSummary(eylulSalesLines) {
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && 
                person.name !== "Ali Altınay" && 
                !person.isInactive
            );
            const septemberTargets = {
                "Betül Köse": 450000,
                "Damla Kalemtaş": 850000,
                "Egehan Öncü": 850000,
                "Fahri Aktoz": 1250000,
                "Güven Gürkan Salıkoç": 650000,
                "Hüseyin Çakmak": 1250000,
                "Özge Kaçaroğlu": 450000,
                "Sebahat Çay": 1300000,
                "Tuğçe Bugakaptan": 850000,
                "Umut Karaerarslan": 850000,
                "Gizem Güler Ilısu": 450000
            };
            const totalTarget = visibleData.reduce((sum, person) => sum + (septemberTargets[person.name] || person.septemberTarget || person.augustTarget || person.target || 0), 0);
            const totalActual = visibleData.reduce((sum, person) => {
                const sums = eylulSalesLines[person.name] || { netTahsilat: 0, netEkstre: 0, posRapor: 0 };
                return sum + (sums.netTahsilat + sums.netEkstre + sums.posRapor);
            }, 0);
            const successRate = totalTarget > 0 ? (totalActual / totalTarget) * 100 : 0;
            const totalCount = visibleData.length;
            const el = document.getElementById('septemberSummaryStats');
            if (el) {
                el.innerHTML = '<div class="summary-stat"><h4>Toplam Hedef</h4><div class="value">₺' + totalTarget.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Gerçekleşen</h4><div class="value">₺' + totalActual.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Başarı Oranı</h4><div class="value">' + successRate.toFixed(0) + '%</div></div><div class="summary-stat"><h4>Satış Yöneticisi</h4><div class="value">' + totalCount + '</div></div>';
            }
        }

        function loadPipelineFromCSV() {
            console.log('=== LOAD PIPELINE FROM CSV STARTED ===');
            
            const fileInput = document.getElementById('pipelineCsvFile');
            console.log('FileInput found:', fileInput);
            
            if (!fileInput) {
                alert('CSV input elementi bulunamadı!');
                return;
            }
            
            const file = fileInput.files[0];
            console.log('Selected file:', file);
            
            if (!file) {
                alert('Lütfen bir CSV dosyası seçin!');
                return;
            }

            console.log('File name:', file.name);
            console.log('File size:', file.size);
            console.log('File type:', file.type);

            const reader = new FileReader();
            reader.onload = function(e) {
                console.log('=== READER ONLOAD STARTED ===');
                console.log('Event result length:', e.target.result.length);
                
                try {
                    const csv = e.target.result;
                    console.log('CSV content preview:', csv.substring(0, 500));
                    
                    const lines = csv.split('\n').filter(function(line) {
                        return line.trim();
                    });
                    
                    console.log('=== CSV YÜKLEME DEBUG ===');
                    console.log('CSV Lines:', lines.length);
                    
                    // İlk 3 satırı göster
                    for (let i = 0; i < Math.min(3, lines.length); i++) {
                        const values = lines[i].split(',').map(v => v.trim());
                        console.log(`Line ${i + 1}:`, values);
                    }
                    
                    const newPipelineData = [];
                    for (let i = 1; i < lines.length; i++) {
                        const values = lines[i].split(',').map(v => v.trim());
                        if (values.length >= 4 && values[0].trim()) {
                            
                            // Tam olarak sizin belirttiğiniz sütun sırasına göre parse et
                            const opportunity = {
                                customerName: values[0] || 'Belirtilmemiş', // [0] Firma Adı
                                contactPerson: values[1] || 'Belirtilmemiş', // [1] Satış Yöneticisi
                                salesRep: values[2] || 'Belirtilmemiş', // [2] Müşteri Temsilcisi ⭐
                                businessPartner: values[3] || 'Belirtilmemiş', // [3] İş Ortağı
                                amount: parseFloat(values[4]) || 0, // [4] Tutar
                                expectedClose: values[5] || 'Belirtilmemiş', // [5] Tahmini Kapanış Tarihi
                                creator: values[6] || 'Belirtilmemiş', // [6] Oluşturan Kişi
                                creatorTeam: values[7] || 'Belirtilmemiş', // [7] Oluşturan Kişi Takımı
                                registrationDate: values[8] || new Date().toLocaleDateString('tr-TR'), // [8] Oluşturulma Tarihi
                                productCode: values[9] || 'Belirtilmemiş', // [9] Ürün Grubu
                                erp: values[10] || 'Belirtilmemiş', // [10] Kullanılan ERP
                                opportunityType: values[11] || 'Belirtilmemiş', // [11] Satış Tipi
                                status: getStatusFromType(values[11] || ''),
                                statusText: getStatusTextFromType(values[11] || '')
                            };
                            
                            // Tutar kontrolü - hiçbir şartta rastgele değer atanmasın
                            if (opportunity.amount === 0 || isNaN(opportunity.amount)) {
                                opportunity.amount = 0; // Sıfır olarak bırak
                                console.log(`Tutar 0/NaN olduğu için 0 olarak bırakıldı`);
                            }
                            
                            console.log('Parsed opportunity:', {
                                customerName: opportunity.customerName,
                                salesRep: opportunity.salesRep,
                                amount: opportunity.amount,
                                productCode: opportunity.productCode,
                                opportunityType: opportunity.opportunityType
                            });
                            
                            newPipelineData.push(opportunity);
                        }
                    }
                    
                    if (newPipelineData.length > 0) {
                        pipelineData = newPipelineData;
                        
                        savePipelineData();
                        
                        // Dropdown'ları yeniden doldur (CSV yüklendiği için)
                        populatePipelineDropdowns();
                        
                        // Otomatik olarak pipeline ekranına geç ve kartları göster
                        showPipeline();
                        alert(newPipelineData.length + ' pipeline fırsatı başarıyla yüklendi!');
                    } else {
                        alert('CSV dosyasından pipeline verisi okunamadı!');
                    }
                } catch (error) {
                    console.error('CSV parsing error:', error);
                    alert('Pipeline CSV dosyası okurken hata oluştu: ' + error.message);
                }
            };
            
            reader.onerror = function(e) {
                console.error('FileReader error:', e);
                alert('Dosya okuma hatası: ' + e.target.error);
            };
            
            reader.readAsText(file);
        }

        function getStatusFromType(opportunityType) {
            const type = opportunityType.toLowerCase();
            if (type.includes('teklif') || type.includes('proposal')) return 'proposal';
            if (type.includes('müzakere') || type.includes('negotiation')) return 'negotiation';
            if (type.includes('nitelikli') || type.includes('qualified')) return 'qualified';
            if (type.includes('potansiyel') || type.includes('prospecting')) return 'prospecting';
            return 'qualified';
        }

        function getStatusTextFromType(opportunityType) {
            const type = opportunityType.toLowerCase();
            if (type.includes('teklif') || type.includes('proposal')) return 'Teklif';
            if (type.includes('müzakere') || type.includes('negotiation')) return 'Müzakere';
            if (type.includes('nitelikli') || type.includes('qualified')) return 'Nitelikli';
            if (type.includes('potansiyel') || type.includes('prospecting')) return 'Potansiyel';
            return 'Nitelikli';
        }


        
        function calculateNameSimilarity(name1, name2) {
            // Basit benzerlik hesaplama
            const words1 = name1.toLowerCase().split(' ');
            const words2 = name2.toLowerCase().split(' ');
            
            let commonWords = 0;
            words1.forEach(word1 => {
                words2.forEach(word2 => {
                    if (word1 === word2 || word1.includes(word2) || word2.includes(word1)) {
                        commonWords++;
                    }
                });
            });
            
            return commonWords / Math.max(words1.length, words2.length);
        }

        function clearPipelineData() {
            if (confirm('Tüm pipeline verilerini silmek istediğinizden emin misiniz?')) {
                pipelineData = [];
                localStorage.removeItem('pipelineData');
                console.log('Pipeline data cleared');
                
                if (document.getElementById('pipelineContainer').style.display === 'block') {
                    renderPipelineManagerCards();
                }
                
                alert('Pipeline verileri temizlendi!');
            }
        }

        function exportData() {
            const dataStr = JSON.stringify(salesData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'satis_verileri_' + new Date().toISOString().split('T')[0] + '.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }











                // Firebase konfigürasyonu
        const firebaseConfig = {
            apiKey: "AIzaSyBggLDAMat2LumAAMLGJ4RNG0oY_ApHw6E",
            authDomain: "sales-dashboard-586b7.firebaseapp.com",
            projectId: "sales-dashboard-586b7",
            storageBucket: "sales-dashboard-586b7.firebasestorage.app",
            messagingSenderId: "439765670916",
            appId: "1:439765670916:web:1df8841a6f91180eeb6951",
            measurementId: "G-SKZHKHMFNN"
        };
        
        // Firebase'i başlat
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        const analytics = firebase.analytics();
        
        // Authentication durumu
        let currentUser = null;
        let userId = null;
        
        // Auth state listener
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                userId = user.uid;
                checkAdmin(user);
                // Kullanıcı bilgilerini göster
                document.getElementById('userEmail').textContent = user.email;
                document.getElementById('userInfo').style.display = 'block';
                // Login modal'ını kapat
                document.getElementById('loginModal').style.display = 'none';
                loadUserData();
            } else {
                currentUser = null;
                userId = null;
                isAdmin = false;
                updateEditability();
                // Kullanıcı bilgilerini gizle
                document.getElementById('userInfo').style.display = 'none';
                // Giriş modalı açılmasın, dashboard/pipeline gizlenmesin
                // showLoginForm(); <-- Bunu tamamen kaldırıyoruz
                // Kullanıcı giriş yapmamışsa yerel verileri yükle
                loadData();
                loadPipelineData();
                loadStrategicOpportunitiesData();
                loadJulyCommitmentData();
                renderDashboard();
                updateLastUpdated();
                showDashboard();
            }
        });
        


        // Authentication fonksiyonları
        function showLoginForm() {
            // Diğer modalı kapat
            var modalOverlay = document.getElementById('modalOverlay');
            if (modalOverlay) modalOverlay.style.display = 'none';
            document.getElementById('loginModal').style.display = 'flex';
        }
        
        function closeLoginForm() {
            document.getElementById('loginModal').style.display = 'none';
        }
        
        function showRegisterForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
        }
        
        function loginUser() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('Lütfen email ve şifre girin!');
                return;
            }
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    document.getElementById('loginModal').style.display = 'none';
                    console.log('Giriş başarılı:', userCredential.user.email);
                })
                .catch((error) => {
                    alert('Giriş hatası: ' + error.message);
                });
        }
        
        function registerUser() {
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (!email || !password) {
                alert('Lütfen email ve şifre girin!');
                return;
            }
            
            if (password.length < 6) {
                alert('Şifre en az 6 karakter olmalıdır!');
                return;
            }
            
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    document.getElementById('loginModal').style.display = 'none';
                    console.log('Hesap oluşturuldu:', userCredential.user.email);
                })
                .catch((error) => {
                    alert('Hesap oluşturma hatası: ' + error.message);
                });
        }
        function loginWithGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .then((result) => {
                    document.getElementById('loginModal').style.display = 'none';
                    console.log('Google ile giriş başarılı:', result.user.email);
                })
                .catch((error) => {
                    alert('Google giriş hatası: ' + error.message);
                });
        }
        
        function logoutUser() {
            isAdmin = false;
            updateEditability();
            showNotification('Çıkış yapıldı. Artık sadece görüntüleyebilirsiniz.', 'info');
            // Admin panelini gizle
            var userInfo = document.getElementById('userInfo');
            if (userInfo) userInfo.style.display = 'none';
            let logoutBtn = document.getElementById('adminLogoutBtn');
            if (logoutBtn) logoutBtn.style.display = 'none';
        }
        
        function loadUserData() {
            if (!userId) return;
            
            // Firestore'dan kullanıcı verilerini yükle
            db.collection('users').doc(userId).get()
                .then((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        if (data.salesData) {
                            salesData = data.salesData;
                        }
                        if (data.pipelineData) {
                            pipelineData = data.pipelineData;
                        }
                        if (data.strategicOpportunitiesData) {
                            strategicOpportunitiesData = data.strategicOpportunitiesData;
                        }
                        if (data.julyCommitmentData) {
                            julyCommitmentData = data.julyCommitmentData;
                        }
                        console.log('Kullanıcı verileri yüklendi');
                        renderDashboard();
                        updateLastUpdated();
                        showDashboard(); // Ana dashboard'ı göster
                        if (document.getElementById('pipelineContainer').style.display === 'block') {
                            renderPipelineManagerCards();
                        }
                    } else {
                        console.log('Kullanıcı verisi bulunamadı, yeni hesap');
                        loadData(); // Yerel verileri yükle
                        loadPipelineData();
                        loadStrategicOpportunitiesData();
                        loadJulyCommitmentData();
                        renderDashboard();
                        updateLastUpdated();
                        showDashboard(); // Ana dashboard'ı göster
                    }
                })
                .catch((error) => {
                    console.error('Veri yükleme hatası:', error);
                    loadData(); // Hata durumunda yerel verileri yükle
                    loadPipelineData();
                    loadStrategicOpportunitiesData();
                    loadJulyCommitmentData();
                    renderDashboard();
                    updateLastUpdated();
                    showDashboard(); // Ana dashboard'ı göster
                });
        }
        
        function saveUserData() {
            if (!userId) return;
            
            const userData = {
                salesData: salesData,
                pipelineData: pipelineData,
                strategicOpportunitiesData: strategicOpportunitiesData,
                julyCommitmentData: julyCommitmentData,
                lastUpdate: new Date().toISOString(),
                email: currentUser.email
            };
            
            db.collection('users').doc(userId).set(userData)
                .then(() => {
                    console.log('Veriler buluta kaydedildi');
                })
                .catch((error) => {
                    console.error('Bulut kaydetme hatası:', error);
                });
        }
        
        function loadData() {
            const savedData = localStorage.getItem('salesDashboardData');
            if (savedData) {
                try {
                    salesData = JSON.parse(savedData);
                    console.log('Data loaded from localStorage:', salesData.length, 'records');
                } catch (error) {
                    console.error('Error loading data from localStorage:', error);
                }
            }
        }
        
        function saveData() {
            localStorage.setItem('salesDashboardData', JSON.stringify(salesData));
            localStorage.setItem('salesDashboardLastUpdate', new Date().toISOString());
            updateLastUpdated();
            
            // Buluta da kaydet
            if (currentUser) {
                saveUserData();
            }
        }

        function updateLastUpdated() {
            const lastUpdate = localStorage.getItem('salesDashboardLastUpdate');
            if (lastUpdate) {
                const date = new Date(lastUpdate);
                document.getElementById('lastUpdated').textContent = 'Son güncelleme: ' + date.toLocaleString('tr-TR');
            }
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
                closeMenu(); // Hamburger menüyü de kapat
            }
        });
        window.addEventListener('load', function() {
            // Pipeline verilerini başlat
            initializePipelineData();
            
            // Yerel verileri yükle (auth olmadan da çalışması için)
            loadData();
            loadPipelineData();
            

            
            console.log('LOADED - salesData length:', salesData.length);
            console.log('LOADED - SalesData names:', salesData.map(function(p) {
                return p.name;
            }));
            console.log('LOADED - pipelineData length:', pipelineData.length);
            
            // Dashboard'u HER ZAMAN render et ve göster
            renderDashboard();
            renderYearlyDashboard();
            updateLastUpdated();
            showDashboard();
            

        });

        // ADMIN EMAIL SABİTİ
        const ADMIN_EMAIL = 'umut.cakiroglu@finrota.com';
        let isAdmin = false;

        // Giriş modalı açıcı fonksiyon
        function requireAdminAuth(callback) {
            if (!isAdmin) {
                showLoginForm();
                window._pendingAdminCallback = callback;
                return false;
            }
            return true;
        }

        // Düzenleme butonlarını güncelle
        function updateEditability() {
            document.querySelectorAll('.edit-icon, .btn-edit, .btn-delete, .btn-save, .menu-btn-secondary, .file-input-menu').forEach(btn => {
                if (!isAdmin) {
                    btn.onclick = function(e) {
                        e.stopPropagation();
                        e.preventDefault();
                        requireAdminAuth();
                        return false;
                    };
                    btn.classList.add('disabled');
                    btn.style.opacity = 0.5;
                    btn.style.pointerEvents = 'auto';
                } else {
                    const orig = btn.getAttribute('data-orig-onclick');
                    if (orig) {
                        btn.setAttribute('onclick', orig);
                    }
                    btn.classList.remove('disabled');
                    btn.style.opacity = 1;
                }
            });
            // Sadece userInfo panelini kullan, başka çıkış butonu ekleme
            var userInfo = document.getElementById('userInfo');
            if (userInfo) userInfo.style.display = isAdmin ? 'block' : 'none';
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.edit-icon, .btn-edit, .btn-delete, .btn-save, .menu-btn-secondary, .file-input-menu').forEach(btn => {
                if (!btn.getAttribute('data-orig-onclick') && btn.getAttribute('onclick')) {
                    btn.setAttribute('data-orig-onclick', btn.getAttribute('onclick'));
                }
            });
            updateEditability();
        });



        function renderPipelineSummaryStats() {
          const toplamPipeline = pipelineData.reduce((sum, o) => sum + (o.amount || 0), 0);
          const toplamFirsat = pipelineData.length;
          const toplamHedef = salesData.reduce((sum, p) => sum + (p.target || 0), 0);
          const oran = toplamPipeline > 0 ? (toplamHedef / toplamPipeline) * 100 : 0;
          document.getElementById('pipelineSummaryStats').innerHTML = `
            <div class="summary-stat">
              <h4>Toplam Pipeline</h4>
              <div class="value">₺${toplamPipeline.toLocaleString('tr-TR', {maximumFractionDigits: 0})}</div>
            </div>
            <div class="summary-stat">
              <h4>Fırsat Adedi</h4>
              <div class="value">${toplamFirsat}</div>
            </div>
            <div class="summary-stat">
              <h4>Toplam Hedef / Pipeline Oranı</h4>
              <div class="value">${Math.round(oran)}%</div>
            </div>
          `;
        }

        // Pipeline kartları render edildikten sonra özet kutusunu da güncelle:
        if (typeof renderPipelineManagerCards === 'function') {
          const origRender = renderPipelineManagerCards;
          window.renderPipelineManagerCards = function() {
            origRender.apply(this, arguments);
            renderPipelineSummaryStats();
          }
        }

        // Ünvanı baş harfleri büyük göstermek için yardımcı fonksiyon ekle
        function capitalizeTitle(title) {
            return title.toLowerCase().split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        }

        function renderYearlyDashboard() {
            const grid = document.getElementById('yearlySpeedometerGrid');
            let html = '';
            
            // Sadece salesData'yı kullan
            const yearlyData = [...salesData];
            
            // Ali Altınay ve Umut Çakıroğlu'nu gizle (kartları görünmesin)
            // Muhammed Sivaslıgil yıllık dashboard'da görünsün
            const visibleData = yearlyData.filter(person => 
                person.name !== "Umut Çakıroğlu" && person.name !== "Ali Altınay"
            );
            
            // Kartları yıllık başarı oranına göre azalan sırala
            const sortedData = [...visibleData].sort((a, b) => {
                const aTarget = a.yearlyTarget || a.target;
                const bTarget = b.yearlyTarget || b.target;
                const aYearlyActual = a.monthlyData ? a.monthlyData.reduce((sum, val) => sum + val, 0) : a.actual;
                const bYearlyActual = b.monthlyData ? b.monthlyData.reduce((sum, val) => sum + val, 0) : b.actual;
                const aRate = aTarget > 0 ? (aYearlyActual / aTarget) * 100 : 0;
                const bRate = bTarget > 0 ? (bYearlyActual / bTarget) * 100 : 0;
                return bRate - aRate;
            });
            
            for (let i = 0; i < sortedData.length; i++) {
                html += createYearlySpeedometer(sortedData[i], i);
            }
            grid.innerHTML = html;
            
            // Drag & Drop fonksiyonlarını ekle
            initializeDragAndDrop('yearlySpeedometerGrid');
            
            // Summary'yi ayrı bir fonksiyon olarak çağır, veri güncellemesi yapmadan
            renderYearlySummaryOnly(sortedData);
        }
        
        function renderYearlySummaryOnly(sortedData) {
            // Hedefleri topla (yearlyTarget varsa onu kullan, yoksa target)
            const totalTarget = salesData.reduce(function(sum, person) {
                return sum + (person.yearlyTarget || person.target);
            }, 0);
            
            // Gerçekleşen toplamını hesapla (monthlyData toplamı)
            const totalActual = salesData.reduce(function(sum, person) {
                if (person.monthlyData && person.monthlyData.length >= 7) {
                    return sum + person.monthlyData.reduce((sum, val) => sum + val, 0);
                }
                return sum + (person.actual || 0);
            }, 0);
            
            const successRate = totalTarget > 0 ? (totalActual / totalTarget) * 100 : 0;
            const totalCount = salesData.length;
            
            document.getElementById('yearlySummaryStats').innerHTML = '<div class="summary-stat"><h4>Toplam Yıllık Hedef</h4><div class="value">₺' + totalTarget.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Yıllık Gerçekleşen</h4><div class="value">₺' + totalActual.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Yıllık Başarı Oranı</h4><div class="value">' + successRate.toFixed(0) + '%</div></div><div class="summary-stat"><h4>Satış Yöneticisi</h4><div class="value">' + totalCount + '</div></div>';
            
            // Satış kaynağı grafiklerini oluştur
            renderSalesSourceCharts(sortedData);
        }
        
        function renderYearlySummary() {
            // Yıllık dashboard için salesData'yı kullan
            const yearlyData = [...salesData];
            
            const totalTarget = yearlyData.reduce(function(sum, item) {
                return sum + (item.yearlyTarget || item.target);
            }, 0);
            
            // Yıllık toplam için monthlyData toplamını hesapla
            const totalActual = yearlyData.reduce(function(sum, item) {
                if (item.monthlyData && item.monthlyData.length >= 7) {
                    return sum + item.monthlyData.reduce((sum, val) => sum + val, 0);
                }
                return sum + item.actual;
            }, 0);
            
            const successRate = totalTarget > 0 ? (totalActual / totalTarget) * 100 : 0;
            // Tüm kişileri say (ayrılmış arkadaş dahil)
            const totalCount = yearlyData.length;
            
            // Debug log ekle
            console.log('Yıllık Dashboard - yearlyData length:', totalCount);
            console.log('Yıllık Dashboard - yearlyData names:', yearlyData.map(p => p.name));
            console.log('Yıllık Dashboard - totalActual:', totalActual);
            console.log('Yıllık Dashboard - yearlyData actuals:', yearlyData.map(p => ({name: p.name, actual: p.actual})));
            
            document.getElementById('yearlySummaryStats').innerHTML = '<div class="summary-stat"><h4>Toplam Yıllık Hedef</h4><div class="value">₺' + totalTarget.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Yıllık Gerçekleşen</h4><div class="value">₺' + totalActual.toLocaleString('tr-TR') + '</div></div><div class="summary-stat"><h4>Yıllık Başarı Oranı</h4><div class="value">' + successRate.toFixed(0) + '%</div></div><div class="summary-stat"><h4>Satış Yöneticisi</h4><div class="value">' + totalCount + '</div></div>';
        }
        
        function renderSalesSourceCharts(sortedData) {
            // Ana container'ı bul
            const mainContainer = document.querySelector('.sales-source-distribution-card .card-body');
            if (!mainContainer) {
                console.error('Ana container bulunamadı!');
                return;
            }
            
            // Satış kaynağı türleri - 5 kaynak
            const salesSourceTypes = [
                'Mevcut Müşteri',
                'Dış Talep', 
                'SDR',
                'İş Ortaklıkları',
                'Satış Ekibi'
            ];
            
            // Grid container oluştur
            let gridHTML = '<div class="sales-sources-grid">';
            
            // Her satış kaynağı için kart oluştur
            salesSourceTypes.forEach((sourceType, index) => {
                const sourceData = getSourceData(sourceType, sortedData);
                if (sourceData.length > 0) {
                    const cardHTML = createSourceCardHTML(sourceType, sourceData);
                    gridHTML += cardHTML;
                }
            });
            
            gridHTML += '</div>';
            
            // Ana container'a ekle
            mainContainer.innerHTML = gridHTML;
            
            // Toplam kontrolü ekle
            addTotalValidation(sortedData);
        }
        
        function addTotalValidation(sortedData) {
            // Yukarıdaki toplam hesaplama
            const yearlyTotal = sortedData.reduce((sum, person) => {
                if (person.monthlyData && person.monthlyData.length >= 7) {
                    return sum + person.monthlyData.reduce((sum, val) => sum + val, 0);
                }
                return sum + (person.actual || 0);
            }, 0);
            
            // Aşağıdaki satış kaynağı toplamları
            const sourceTotals = {};
            const salesSourceTypes = ['Mevcut Müşteri', 'Dış Talep', 'SDR', 'İş Ortaklıkları', 'Satış Ekibi'];
            
            salesSourceTypes.forEach(sourceType => {
                const sourceData = getSourceData(sourceType, sortedData);
                sourceTotals[sourceType] = sourceData.reduce((sum, person) => sum + person.amount, 0);
            });
            
            const totalFromSources = Object.values(sourceTotals).reduce((sum, val) => sum + val, 0);
            
            // Kontrol mesajı ekle
            const validationHTML = `
                <div style="margin-top: 20px; padding: 15px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                    <h4 style="margin: 0 0 10px 0; color: #1e293b;">📊 Toplam Kontrolü</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.9em;">
                        <div>
                            <strong>Yukarıdaki Toplam:</strong> ₺${(yearlyTotal/1000).toFixed(0)}K
                        </div>
                        <div>
                            <strong>Kaynak Toplamları:</strong> ₺${(totalFromSources/1000).toFixed(0)}K
                        </div>
                        <div>
                            <strong>Fark:</strong> ₺${((yearlyTotal - totalFromSources)/1000).toFixed(0)}K
                        </div>
                        <div>
                            <strong>Uyum:</strong> ${yearlyTotal === totalFromSources ? '✅ Tam Uyum' : '⚠️ Fark Var'}
                        </div>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.8em; color: #6b7280;">
                        <strong>Kaynak Detayları:</strong><br>
                        ${Object.entries(sourceTotals).map(([source, total]) => 
                            `${source}: ₺${(total/1000).toFixed(0)}K`
                        ).join(' | ')}
                    </div>
                </div>
            `;
            
            mainContainer.insertAdjacentHTML('beforeend', validationHTML);
        }
        
        // Satış Kaynağı Dağılım Açma/Kapama Fonksiyonu
        function toggleSalesSourceDistribution() {
            const card = document.getElementById('salesSourceDistributionCard');
            const cardBody = document.getElementById('salesSourceCardBody');
            const toggleIcon = document.getElementById('salesSourceToggleIcon');
            
            if (card.classList.contains('collapsed')) {
                // Aç
                card.classList.remove('collapsed');
                cardBody.style.display = 'block';
                toggleIcon.textContent = '▼';
                toggleIcon.classList.remove('collapsed');
            } else {
                // Kapat
                card.classList.add('collapsed');
                cardBody.style.display = 'none';
                toggleIcon.textContent = '▶';
                toggleIcon.classList.add('collapsed');
            }
        }
        
        function getSourceData(sourceType, sortedData) {
            let totalSourceAmount = 0;
            const sourceData = [];
            
            sortedData.forEach(person => {
                let personAmount = 0;
                const sourceKey = getSourceKey(sourceType);
                
                // Satış kaynağı dağılımı varsa kullan
                if (person.satisKaynagiDagilimi && person.satisKaynagiDagilimi[sourceKey]) {
                    personAmount = person.satisKaynagiDagilimi[sourceKey] || 0;
                } else {
                    // Eski yöntem - ana satış kaynağı kontrolü
                    if (person.satisKaynagi === sourceType) {
                        personAmount = person.monthlyData ? person.monthlyData.reduce((sum, val) => sum + val, 0) : person.actual;
                    }
                }
                
                if (personAmount > 0) {
                    sourceData.push({
                        name: person.name,
                        amount: personAmount
                    });
                    totalSourceAmount += personAmount;
                }
            });
            
            // Her kişiye toplam tutarı ekle
            sourceData.forEach(person => {
                person.total = totalSourceAmount;
            });
            
            return sourceData;
        }
        
        function createSourceCardHTML(sourceType, sourceData) {
            // Satış yöneticilerini paylarına göre sırala
            sourceData.sort((a, b) => b.amount - a.amount);
            
            // Satır satır HTML oluştur
            let rowsHTML = '';
            sourceData.forEach((person, index) => {
                const percentage = ((person.amount / person.total) * 100).toFixed(1);
                rowsHTML += `
                    <div class="sales-person-row">
                        <div class="sales-person-name">${person.name}</div>
                        <div class="sales-person-amount">₺${(person.amount/1000).toFixed(0)}K</div>
                        <div class="sales-person-percentage">${percentage}%</div>
                    </div>
                `;
            });
            
            const totalAmount = sourceData[0] ? sourceData[0].total : 0;
            
            return `
                <div class="sales-source-card">
                    <h3>${sourceType}</h3>
                    ${rowsHTML}
                    <div class="sales-source-total">
                        Toplam: ₺${(totalAmount/1000).toFixed(0)}K
                    </div>
                </div>
            `;
        }
        

        

        
        function getSourceKey(sourceType) {
            const keyMap = {
                'Mevcut Müşteri': 'mevcutMusteri',
                'Dış Talep': 'disTalep',
                'SDR': 'sdr',
                'İş Ortaklıkları': 'isOrtagi',
                'Satış Ekibi': 'satisEkibi'
            };
            return keyMap[sourceType];
        }
        

        
        function createYearlySpeedometer(personData, index) {
            // Yıllık speedometer için monthlyData toplamını hesapla
            const yearlyActual = personData.monthlyData ? personData.monthlyData.reduce((sum, val) => sum + val, 0) : personData.actual;
            
            const yearlyTarget = personData.yearlyTarget || personData.target;
            const percentage = yearlyTarget > 0 ? (yearlyActual / yearlyTarget) * 100 : 0;
            
            const angle = 180 - Math.min(percentage / 100, 1) * 180;
            const needleRad = (angle * Math.PI) / 180;
            const needleLength = 80;
            const needleX = needleLength * Math.cos(needleRad);
            const needleY = -needleLength * Math.sin(needleRad);
            
            let badgeClass = "badge-excellent";
            let badgeText = "Mükemmel";
            
            if (percentage < 50) {
                badgeClass = "badge-needs-improvement";
                badgeText = "Hedef Altında";
            } else if (percentage < 80) {
                badgeClass = "badge-good";
                badgeText = "İyi";
            }
            
            const cleanName = personData.name.replace(/\s+/g, '').replace(/[^a-zA-Z0-9]/g, '');
            
            // Yıllık dashboard'da pasif mod uygulansın
            const isInactive = personData.isInactive;
            const inactiveStyle = isInactive ? 'opacity: 0.6; filter: grayscale(50%);' : '';
            const inactiveClass = isInactive ? 'inactive-card' : '';
            
            const svg = '<svg class="speedometer-svg" viewBox="0 0 280 180"><defs><linearGradient id="yearly-gradient-' + cleanName + '" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#dc3545;stop-opacity:1" /><stop offset="50%" style="stop-color:#ffc107;stop-opacity:1" /><stop offset="100%" style="stop-color:#28a745;stop-opacity:1" /></linearGradient></defs><path d="M 40 140 A 100 100 0 0 1 240 140" fill="none" stroke="#e9ecef" stroke-width="20" stroke-linecap="round"/><path d="M 40 140 A 100 100 0 0 1 240 140" fill="none" stroke="url(#yearly-gradient-' + cleanName + ')" stroke-width="20" stroke-linecap="round" stroke-dasharray="' + (percentage > 0 ? (percentage / 100 * 314) : 0) + ' 314"/><g transform="translate(140, 140)"><line x1="0" y1="0" x2="' + needleX + '" y2="' + needleY + '" stroke="#333" stroke-width="3" stroke-linecap="round"/><circle cx="0" cy="0" r="8" fill="#333"/><circle cx="0" cy="0" r="4" fill="white"/></g><text x="140" y="120" text-anchor="middle" font-size="24" font-weight="bold" fill="#333">' + percentage.toFixed(0) + '%</text><g transform="translate(140, 140)"><text x="-75" y="55" text-anchor="middle" font-size="12" fill="#666">0%</text><text x="0" y="-95" text-anchor="middle" font-size="12" fill="#666">50%</text><text x="75" y="55" text-anchor="middle" font-size="12" fill="#666">100%</text><line x1="-70" y1="70" x2="-60" y2="60" stroke="#999" stroke-width="2"/><line x1="70" y1="70" x2="60" y2="60" stroke="#999" stroke-width="2"/></g></svg>';
            
            return '<div class="speedometer-card ' + inactiveClass + '" style="' + inactiveStyle + '" data-index="' + index + '" onclick="showPersonDetail(' + JSON.stringify(personData).replace(/"/g, '&quot;') + ')">' +
                '<div class="achievement-badge ' + badgeClass + '">' + (isInactive ? 'Ayrıldı' : badgeText) + '</div>' +
                '<div class="card-header">' +
                    '<h3 style="margin-bottom: 2px;">' + personData.name + '</h3>' +
                    (personData.title ? '<div class="person-title">' + capitalizeTitle(personData.title) + '</div>' : '') +
                '</div>' +
                '<div class="speedometer-container">' + svg + '</div>' +
                '<div class="stats-container" id="stats-' + index + '">' +
                    '<div class="stat-item"><div class="stat-label">Yıllık Hedef</div><div class="stat-value" id="target-' + index + '">₺' + yearlyTarget.toLocaleString('tr-TR') + '</div></div>' +
                    '<div class="stat-item"><div class="stat-label">Yıllık Gerçekleşen</div><div class="stat-value" id="actual-' + index + '">₺' + yearlyActual.toLocaleString('tr-TR') + '</div></div>' +
                    '<div class="stat-item"><div class="stat-label">Başarı</div><div class="stat-value">' + percentage.toFixed(0) + '%</div></div>' +
                '</div>' +
            '</div>';
        }
        
        // Temmuz Commitment Functions
        function renderJulyCommitment() {
            const grid = document.getElementById('julyCommitmentGrid');
            let html = '';
            
            // Fırsatları tutara göre azalan sırala
            const sortedOpportunities = [...julyCommitmentData].sort((a, b) => b.amount - a.amount);
            
            for (let i = 0; i < sortedOpportunities.length; i++) {
                html += createOpportunityCard(sortedOpportunities[i], i);
            }
            
            grid.innerHTML = html;
            renderJulyCommitmentSummary();
        }
        
        function createOpportunityCard(opportunity, index) {
            const productGroups = opportunity.productGroup.split('+');
            const productBadges = productGroups.map(group => 
                `<span class="product-badge">${group.trim()}</span>`
            ).join('');
            
            const ownerInitials = opportunity.owner.split(' ').map(name => name.charAt(0)).join('').toUpperCase();
            
            return `
                <div class="opportunity-card">
                    <div class="opportunity-header">
                        <h3 class="opportunity-title" onclick="showOpportunityDetail(${index})" style="cursor: pointer;">${opportunity.companyName}</h3>
                        <div class="opportunity-amount">₺${opportunity.amount.toLocaleString('tr-TR')}</div>
                    </div>
                    
                    <div class="opportunity-details">
                        <div class="opportunity-detail">
                            <div class="opportunity-detail-label">Sıra</div>
                            <div class="opportunity-detail-value">#${opportunity.id}</div>
                        </div>
                        <div class="opportunity-detail">
                            <div class="opportunity-detail-label">Ürün Grubu</div>
                            <div class="opportunity-detail-value">${productBadges}</div>
                        </div>
                    </div>
                    
                    <div class="opportunity-owner">
                        <div class="opportunity-owner-icon">${ownerInitials}</div>
                        <div class="opportunity-owner-info">
                            <div class="opportunity-owner-name">${opportunity.owner}</div>
                            <div class="opportunity-owner-title">Fırsat Sahibi</div>
                        </div>
                    </div>
                    
                    <div class="opportunity-actions">
                        <button class="edit-btn" onclick="editOpportunityAmount(${index})" title="Tutarı Düzenle">
                            ✏️ Düzenle
                        </button>
                        <button class="remove-btn" onclick="removeFromJulyCommitment(${index})" title="Fırsatı Kaldır" style="background: linear-gradient(135deg, #dc2626, #b91c1c); color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 0.9em; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(220, 38, 38, 0.2);">
                            🗑️ Kaldır
                        </button>
                    </div>
                </div>
            `;
        }
        
        function renderJulyCommitmentSummary() {
            const totalAmount = julyCommitmentData.reduce((sum, opp) => sum + opp.amount, 0);
            const totalOpportunities = julyCommitmentData.length;
            const uniqueOwners = [...new Set(julyCommitmentData.map(opp => opp.owner))].length;
            const averageAmount = totalAmount / totalOpportunities;
            
            document.getElementById('julyCommitmentSummaryStats').innerHTML = `
                <div class="summary-stat">
                    <h4>Toplam Commitment</h4>
                    <div class="value">₺${totalAmount.toLocaleString('tr-TR')}</div>
                </div>
                <div class="summary-stat">
                    <h4>Fırsat Adedi</h4>
                    <div class="value">${totalOpportunities}</div>
                </div>
                <div class="summary-stat">
                    <h4>Fırsat Sahibi</h4>
                    <div class="value">${uniqueOwners}</div>
                </div>
                <div class="summary-stat">
                    <h4>Ortalama Tutar</h4>
                    <div class="value">₺${averageAmount.toLocaleString('tr-TR', {maximumFractionDigits: 0})}</div>
                </div>
            `;
        }
        
        // Stratejik Fırsatlar Functions
        function renderStrategicOpportunities() {
            const grid = document.getElementById('strategicOpportunitiesGrid');
            let html = '';
            
            // Fırsatları tutara göre azalan sırala
            const sortedOpportunities = [...strategicOpportunitiesData].sort((a, b) => b.price - a.price);
            
            for (let i = 0; i < sortedOpportunities.length; i++) {
                html += createStrategicOpportunityCard(sortedOpportunities[i], i);
            }
            
            grid.innerHTML = html;
            updateStrategicOpportunitiesCount();
            populateOwnerFilter();
            renderStrategicOpportunitiesSummary();
        }
        
        function createStrategicOpportunityCard(opportunity, index) {
            const productTags = opportunity.products.map(product => 
                `<span class="product-tag">${product}</span>`
            ).join('');
            
            const ownerInitials = opportunity.owner.split(' ').map(name => name.charAt(0)).join('').toUpperCase();
            
            const statusClass = getStatusClass(opportunity.status);
            
            return `
                <div class="strategic-opportunity-card">
                    <div class="strategic-opportunity-header">
                        <h3 class="strategic-opportunity-title">${opportunity.companyName}</h3>
                        <div class="strategic-opportunity-price">₺${opportunity.price.toLocaleString('tr-TR')}</div>
                    </div>
                    
                    <div class="strategic-opportunity-owner">
                        <div class="strategic-opportunity-owner-icon">${ownerInitials}</div>
                        <div class="strategic-opportunity-owner-info">
                            <div class="strategic-opportunity-owner-name">${opportunity.owner}</div>
                            <div class="strategic-opportunity-owner-title">Fırsat Sahibi</div>
                        </div>
                    </div>
                    
                    <div class="strategic-opportunity-products">
                        ${productTags}
                    </div>
                    
                    <div class="strategic-opportunity-details">
                        <div class="strategic-opportunity-detail">
                            <div class="strategic-opportunity-detail-label">Güncel Durum</div>
                            <div class="strategic-opportunity-detail-value">
                                <input type="text" class="status-input" value="${opportunity.status}" onchange="updateStrategicOpportunityStatus(${index}, this.value)" onblur="updateStrategicOpportunityStatus(${index}, this.value)" placeholder="Durum girin..." style="padding: 6px 10px; border-radius: 6px; border: 1px solid #d1d5db; font-size: 0.9em; background: white; width: 100%; transition: all 0.3s ease; box-sizing: border-box;">
                            </div>
                        </div>
                        <div class="strategic-opportunity-detail">
                            <div class="strategic-opportunity-detail-label">Tahmini Kapanış</div>
                            <div class="strategic-opportunity-detail-value">${opportunity.closingDate}</div>
                        </div>
                    </div>
                    
                    <div class="strategic-opportunity-actions" style="display: flex; gap: 10px; justify-content: center; margin-top: 20px; padding-top: 15px; border-top: 1px solid #e2e8f0;">
                        <button class="edit-strategic-btn" onclick="editStrategicOpportunity(${index})" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 0.9em; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(59, 130, 246, 0.2);">
                            ✏️ Düzenle
                        </button>
                        <button class="remove-strategic-btn" onclick="removeFromStrategicOpportunities(${index})" style="background: linear-gradient(135deg, #dc2626, #b91c1c); color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 0.9em; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(220, 38, 38, 0.2);">
                            🗑️ Kaldır
                        </button>
                    </div>
                </div>
            `;
        }
        
        function getStatusClass(status) {
            switch(status) {
                case 'Değerlendirme Aşaması': return 'status-evaluation';
                case 'Teklif Hazırlama': return 'status-proposal';
                case 'Müzakere': return 'status-negotiation';
                case 'Kapanış': return 'status-closing';
                default: return 'status-evaluation';
            }
        }
        
        function showStrategicOpportunityDetail(index) {
            const opportunity = strategicOpportunitiesData[index];
            const productTags = opportunity.products.map(product => 
                `<span class="product-tag">${product}</span>`
            ).join('');
            
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            modalTitle.textContent = opportunity.companyName;
            modalBody.innerHTML = `
                <div class="pipeline-detail-grid">
                    <div class="pipeline-detail-card">
                        <div class="pipeline-detail-card-header">
                            <h4>📊 Stratejik Fırsat Detayları</h4>
                        </div>
                        <div class="pipeline-detail-card-content">
                            <div class="pipeline-detail-row">
                                <span class="detail-label">Firma Adı:</span>
                                <span class="detail-value">${opportunity.companyName}</span>
                            </div>
                            <div class="pipeline-detail-row">
                                <span class="detail-label">Tutar:</span>
                                <span class="detail-value amount">₺${opportunity.amount.toLocaleString('tr-TR')}</span>
                            </div>
                            <div class="pipeline-detail-row">
                                <span class="detail-label">Ürün Grubu:</span>
                                <span class="detail-value">${productBadges}</span>
                            </div>
                            <div class="pipeline-detail-row">
                                <span class="detail-label">Fırsat Sahibi:</span>
                                <span class="detail-value">${opportunity.owner}</span>
                            </div>
                            <div class="pipeline-detail-row">
                                <span class="detail-label">Sıra:</span>
                                <span class="detail-value">#${opportunity.id}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modalOverlay').style.display = 'block';
        }
        function editOpportunityAmount(index) {
            const opportunity = julyCommitmentData[index];
            
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            modalTitle.textContent = `Tutar Düzenle - ${opportunity.companyName}`;
            modalBody.innerHTML = `
                <div class="edit-amount-form">
                    <div class="edit-amount-input">
                        <label for="newAmount">Yeni Tutar (₺):</label>
                        <input type="number" id="newAmount" value="${opportunity.amount}" min="0" step="1000">
                    </div>
                    
                    <div style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <div style="font-weight: 600; color: #92400e; margin-bottom: 8px;">⚠️ Dikkat</div>
                        <div style="font-size: 0.9em; color: #92400e;">
                            Bu işlem geri alınamaz. Tutarı değiştirdikten sonra fırsatlar yeniden sıralanacak ve özet istatistikler güncellenecektir.
                        </div>
                    </div>
                    
                    <div class="edit-amount-buttons">
                        <button class="edit-amount-btn edit-amount-btn-secondary" onclick="closeModal()">
                            ❌ İptal
                        </button>
                        <button class="edit-amount-btn edit-amount-btn-primary" onclick="saveOpportunityAmount(${index})">
                            ✅ Kaydet
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('modalOverlay').style.display = 'block';
            
            // Input'a focus ol
            setTimeout(() => {
                document.getElementById('newAmount').focus();
            }, 100);
        }
        
        function saveOpportunityAmount(index) {
            const newAmount = parseFloat(document.getElementById('newAmount').value);
            
            if (isNaN(newAmount) || newAmount < 0) {
                alert('Lütfen geçerli bir tutar girin!');
                return;
            }
            
            // Tutarı güncelle
            julyCommitmentData[index].amount = newAmount;
            
            // Verileri localStorage'a kaydet
            saveJulyCommitmentData();
            
            // Sayfayı yeniden render et
            renderJulyCommitment();
            
            // Özet tabloyu güncelle
            renderJulyCommitmentSummary();
            
            // Modal'ı kapat
            closeModal();
            
            // Başarı mesajı göster
            showSuccessMessage(`"${julyCommitmentData[index].companyName}" fırsatının tutarı başarıyla güncellendi!`);
        }
        
        function removeFromJulyCommitment(index) {
            const opportunity = julyCommitmentData[index];
            
            if (confirm(`"${opportunity.companyName}" fırsatını Temmuz Commitment listesinden kaldırmak istediğinizden emin misiniz?`)) {
                // Fırsatı listeden kaldır
                julyCommitmentData.splice(index, 1);
                
                // ID'leri yeniden numaralandır
                julyCommitmentData.forEach((opp, idx) => {
                    opp.id = idx + 1;
                });
                
                // Verileri localStorage'a kaydet
                saveJulyCommitmentData();
                
                // Sayfayı yeniden render et
                renderJulyCommitment();
                
                // Özet tabloyu güncelle
                renderJulyCommitmentSummary();
                
                // Başarı mesajı göster
                showSuccessMessage(`"${opportunity.companyName}" fırsatı Temmuz Commitment listesinden kaldırıldı!`);
            }
        }
        
        function showSuccessMessage(message) {
            // Başarı mesajı için geçici bir div oluştur
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #10b981;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                z-index: 10000;
                font-weight: 500;
                max-width: 300px;
                animation: slideIn 0.3s ease;
            `;
            successDiv.textContent = message;
            
            // CSS animasyonu ekle
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(successDiv);
            
            // 3 saniye sonra kaldır
            setTimeout(() => {
                successDiv.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(successDiv);
                }, 300);
            }, 3000);
        }
        
        // Filter Functions
                        // Temmuz Dashboard Filtreleri
        function applyMonthlyFilters() {
            const nameFilter = document.getElementById('monthlyNameFilter').value.toLowerCase();
            const successFilter = document.getElementById('monthlySuccessFilter').value;
            const minAmount = parseFloat(document.getElementById('monthlyMinAmount').value) || 0;
            const maxAmount = parseFloat(document.getElementById('monthlyMaxAmount').value) || Infinity;
            
            const filteredData = salesData.filter(person => {
                // İsim filtresi
                if (nameFilter && !person.name.toLowerCase().includes(nameFilter)) {
                    return false;
                }
                
                // Tutar filtresi
                if (person.actual < minAmount || person.actual > maxAmount) {
                    return false;
                }
                
                // Başarı oranı filtresi
                const successRate = person.target > 0 ? (person.actual / person.target) * 100 : 0;
                if (successFilter) {
                    if (successFilter === 'excellent' && successRate < 80) return false;
                    if (successFilter === 'good' && (successRate < 50 || successRate >= 80)) return false;
                    if (successFilter === 'needs-improvement' && successRate >= 50) return false;
                }
                
                return true;
            });
            
            // Filtrelenmiş verileri render et
            renderFilteredMonthlyDashboard(filteredData);
            
            // Sonuç sayısını güncelle
            document.getElementById('monthlyFilterCount').textContent = filteredData.length;
        }
        
        function renderFilteredMonthlyDashboard(filteredData) {
            const grid = document.getElementById('speedometerGrid');
            let html = '';
            
            // Kartları başarı oranına göre azalan sırala (gerçekleşen/hedef oranı)
            const sortedData = [...filteredData].sort((a, b) => {
                const aRate = a.target > 0 ? (a.actual / a.target) * 100 : 0;
                const bRate = b.target > 0 ? (b.actual / b.target) * 100 : 0;
                return bRate - aRate;
            });
            
            for (let i = 0; i < sortedData.length; i++) {
                html += createSpeedometer(sortedData[i], salesData.indexOf(sortedData[i]));
            }
            
            grid.innerHTML = html;
        }
        
        function clearMonthlyFilters() {
            document.getElementById('monthlyNameFilter').value = '';
            document.getElementById('monthlySuccessFilter').value = '';
            document.getElementById('monthlyMinAmount').value = '';
            document.getElementById('monthlyMaxAmount').value = '';
            
            // Orijinal dashboard'u render et
            renderDashboard();
            document.getElementById('monthlyFilterCount').textContent = salesData.length;
        }
        
        // Ağustos Dashboard Filtreleri
        function applyAugustFilters() {
            const nameFilter = document.getElementById('augustNameFilter').value.toLowerCase();
            const successFilter = document.getElementById('augustSuccessFilter').value;
            const minAmount = parseFloat(document.getElementById('augustMinAmount').value) || 0;
            const maxAmount = parseFloat(document.getElementById('augustMaxAmount').value) || Infinity;
            
            const filteredData = salesData.filter(person => {
                // İsim filtresi
                if (nameFilter && !person.name.toLowerCase().includes(nameFilter)) {
                    return false;
                }
                
                // Ağustos için sıfır değerler
                const augustActual = 0;
                const augustTarget = 0;
                
                // Tutar filtresi (Ağustos için sıfır)
                if (augustActual < minAmount || augustActual > maxAmount) {
                    return false;
                }
                
                // Başarı oranı filtresi (Ağustos için sıfır)
                const successRate = 0;
                if (successFilter) {
                    if (successFilter === 'excellent' && successRate < 80) return false;
                    if (successFilter === 'good' && (successRate < 50 || successRate >= 80)) return false;
                    if (successFilter === 'needs-improvement' && successRate >= 50) return false;
                }
                
                return true;
            });
            
            // Filtrelenmiş verileri render et
            renderFilteredAugustDashboard(filteredData);
            
            // Sonuç sayısını güncelle
            document.getElementById('augustFilterCount').textContent = filteredData.length;
        }
        
        function renderFilteredAugustDashboard(filteredData) {
            const grid = document.getElementById('augustSpeedometerGrid');
            let html = '';
            
            // Ağustos için sıfır değerlerle kartları oluştur
            const augustData = filteredData.map(person => ({
                ...person,
                actual: 0, // Ağustos verileri henüz girilmemiş
                target: 0, // Ağustos hedefleri henüz belirlenmemiş
                productSales: {
                    netTahsilat: 0,
                    netEkstre: 0,
                    posRapor: 0,
                    tos: 0,
                    onlineDBS: 0,
                    nap: 0,
                    unidox: 0
                },
                performanceKPIs: {
                    targetRealizationRate: 0,
                    discountRate: 0,
                    newCustomerSales: 0,
                    newCustomerContacts: 0,
                    groupCompanyReferrals: 0
                }
            }));
            
            // Kartları alfabetik sırala
            const sortedData = [...augustData].sort((a, b) => a.name.localeCompare(b.name, 'tr'));
            
            for (let i = 0; i < sortedData.length; i++) {
                html += createSpeedometer(sortedData[i], null);
            }
            
            grid.innerHTML = html;
        }
        
        function clearAugustFilters() {
            document.getElementById('augustNameFilter').value = '';
            document.getElementById('augustSuccessFilter').value = '';
            document.getElementById('augustMinAmount').value = '';
            document.getElementById('augustMaxAmount').value = '';
            
            // Orijinal Ağustos dashboard'u render et
            renderAugustDashboard();
            document.getElementById('augustFilterCount').textContent = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && 
                person.name !== "Ali Altınay" && 
                !person.isInactive
            ).length;
        }
        
        // Pipeline dropdown'larını doldur
        function populatePipelineDropdowns() {
            if (!pipelineData || pipelineData.length === 0) return;
            
            // Benzersiz değerleri topla
            const salesReps = [...new Set(pipelineData.map(item => item.salesRep).filter(Boolean))];
            const businessPartners = [...new Set(pipelineData.map(item => item.businessPartner).filter(Boolean))];
            const creators = [...new Set(pipelineData.map(item => item.creator).filter(Boolean))];
            const creatorTeams = [...new Set(pipelineData.map(item => item.creatorTeam).filter(Boolean))];
            const productCodes = [...new Set(pipelineData.map(item => item.productCode).filter(Boolean))];
            const erps = [...new Set(pipelineData.map(item => item.erp).filter(Boolean))];
            const opportunityTypes = [...new Set(pipelineData.map(item => item.opportunityType).filter(Boolean))];
            
            // Dropdown'ları doldur
            populateDropdown('pipelineSalesRepFilter', salesReps);
            populateDropdown('pipelineBusinessPartnerFilter', businessPartners);
            populateDropdown('pipelineCreatorFilter', creators);
            populateDropdown('pipelineCreatorTeamFilter', creatorTeams);
            populateDropdown('pipelineProductCodeFilter', productCodes);
            populateDropdown('pipelineErpFilter', erps);
            populateDropdown('pipelineOpportunityTypeFilter', opportunityTypes);
        }
        
        // Dropdown doldurma yardımcı fonksiyonu
        function populateDropdown(elementId, values) {
            const select = document.getElementById(elementId);
            if (!select) return;
            

            
            // Mevcut seçenekleri tamamen temizle
            select.innerHTML = '<option value="">Tümü</option>';
            
            // Yeni seçenekleri ekle (duplicate kontrolü ile)
            const uniqueValues = [...new Set(values)].sort();
            uniqueValues.forEach(value => {
                const option = document.createElement('option');
                option.value = value;
                option.textContent = value;
                select.appendChild(option);
            });
            

        }

        // Pipeline Filtreleri
        function applyPipelineFilters() {
            const customerNameFilter = document.getElementById('pipelineCustomerNameFilter').value.toLowerCase();
            const ownerFilter = document.getElementById('pipelineOwnerFilter').value;
            const salesRepFilter = document.getElementById('pipelineSalesRepFilter').value;
            const businessPartnerFilter = document.getElementById('pipelineBusinessPartnerFilter').value;
            const amountFilter = parseFloat(document.getElementById('pipelineAmountFilter').value) || 0;
            const expectedCloseFilter = document.getElementById('pipelineExpectedCloseFilter').value.toLowerCase();
            const creatorFilter = document.getElementById('pipelineCreatorFilter').value;
            const creatorTeamFilter = document.getElementById('pipelineCreatorTeamFilter').value;
            const registrationDateFilter = document.getElementById('pipelineRegistrationDateFilter').value.toLowerCase();
            const productCodeFilter = document.getElementById('pipelineProductCodeFilter').value;
            const erpFilter = document.getElementById('pipelineErpFilter').value;
            const opportunityTypeFilter = document.getElementById('pipelineOpportunityTypeFilter').value;
            const sizeFilter = document.getElementById('pipelineSizeFilter').value;
            const minAmount = parseFloat(document.getElementById('pipelineMinAmount').value) || 0;
            const maxAmount = parseFloat(document.getElementById('pipelineMaxAmount').value) || Infinity;
            

            
            // Önce pipeline verilerini filtrele
            const filteredPipelineData = pipelineData.filter(opportunity => {
                // Firma adı filtresi
                if (customerNameFilter && !opportunity.customerName.toLowerCase().includes(customerNameFilter)) {
                    return false;
                }
                
                // Satış yöneticisi filtresi
                if (ownerFilter && opportunity.contactPerson !== ownerFilter) {
                    return false;
                }
                
                // Müşteri temsilcisi filtresi
                if (salesRepFilter && opportunity.salesRep !== salesRepFilter) {
                    return false;
                }
                
                // İş ortağı filtresi
                if (businessPartnerFilter && opportunity.businessPartner !== businessPartnerFilter) {
                    return false;
                }
                
                // Tutar filtresi
                if (amountFilter > 0 && opportunity.amount !== amountFilter) {
                    return false;
                }
                
                // Tahmini kapanış tarihi filtresi
                if (expectedCloseFilter && !opportunity.expectedClose.toLowerCase().includes(expectedCloseFilter)) {
                    return false;
                }
                
                // Oluşturan kişi filtresi
                if (creatorFilter && opportunity.creator !== creatorFilter) {
                    return false;
                }
                
                // Oluşturan kişi takımı filtresi
                if (creatorTeamFilter && opportunity.creatorTeam !== creatorTeamFilter) {
                    return false;
                }
                
                // Oluşturulma tarihi filtresi
                if (registrationDateFilter && !opportunity.registrationDate.toLowerCase().includes(registrationDateFilter)) {
                    return false;
                }
                
                // Ürün grubu filtresi
                if (productCodeFilter && opportunity.productCode !== productCodeFilter) {
                    return false;
                }
                
                // ERP filtresi
                if (erpFilter && opportunity.erp !== erpFilter) {
                    return false;
                }
                
                // Satış tipi filtresi
                if (opportunityTypeFilter && opportunity.opportunityType !== opportunityTypeFilter) {
                    return false;
                }
                
                return true;
            });
            
            // Filtrelenmiş pipeline verilerine göre satış yöneticilerini filtrele
            const filteredData = salesData.filter(person => {
                // Satış yöneticisi filtresi
                if (ownerFilter && person.name !== ownerFilter) {
                    return false;
                }
                
                // Pipeline büyüklüğü hesapla (filtrelenmiş verilerle)
                const personOpportunities = filteredPipelineData.filter(opportunity => opportunity.contactPerson === person.name);
                const personPipelineValue = personOpportunities.reduce((sum, opportunity) => sum + opportunity.amount, 0);
                
                // Pipeline büyüklüğü filtresi
                if (personPipelineValue < minAmount || personPipelineValue > maxAmount) {
                    return false;
                }
                
                // Pipeline büyüklüğü kategorisi filtresi
                if (sizeFilter) {
                    if (sizeFilter === 'high' && personPipelineValue < 1000000) return false;
                    if (sizeFilter === 'medium' && (personPipelineValue < 500000 || personPipelineValue >= 1000000)) return false;
                    if (sizeFilter === 'low' && personPipelineValue >= 500000) return false;
                }
                
                return true;
            });
            
            // Filtrelenmiş verileri render et
            renderFilteredPipelineDashboard(filteredData, filteredPipelineData);
            
            // Sonuç sayısını güncelle
            document.getElementById('pipelineFilterCount').textContent = filteredData.length;
        }
        function renderFilteredPipelineDashboard(filteredData, filteredPipelineData = null) {
            const teamGrid = document.getElementById('teamGrid');
            teamGrid.innerHTML = '';
            
            // Her satış yöneticisi için pipeline büyüklüğünü hesapla ve sıralama için dizi oluştur
            const pipelineStats = filteredData.map(person => {
                const personOpportunities = filteredPipelineData ? 
                    filteredPipelineData.filter(opportunity => opportunity.contactPerson === person.name) :
                    pipelineData.filter(opportunity => opportunity.contactPerson === person.name);
                const personPipelineValue = personOpportunities.reduce((sum, opportunity) => sum + opportunity.amount, 0);
                return { person, personPipelineValue, personOpportunities };
            });
            
            // Pipeline büyüklüğüne göre azalan sırala
            pipelineStats.sort((a, b) => b.personPipelineValue - a.personPipelineValue);
            
            pipelineStats.forEach(({ person, personPipelineValue, personOpportunities }) => {
                const personOpportunityCount = personOpportunities.length;
                const personTargetToPipelineRatio = personPipelineValue > 0 ? (person.target / personPipelineValue * 100) : 0;
                
                // Performans badge'i belirle
                let performanceClass = 'performance-poor';
                let performanceText = 'Düşük';
                
                if (personTargetToPipelineRatio >= 200) {
                    performanceClass = 'performance-excellent';
                    performanceText = 'Mükemmel';
                } else if (personTargetToPipelineRatio >= 150) {
                    performanceClass = 'performance-good';
                    performanceText = 'İyi';
                } else if (personTargetToPipelineRatio >= 100) {
                    performanceClass = 'performance-average';
                    performanceText = 'Orta';
                }
                
                const card = document.createElement('div');
                card.className = 'team-card';
                card.onclick = () => showPipelineMemberDetail(person, personOpportunities);
                
                card.innerHTML = `
                    <div class="team-card-header">
                        <h3 class="team-member-name">${person.name}</h3>
                    </div>
                    
                    <div class="team-stats">
                        <div class="team-stat-item">
                            <div class="team-stat-label">Pipeline Büyüklüğü</div>
                            <div class="team-stat-value">₺${personPipelineValue.toLocaleString('tr-TR')}</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Hedef/Pipeline Oranı</div>
                            <div class="team-stat-value">${personTargetToPipelineRatio.toFixed(1)}%</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Fırsat Adedi</div>
                            <div class="team-stat-value">${personOpportunityCount}</div>
                        </div>
                        <div class="team-stat-item">
                            <div class="team-stat-label">Hedef</div>
                            <div class="team-stat-value">₺${person.target.toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                    
                    <div class="performance-badge ${performanceClass}">${performanceText}</div>
                `;
                
                teamGrid.appendChild(card);
            });
        }
        
        function clearPipelineFilters() {
            document.getElementById('pipelineCustomerNameFilter').value = '';
            document.getElementById('pipelineOwnerFilter').value = '';
            document.getElementById('pipelineSalesRepFilter').value = '';
            document.getElementById('pipelineBusinessPartnerFilter').value = '';
            document.getElementById('pipelineAmountFilter').value = '';
            document.getElementById('pipelineExpectedCloseFilter').value = '';
            document.getElementById('pipelineCreatorFilter').value = '';
            document.getElementById('pipelineCreatorTeamFilter').value = '';
            document.getElementById('pipelineRegistrationDateFilter').value = '';
            document.getElementById('pipelineProductCodeFilter').value = '';
            document.getElementById('pipelineErpFilter').value = '';
            document.getElementById('pipelineOpportunityTypeFilter').value = '';
            document.getElementById('pipelineSizeFilter').value = '';
            document.getElementById('pipelineMinAmount').value = '';
            document.getElementById('pipelineMaxAmount').value = '';
            
            // Orijinal pipeline'ı render et
            renderPipelineManagerCards();
            document.getElementById('pipelineFilterCount').textContent = salesData.length;
        }
        
        // Temmuz Commitment Filtreleri
        function applyJulyFilters() {
            const companyFilter = document.getElementById('julyCompanyFilter').value.toLowerCase();
            const ownerFilter = document.getElementById('julyOwnerFilter').value;
            const productFilter = document.getElementById('julyProductFilter').value;
            const minAmount = parseFloat(document.getElementById('julyMinAmount').value) || 0;
            const maxAmount = parseFloat(document.getElementById('julyMaxAmount').value) || Infinity;
            
            const filteredData = julyCommitmentData.filter(opportunity => {
                // Firma adı filtresi
                if (companyFilter && !opportunity.companyName.toLowerCase().includes(companyFilter)) {
                    return false;
                }
                
                // Fırsat sahibi filtresi
                if (ownerFilter && opportunity.owner !== ownerFilter) {
                    return false;
                }
                
                // Ürün grubu filtresi
                if (productFilter && !opportunity.productGroup.includes(productFilter)) {
                    return false;
                }
                
                // Tutar filtresi
                if (opportunity.amount < minAmount || opportunity.amount > maxAmount) {
                    return false;
                }
                
                return true;
            });
            
            // Filtrelenmiş verileri render et
            renderFilteredJulyCommitment(filteredData);
            
            // Sonuç sayısını güncelle
            document.getElementById('julyFilterCount').textContent = filteredData.length;
        }
        
        function renderFilteredJulyCommitment(filteredData) {
            const grid = document.getElementById('julyCommitmentGrid');
            let html = '';
            
            // Fırsatları tutara göre azalan sırala
            const sortedOpportunities = [...filteredData].sort((a, b) => b.amount - a.amount);
            
            for (let i = 0; i < sortedOpportunities.length; i++) {
                html += createOpportunityCard(sortedOpportunities[i], julyCommitmentData.indexOf(sortedOpportunities[i]));
            }
            
            grid.innerHTML = html;
        }
        
        function clearJulyFilters() {
            document.getElementById('julyCompanyFilter').value = '';
            document.getElementById('julyOwnerFilter').value = '';
            document.getElementById('julyProductFilter').value = '';
            document.getElementById('julyMinAmount').value = '';
            document.getElementById('julyMaxAmount').value = '';
            
            // Orijinal commitment'ı render et
            renderJulyCommitment();
            document.getElementById('julyFilterCount').textContent = julyCommitmentData.length;
        }
        
        // Stratejik Fırsatlar Filtreleme Functions
        function filterStrategicOpportunities() {
            const companyFilter = document.getElementById('companySearch').value.toLowerCase();
            const ownerFilter = document.getElementById('ownerFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const minPrice = parseFloat(document.getElementById('minPrice').value) || 0;
            const maxPrice = parseFloat(document.getElementById('maxPrice').value) || Infinity;
            
            const filteredData = strategicOpportunitiesData.filter(opportunity => {
                // Firma adı filtresi
                if (companyFilter && !opportunity.companyName.toLowerCase().includes(companyFilter)) {
                    return false;
                }
                
                // Fırsat sahibi filtresi
                if (ownerFilter && opportunity.owner !== ownerFilter) {
                    return false;
                }
                
                // Durum filtresi
                if (statusFilter && !opportunity.status.toLowerCase().includes(statusFilter.toLowerCase())) {
                    return false;
                }
                
                // Fiyat filtresi
                if (opportunity.price < minPrice || opportunity.price > maxPrice) {
                    return false;
                }
                
                return true;
            });
            
            // Filtrelenmiş verileri render et
            renderFilteredStrategicOpportunities(filteredData);
            
            // Sonuç sayısını güncelle
            document.getElementById('strategicFilterCount').textContent = filteredData.length;
        }
        function renderFilteredStrategicOpportunities(filteredData) {
            const grid = document.getElementById('strategicOpportunitiesGrid');
            let html = '';
            
            // Fırsatları tutara göre azalan sırala
            const sortedOpportunities = [...filteredData].sort((a, b) => b.price - a.price);
            
            for (let i = 0; i < sortedOpportunities.length; i++) {
                html += createStrategicOpportunityCard(sortedOpportunities[i], strategicOpportunitiesData.indexOf(sortedOpportunities[i]));
            }
            
            grid.innerHTML = html;
        }
        
        function clearStrategicFilters() {
            document.getElementById('companySearch').value = '';
            document.getElementById('ownerFilter').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('minPrice').value = '';
            document.getElementById('maxPrice').value = '';
            
            // Orijinal stratejik fırsatları render et
            renderStrategicOpportunities();
            document.getElementById('strategicFilterCount').textContent = strategicOpportunitiesData.length;
        }
        
        function populateOwnerFilter() {
            const ownerFilter = document.getElementById('ownerFilter');
            const uniqueOwners = [...new Set(strategicOpportunitiesData.map(opp => opp.owner))];
            
            // Mevcut seçenekleri temizle (ilk "Tümü" seçeneği hariç)
            while (ownerFilter.children.length > 1) {
                ownerFilter.removeChild(ownerFilter.lastChild);
            }
            
            // Yeni seçenekleri ekle
            uniqueOwners.forEach(owner => {
                const option = document.createElement('option');
                option.value = owner;
                option.textContent = owner;
                ownerFilter.appendChild(option);
            });
        }
        
        function updateStrategicOpportunitiesCount() {
            document.getElementById('strategicFilterCount').textContent = strategicOpportunitiesData.length;
        }
        
        function addToStrategicOpportunities(companyName, owner, productCode, amount, expectedClose) {
            // Fırsatın zaten stratejik olarak eklenip eklenmediğini kontrol et
            const existingOpportunity = strategicOpportunitiesData.find(opp => 
                opp.companyName === companyName && opp.owner === owner && opp.price === amount
            );
            
            if (existingOpportunity) {
                alert('Bu fırsat zaten stratejik fırsatlar listesinde bulunuyor!');
                return;
            }
            
            // Yeni stratejik fırsat oluştur
            const newStrategicOpportunity = {
                id: strategicOpportunitiesData.length + 1,
                companyName: companyName,
                owner: owner,
                products: productCode ? [productCode] : ['Belirtilmemiş'],
                price: amount,
                status: 'Değerlendirme Aşaması', // Varsayılan durum
                closingDate: expectedClose || 'Belirtilmemiş'
            };
            
            // Stratejik fırsatlar listesine ekle
            strategicOpportunitiesData.push(newStrategicOpportunity);
            
            // Verileri localStorage'a kaydet
            saveStrategicOpportunitiesData();
            
            // Başarı mesajı göster
            showSuccessMessage(`"${companyName}" fırsatı stratejik fırsatlar listesine eklendi!`);
            
            // Modal'ı kapatma - fırsat detayında kal
            // closeModal(); // Bu satırı kaldırdık
        }
        
        function addToStrategicOpportunitiesAndUpdateButton(button, companyName, owner, productCode, amount, expectedClose) {
            // Fırsatın zaten stratejik olarak eklenip eklenmediğini kontrol et
            const existingOpportunity = strategicOpportunitiesData.find(opp => 
                opp.companyName === companyName && opp.owner === owner && opp.price === amount
            );
            
            if (existingOpportunity) {
                alert('Bu fırsat zaten stratejik fırsatlar listesinde bulunuyor!');
                return;
            }
            
            // Yeni stratejik fırsat oluştur
            const newStrategicOpportunity = {
                id: strategicOpportunitiesData.length + 1,
                companyName: companyName,
                owner: owner,
                products: productCode ? [productCode] : ['Belirtilmemiş'],
                price: amount,
                status: 'Değerlendirme Aşaması', // Varsayılan durum
                closingDate: expectedClose || 'Belirtilmemiş'
            };
            
            // Stratejik fırsatlar listesine ekle
            strategicOpportunitiesData.push(newStrategicOpportunity);
            
            // Verileri localStorage'a kaydet
            saveStrategicOpportunitiesData();
            
            // Butonu güncelle - yeşil yap ve "Eklendi" yaz
            button.style.background = '#10b981';
            button.style.cursor = 'default';
            button.innerHTML = '✅ Eklendi';
            button.onclick = null; // Tıklanabilirliği kaldır
            
            // Başarı mesajı göster
            showSuccessMessage(`"${companyName}" fırsatı stratejik fırsatlar listesine eklendi!`);
            
            // Modal'ı kapatma - fırsat detayında kal
        }
        
        function addToJulyCommitmentAndUpdateButton(button, companyName, owner, productCode, amount, expectedClose) {
            // Fırsatın zaten commitment listesinde eklenip eklenmediğini kontrol et
            const existingOpportunity = julyCommitmentData.find(opp => 
                opp.companyName === companyName && opp.owner === owner && opp.amount === amount
            );
            
            if (existingOpportunity) {
                alert('Bu fırsat zaten Temmuz Commitment listesinde bulunuyor!');
                return;
            }
            
            // Yeni commitment fırsatı oluştur
            const newCommitmentOpportunity = {
                id: julyCommitmentData.length + 1,
                companyName: companyName,
                owner: owner,
                productGroup: productCode || 'Belirtilmemiş',
                amount: amount,
                expectedClose: expectedClose || 'Belirtilmemiş',
                status: 'Aktif',
                createdAt: new Date().toLocaleDateString('tr-TR')
            };
            
            // Commitment listesine ekle
            julyCommitmentData.push(newCommitmentOpportunity);
            
            // Verileri localStorage'a kaydet
            saveJulyCommitmentData();
            
            // Özet tabloyu güncelle
            renderJulyCommitmentSummary();
            
            // Butonu güncelle - turuncu yap ve "Eklendi" yaz
            button.style.background = '#f59e0b';
            button.style.cursor = 'default';
            button.innerHTML = '✅ Eklendi';
            button.onclick = null; // Tıklanabilirliği kaldır
            
            // Başarı mesajı göster
            showSuccessMessage(`"${companyName}" fırsatı Temmuz Commitment listesine eklendi!`);
            
            // Modal'ı kapatma - fırsat detayında kal
        }
        
        function removeFromStrategicOpportunities(index) {
            const opportunity = strategicOpportunitiesData[index];
            
            if (confirm(`"${opportunity.companyName}" fırsatını stratejik fırsatlar listesinden kaldırmak istediğinizden emin misiniz?`)) {
                // Fırsatı listeden kaldır
                strategicOpportunitiesData.splice(index, 1);
                
                // ID'leri yeniden numaralandır
                strategicOpportunitiesData.forEach((opp, idx) => {
                    opp.id = idx + 1;
                });
                
                // Verileri localStorage'a kaydet
                saveStrategicOpportunitiesData();
                
                // Stratejik fırsatları yeniden render et
                renderStrategicOpportunities();
                
                // Başarı mesajı göster
                showSuccessMessage(`"${opportunity.companyName}" fırsatı stratejik fırsatlar listesinden kaldırıldı!`);
            }
        }
        
        function updateStrategicOpportunityStatus(index, newStatus) {
            strategicOpportunitiesData[index].status = newStatus;
            
            // Verileri localStorage'a kaydet
            saveStrategicOpportunitiesData();
            
            // Başarı mesajı göster
            showSuccessMessage(`"${strategicOpportunitiesData[index].companyName}" fırsatının durumu "${newStatus}" olarak güncellendi!`);
        }
        
        function editStrategicOpportunity(index) {
            const opportunity = strategicOpportunitiesData[index];
            
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            modalTitle.textContent = `Stratejik Fırsat Düzenle - ${opportunity.companyName}`;
            modalBody.innerHTML = `
                <div class="edit-strategic-form">
                    <div class="edit-strategic-input">
                        <label for="editCompanyName">Firma Adı:</label>
                        <input type="text" id="editCompanyName" value="${opportunity.companyName}">
                    </div>
                    
                    <div class="edit-strategic-input">
                        <label for="editOwner">Fırsat Sahibi:</label>
                        <input type="text" id="editOwner" value="${opportunity.owner}">
                    </div>
                    
                    <div class="edit-strategic-input">
                        <label for="editPrice">Fiyat (₺):</label>
                        <input type="number" id="editPrice" value="${opportunity.price}" min="0" step="1000">
                    </div>
                    
                    <div class="edit-strategic-input">
                        <label for="editStatus">Durum:</label>
                        <input type="text" id="editStatus" value="${opportunity.status}" placeholder="Durum girin...">
                    </div>
                    
                    <div class="edit-strategic-input">
                        <label for="editClosingDate">Tahmini Kapanış Tarihi:</label>
                        <input type="text" id="editClosingDate" value="${opportunity.closingDate}" placeholder="GG.AA.YYYY">
                    </div>
                    
                    <div class="edit-strategic-input">
                        <label for="editProducts">Ürünler (virgülle ayırın):</label>
                        <input type="text" id="editProducts" value="${opportunity.products.join(', ')}" placeholder="Ürün1, Ürün2, Ürün3">
                    </div>
                    
                    <div class="edit-strategic-buttons">
                        <button class="edit-strategic-btn edit-strategic-btn-secondary" onclick="closeModal()">
                            ❌ İptal
                        </button>
                        <button class="edit-strategic-btn edit-strategic-btn-primary" onclick="saveStrategicOpportunity(${index})">
                            ✅ Kaydet
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('modalOverlay').style.display = 'block';
        }
        
        function saveStrategicOpportunity(index) {
            const companyName = document.getElementById('editCompanyName').value.trim();
            const owner = document.getElementById('editOwner').value.trim();
            const price = parseFloat(document.getElementById('editPrice').value);
            const status = document.getElementById('editStatus').value;
            const closingDate = document.getElementById('editClosingDate').value.trim();
            const products = document.getElementById('editProducts').value.split(',').map(p => p.trim()).filter(p => p);
            
            if (!companyName || !owner || isNaN(price) || price < 0 || !closingDate) {
                alert('Lütfen tüm alanları doğru şekilde doldurun!');
                return;
            }
            
            // Fırsatı güncelle
            strategicOpportunitiesData[index] = {
                ...strategicOpportunitiesData[index],
                companyName,
                owner,
                price,
                status,
                closingDate,
                products: products.length > 0 ? products : ['Belirtilmemiş']
            };
            
            // Verileri localStorage'a kaydet
            saveStrategicOpportunitiesData();
            
            // Stratejik fırsatları yeniden render et
            renderStrategicOpportunities();
            
            // Modal'ı kapat
            closeModal();
            
            // Başarı mesajı göster
            showSuccessMessage(`"${companyName}" fırsatı başarıyla güncellendi!`);
        }
        function renderStrategicOpportunitiesSummary() {
            const totalPrice = strategicOpportunitiesData.reduce((sum, opp) => sum + opp.price, 0);
            const totalOpportunities = strategicOpportunitiesData.length;
            const uniqueOwners = [...new Set(strategicOpportunitiesData.map(opp => opp.owner))].length;
            const averagePrice = totalPrice / totalOpportunities;
            
            // Durum dağılımını hesapla
            const statusCounts = {};
            strategicOpportunitiesData.forEach(opp => {
                statusCounts[opp.status] = (statusCounts[opp.status] || 0) + 1;
            });
            
            document.getElementById('strategicOpportunitiesSummaryStats').innerHTML = `
                <div class="summary-stat">
                    <h4>Toplam Değer</h4>
                    <div class="value">₺${totalPrice.toLocaleString('tr-TR')}</div>
                </div>
                <div class="summary-stat">
                    <h4>Fırsat Adedi</h4>
                    <div class="value">${totalOpportunities}</div>
                </div>
                <div class="summary-stat">
                    <h4>Fırsat Sahibi</h4>
                    <div class="value">${uniqueOwners}</div>
                </div>
                <div class="summary-stat">
                    <h4>Ortalama Değer</h4>
                    <div class="value">₺${averagePrice.toLocaleString('tr-TR', {maximumFractionDigits: 0})}</div>
                </div>
            `;
        }
        
        // Yıllık Dashboard Filtreleri
        function applyYearlyFilters() {
            const nameFilter = document.getElementById('yearlyNameFilter').value.toLowerCase();
            const successFilter = document.getElementById('yearlySuccessFilter').value;
            const minAmount = parseFloat(document.getElementById('yearlyMinAmount').value) || 0;
            const maxAmount = parseFloat(document.getElementById('yearlyMaxAmount').value) || Infinity;
            
            const filteredData = salesData.filter(person => {
                // İsim filtresi
                if (nameFilter && !person.name.toLowerCase().includes(nameFilter)) {
                    return false;
                }
                
                // Yıllık tutar hesapla
                const yearlyActual = person.monthlyData ? person.monthlyData.slice(0, 6).reduce((sum, val) => sum + val, 0) : person.actual;
                
                // Tutar filtresi
                if (yearlyActual < minAmount || yearlyActual > maxAmount) {
                    return false;
                }
                
                // Başarı oranı filtresi
                const successRate = person.target > 0 ? (yearlyActual / person.target) * 100 : 0;
                if (successFilter) {
                    if (successFilter === 'excellent' && successRate < 80) return false;
                    if (successFilter === 'good' && (successRate < 50 || successRate >= 80)) return false;
                    if (successFilter === 'needs-improvement' && successRate >= 50) return false;
                }
                
                return true;
            });
            
            // Filtrelenmiş verileri render et
            renderFilteredYearlyDashboard(filteredData);
            
            // Sonuç sayısını güncelle
            document.getElementById('yearlyFilterCount').textContent = filteredData.length;
        }
        
        function renderFilteredYearlyDashboard(filteredData) {
            const grid = document.getElementById('yearlySpeedometerGrid');
            let html = '';
            
            // Kartları yıllık başarı oranına göre azalan sırala (gerçekleşen/hedef oranı)
            const sortedData = [...filteredData].sort((a, b) => {
                const aRate = a.target > 0 ? (a.actual / a.target) * 100 : 0;
                const bRate = b.target > 0 ? (b.actual / b.target) * 100 : 0;
                return bRate - aRate;
            });
            
            for (let i = 0; i < sortedData.length; i++) {
                html += createYearlySpeedometer(sortedData[i], salesData.indexOf(sortedData[i]));
            }
            
            grid.innerHTML = html;
        }
        
        function clearYearlyFilters() {
            document.getElementById('yearlyNameFilter').value = '';
            document.getElementById('yearlySuccessFilter').value = '';
            document.getElementById('yearlyMinAmount').value = '';
            document.getElementById('yearlyMaxAmount').value = '';
            
            // Orijinal yıllık dashboard'u render et
            renderYearlyDashboard();
            document.getElementById('yearlyFilterCount').textContent = salesData.length;
        }
        

        
        // Temmuz Dashboard Export Functions
        function exportMonthlyData(format) {
            // Sadece Temmuz dashboard'da görünen kişileri al (Umut Çakıroğlu ve Ali Altınay hariç)
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && person.name !== "Ali Altınay"
            );
            
            const data = visibleData.map(person => ({
                'İsim': person.name,
                'Ünvan': person.title,
                'Hedef (₺)': person.target,
                'Gerçekleşen (₺)': person.actual,
                'Başarı Oranı (%)': person.target > 0 ? ((person.actual / person.target) * 100).toFixed(1) : 0,
                'Netahsilat (₺)': person.productSales?.netTahsilat || 0,
                'NetEKstre (₺)': person.productSales?.netEkstre || 0,
                'PosRapor (₺)': person.productSales?.posRapor || 0,
                'TÖS (₺)': person.productSales?.tos || 0,
                'OnlineDBS (₺)': person.productSales?.onlineDBS || 0,
                'NAP360 (₺)': person.productSales?.nap || 0
            }));
            
            exportData(data, `Temmuz_Satış_Dashboard_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Ağustos Dashboard Export Functions
        function exportAugustData(format) {
            // Sadece Ağustos dashboard'da görünen kişileri al (Umut Çakıroğlu ve Ali Altınay hariç)
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && person.name !== "Ali Altınay"
            );
            
            const data = visibleData.map(person => ({
                'İsim': person.name,
                'Ünvan': person.title,
                'Hedef (₺)': 0, // Ağustos hedefleri henüz belirlenmemiş
                'Gerçekleşen (₺)': 0, // Ağustos verileri henüz girilmemiş
                'Başarı Oranı (%)': 0,
                'Netahsilat (₺)': 0,
                'NetEKstre (₺)': 0,
                'PosRapor (₺)': 0,
                'TÖS (₺)': 0,
                'OnlineDBS (₺)': 0,
                'NAP360 (₺)': 0
            }));
            
            exportData(data, `Ağustos_Satış_Dashboard_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Eylül Dashboard Export Functions
        function exportSeptemberData(format) {
            const eylulRows = [];
            const visibleData = salesData.filter(person => person.name !== 'Umut Çakıroğlu' && person.name !== 'Ali Altınay' && !person.isInactive);
            const eylulSalesLines = {
                "Betül Köse": { netTahsilat: 97458 + 102000, netEkstre: 135000, posRapor: 80000 },
                "Damla Kalemtaş": { netTahsilat: 120000 + 72000, netEkstre: 25000, posRapor: 0 },
                "Egehan Öncü": { netTahsilat: 96192 + 250000 + 160000, netEkstre: 39000 + 65000, posRapor: 85000 + 60000 },
                "Fahri Aktoz": { netTahsilat: 0, netEkstre: 110000, posRapor: 0 },
                "Güven Gürkan Salıkoç": { netTahsilat: 89500 + 89500 + 100000, netEkstre: 36866, posRapor: 0 },
                "Hüseyin Çakmak": { netTahsilat: 250000, netEkstre: 33896 + 105000 + 105000, posRapor: 60000 + 33666 + 105000 + 105000 },
                "Özge Kaçaroğlu": { netTahsilat: 55000, netEkstre: 0, posRapor: 0 },
                "Sebahat Çay": { netTahsilat: 149944, netEkstre: 50000, posRapor: 50000 },
                "Tuğçe Bugakaptan": { netTahsilat: 48499 + 200000, netEkstre: 53040 + 55896 + 73093, posRapor: 0 },
                "Umut Karaerarslan": { netTahsilat: 160000 + 90000 + 96822 + 143896 + 250000 + 339276, netEkstre: 0, posRapor: 0 }
            };
            const septemberTargets = {
                "Betül Köse": 450000,
                "Damla Kalemtaş": 850000,
                "Egehan Öncü": 850000,
                "Fahri Aktoz": 1250000,
                "Güven Gürkan Salıkoç": 650000,
                "Hüseyin Çakmak": 1250000,
                "Özge Kaçaroğlu": 450000,
                "Sebahat Çay": 1300000,
                "Tuğçe Bugakaptan": 850000,
                "Umut Karaerarslan": 850000,
                "Gizem Güler Ilısu": 450000
            };
            visibleData.forEach(person => {
                const sums = eylulSalesLines[person.name] || { netTahsilat: 0, netEkstre: 0, posRapor: 0 };
                const target = septemberTargets[person.name] || person.septemberTarget || person.augustTarget || person.target || 0;
                const actual = (sums.netTahsilat || 0) + (sums.netEkstre || 0) + (sums.posRapor || 0);
                const success = target > 0 ? (actual / target) * 100 : 0;
                eylulRows.push({
                    'İsim': person.name,
                    'Ünvan': person.title,
                    'Hedef (₺)': target,
                    'Gerçekleşen (₺)': actual,
                    'Başarı Oranı (%)': success.toFixed(1),
                    'Netahsilat (₺)': sums.netTahsilat || 0,
                    'NetEKstre (₺)': sums.netEkstre || 0,
                    'PosRapor (₺)': sums.posRapor || 0,
                    'TÖS (₺)': 0,
                    'OnlineDBS (₺)': 0,
                    'NAP360 (₺)': 0
                });
            });
            exportData(eylulRows, `Eylül_Satış_Dashboard_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Pipeline Export Functions
        function exportPipelineData(format) {
            const data = salesData.map(person => {
                const personOpportunities = pipelineData.filter(opportunity => opportunity.contactPerson === person.name);
                const personPipelineValue = personOpportunities.reduce((sum, opportunity) => sum + opportunity.amount, 0);
                const personTargetToPipelineRatio = personPipelineValue > 0 ? (person.target / personPipelineValue * 100) : 0;
                
                return {
                    'Satış Yöneticisi': person.name,
                    'Hedef (₺)': person.target,
                    'Pipeline Büyüklüğü (₺)': personPipelineValue,
                    'Hedef/Pipeline Oranı (%)': personTargetToPipelineRatio.toFixed(1),
                    'Fırsat Adedi': personOpportunities.length,
                    'Performans': personTargetToPipelineRatio >= 200 ? 'Mükemmel' : 
                                 personTargetToPipelineRatio >= 150 ? 'İyi' : 
                                 personTargetToPipelineRatio >= 100 ? 'Orta' : 'Düşük'
                };
            });
            
            exportData(data, `Pipeline_Analizi_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Stratejik Fırsatlar Export Functions
        function exportStrategicData(format) {
            const data = strategicOpportunitiesData.map(opportunity => ({
                'Firma Adı': opportunity.companyName,
                'Fırsat Sahibi': opportunity.owner,
                'Ürünler': opportunity.products.join(', '),
                'Fiyat (₺)': opportunity.price,
                'Güncel Durum': opportunity.status,
                'Tahmini Kapanış Tarihi': opportunity.closingDate
            }));
            
            if (format === 'pdf') {
                exportStrategicToPDF(data, `Stratejik_Fırsatlar_${new Date().toLocaleDateString('tr-TR')}`);
            } else {
                exportData(data, `Stratejik_Fırsatlar_${new Date().toLocaleDateString('tr-TR')}`, format);
            }
        }
        
        // Temmuz Commitment Export Functions
        function exportJulyData(format) {
            const data = julyCommitmentData.map(opportunity => ({
                'Sıra': opportunity.id,
                'Firma Adı': opportunity.companyName,
                'Tutar (₺)': opportunity.amount,
                'Ürün Grubu': opportunity.productGroup,
                'Fırsat Sahibi': opportunity.owner
            }));
            
            if (format === 'pdf') {
                exportJulyToPDF(data, `Temmuz_Commitment_${new Date().toLocaleDateString('tr-TR')}`);
            } else {
                exportData(data, `Temmuz_Commitment_${new Date().toLocaleDateString('tr-TR')}`, format);
            }
        }
        
        // Yıllık Dashboard Export Functions
        function exportYearlyData(format) {
            // Yıllık dashboard'da kullanılan veriyi oluştur (renderYearlyDashboard'daki gibi)
            const muhammedSivasligil = {
                name: "Muhammed Sivaslıgil",
                title: "Eski Çalışan",
                target: 3870000,
                actual: 899945,
                monthlyData: [147925, 330000, 108800, 313220, 0, 0, 0],
                isInactive: true
            };
            
            const ilterDemirci = {
                name: "İlter Demirci",
                title: "Eski Çalışan",
                target: 2050000,
                actual: 232770,
                monthlyData: [232770, 0, 0, 0, 0, 0, 0],
                isInactive: true
            };
            
            const batuhanArisut = {
                name: "Batuhan Arısüt",
                title: "Eski Çalışan",
                target: 2050000,
                actual: 295070,
                monthlyData: [158450, 0, 0, 74320, 0, 62700, 0],
                isInactive: true
            };
            
            // Yıllık veriyi oluştur (salesData + ayrılmış arkadaşlar)
            const yearlyData = [...salesData, muhammedSivasligil, ilterDemirci, batuhanArisut];
            

            

            
            // Umut Çakıroğlu ve Ali Altınay'ı gizle (kartları görünmesin)
            const visibleData = yearlyData.filter(person => 
                person.name !== "Umut Çakıroğlu" && person.name !== "Ali Altınay"
            );
            
            // Başarı oranına göre sırala
            const sortedData = [...visibleData].sort((a, b) => {
                const aRate = (a.actual / a.target) * 100;
                const bRate = (b.actual / b.target) * 100;
                return bRate - aRate;
            });
            
            const data = sortedData.map(person => {
                const successRate = person.target > 0 ? (person.actual / person.target) * 100 : 0;
                
                return {
                    'İsim': person.name,
                    'Ünvan': person.title,
                    'Yıllık Hedef (₺)': person.target,
                    'Yıllık Gerçekleşen (₺)': person.actual,
                    'Yıllık Başarı Oranı (%)': successRate.toFixed(1),
                    'Performans': successRate >= 80 ? 'Mükemmel' : 
                                 successRate >= 50 ? 'İyi' : 'Hedef Altında',
                    'Durum': person.isInactive ? 'Ayrıldı' : 'Aktif'
                };
            });
            
            exportData(data, `Yıllık_Satış_Dashboard_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Genel Export Function
        function exportData(data, filename, format) {
            switch (format) {
                case 'excel':
                    exportToExcel(data, filename);
                    break;
                case 'csv':
                    exportToCSV(data, filename);
                    break;
                case 'pdf':
                    exportToPDF(data, filename);
                    break;
                case 'print':
                    printData(data, filename);
                    break;
            }
        }
        
        function exportToExcel(data, filename) {
            // Excel export için basit CSV formatı kullan (Excel açabilir)
            exportToCSV(data, filename);
        }
        
        function exportToCSV(data, filename) {
            if (data.length === 0) {
                showExportMessage('Dışa aktarılacak veri bulunamadı!');
                return;
            }
            
            const headers = Object.keys(data[0]);
            const csvContent = [
                headers.join(','),
                ...data.map(row => headers.map(header => {
                    const value = row[header];
                    // Virgül içeren değerleri tırnak içine al
                    return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
                }).join(','))
            ].join('\n');
            
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `${filename}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showExportMessage(`${filename} başarıyla dışa aktarıldı!`);
        }
        
        // Hangi modülün aktif olduğunu tespit et
        function getCurrentActiveModule() {
            if (document.getElementById('dashboardContainer').style.display === 'block') {
                return 'monthly';
            } else if (document.getElementById('yearlyDashboardContainer').style.display === 'block') {
                return 'yearly';
            } else if (document.getElementById('pipelineContainer').style.display === 'block') {
                return 'pipeline';
            } else if (document.getElementById('julyCommitmentContainer').style.display === 'block') {
                return 'july';
            } else if (document.getElementById('strategicOpportunitiesSection').style.display === 'block') {
                return 'strategic';
            }
            return 'monthly'; // Varsayılan
        }
        function exportToPDF(data, filename) {
            const currentModule = getCurrentActiveModule();
            const printWindow = window.open('', '_blank');
            
            // Başlık ve tarih bilgisi
            const currentDate = new Date().toLocaleDateString('tr-TR');
            const moduleTitle = {
                'monthly': 'Aylık Satış Performans Raporu',
                'yearly': 'Yıllık Satış Performans Raporu',
                'pipeline': 'Pipeline Analiz Raporu',
                'july': 'Temmuz Commitment Raporu',
                'strategic': 'Stratejik Fırsatlar Raporu'
            }[currentModule] || 'Satış Raporu';
            
            // Tablo HTML'i oluştur
            const tableHTML = data.map((person, index) => {
                let rowData = '';
                
                if (currentModule === 'monthly') {
                    rowData = `
                        <tr>
                            <td>${person['İsim'] || ''}</td>
                            <td>${person['Ünvan'] || ''}</td>
                            <td>${person['Hedef (₺)'] ? person['Hedef (₺)'].toLocaleString('tr-TR') : '0'} ₺</td>
                            <td>${person['Gerçekleşen (₺)'] ? person['Gerçekleşen (₺)'].toLocaleString('tr-TR') : '0'} ₺</td>
                            <td>${person['Başarı Oranı (%)'] ? person['Başarı Oranı (%)'].toFixed(1) : '0'}%</td>
                        </tr>
                    `;
                } else if (currentModule === 'yearly') {
                    rowData = `
                        <tr>
                            <td>${person['İsim'] || ''}</td>
                            <td>${person['Ünvan'] || ''}</td>
                            <td>${person['Yıllık Hedef (₺)'] ? person['Yıllık Hedef (₺)'].toLocaleString('tr-TR') : '0'} ₺</td>
                            <td>${person['Yıllık Gerçekleşen (₺)'] ? person['Yıllık Gerçekleşen (₺)'].toLocaleString('tr-TR') : '0'} ₺</td>
                            <td>${person['Yıllık Başarı Oranı (%)'] ? person['Yıllık Başarı Oranı (%)'].toFixed(1) : '0'}%</td>
                        </tr>
                    `;
                } else if (currentModule === 'pipeline') {
                    rowData = `
                        <tr>
                            <td>${person['Satış Yöneticisi'] || ''}</td>
                            <td>${person['Pipeline Büyüklüğü'] ? person['Pipeline Büyüklüğü'].toLocaleString('tr-TR') : '0'} ₺</td>
                            <td>${person['Fırsat Adedi'] || '0'}</td>
                            <td>${person['Hedef/Pipeline Oranı'] ? person['Hedef/Pipeline Oranı'].toFixed(1) : '0'}%</td>
                        </tr>
                    `;
                } else {
                    // Diğer modüller için genel format
                    const keys = Object.keys(person);
                    rowData = `
                        <tr>
                            ${keys.map(key => `<td>${person[key] || ''}</td>`).join('')}
                        </tr>
                    `;
                }
                
                return rowData;
            }).join('');
            
            // Tablo başlıkları
            let tableHeaders = '';
            if (currentModule === 'monthly') {
                tableHeaders = `
                    <tr>
                        <th>İsim</th>
                        <th>Ünvan</th>
                        <th>Hedef (₺)</th>
                        <th>Gerçekleşen (₺)</th>
                        <th>Başarı Oranı (%)</th>
                    </tr>
                `;
            } else if (currentModule === 'yearly') {
                tableHeaders = `
                    <tr>
                        <th>İsim</th>
                        <th>Ünvan</th>
                        <th>Yıllık Hedef (₺)</th>
                        <th>Yıllık Gerçekleşen (₺)</th>
                        <th>Yıllık Başarı Oranı (%)</th>
                    </tr>
                `;
            } else if (currentModule === 'pipeline') {
                tableHeaders = `
                    <tr>
                        <th>Satış Yöneticisi</th>
                        <th>Pipeline Büyüklüğü (₺)</th>
                        <th>Fırsat Adedi</th>
                        <th>Hedef/Pipeline Oranı (%)</th>
                    </tr>
                `;
            } else {
                // Diğer modüller için genel başlıklar
                const keys = Object.keys(data[0] || {});
                tableHeaders = `
                    <tr>
                        ${keys.map(key => `<th>${key}</th>`).join('')}
                    </tr>
                `;
            }
            
            // Modern ve temiz PDF şablonu
            printWindow.document.write(`
                <html>
                <head>
                    <title>${filename}</title>
                    <style>
                        @page {
                            size: A4;
                            margin: 1.5cm;
                        }
                        
                        body {
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                            margin: 0;
                            padding: 0;
                            background: white;
                            color: #1e293b;
                            line-height: 1.6;
                        }
                        
                        .header {
                            text-align: center;
                            margin-bottom: 40px;
                            padding-bottom: 20px;
                            border-bottom: 3px solid #3b82f6;
                        }
                        
                        .header h1 {
                            margin: 0;
                            color: #1e293b;
                            font-size: 28px;
                            font-weight: 700;
                            margin-bottom: 8px;
                        }
                        
                        .header p {
                            margin: 0;
                            color: #64748b;
                            font-size: 16px;
                            font-weight: 500;
                        }
                        
                        .data-table {
                            width: 100%;
                            border-collapse: collapse;
                            margin-top: 30px;
                            font-size: 14px;
                            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                            border-radius: 8px;
                            overflow: hidden;
                        }
                        
                        .data-table th {
                            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
                            color: white;
                            padding: 16px 12px;
                            text-align: left;
                            font-weight: 600;
                            font-size: 14px;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                        }
                        
                        .data-table td {
                            padding: 14px 12px;
                            border-bottom: 1px solid #e2e8f0;
                            font-size: 14px;
                        }
                        
                        .data-table tr:nth-child(even) {
                            background-color: #f8fafc;
                        }
                        
                        .data-table tr:hover {
                            background-color: #f1f5f9;
                        }
                        
                        .footer {
                            margin-top: 40px;
                            text-align: center;
                            color: #64748b;
                            font-size: 12px;
                            border-top: 1px solid #e2e8f0;
                            padding-top: 20px;
                        }
                        
                        .success-rate {
                            font-weight: 600;
                            padding: 4px 8px;
                            border-radius: 4px;
                            font-size: 12px;
                        }
                        
                        .success-high {
                            background-color: #dcfce7;
                            color: #166534;
                        }
                        
                        .success-medium {
                            background-color: #fef3c7;
                            color: #92400e;
                        }
                        
                        .success-low {
                            background-color: #fee2e2;
                            color: #991b1b;
                        }
                        
                        @media print {
                            body {
                                -webkit-print-color-adjust: exact;
                                color-adjust: exact;
                            }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>${moduleTitle}</h1>
                        <p>Rapor Tarihi: ${currentDate}</p>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            ${tableHeaders}
                        </thead>
                        <tbody>
                            ${tableHTML}
                        </tbody>
                    </table>
                    
                    <div class="footer">
                        <p>Bu rapor otomatik olarak oluşturulmuştur. © ${new Date().getFullYear()}</p>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            // Kısa bir gecikme sonrası yazdır
            setTimeout(() => {
                printWindow.print();
            }, 500);
        }
        function printData(data, filename) {
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>${filename}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f2f2f2; font-weight: bold; }
                        h1 { color: #333; }
                        @media print {
                            body { margin: 0; }
                            table { font-size: 12px; }
                        }
                    </style>
                </head>
                <body>
                    <h1>${filename}</h1>
                    <p>Oluşturulma Tarihi: ${new Date().toLocaleString('tr-TR')}</p>
                    <table>
                        <thead>
                            <tr>
                                ${Object.keys(data[0] || {}).map(header => `<th>${header}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map(row => `
                                <tr>
                                    ${Object.values(row).map(value => `<td>${value}</td>`).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
            
            showExportMessage(`${filename} yazdırma için hazırlandı!`);
        }
        
        function showExportMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'export-success-message';
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }
        
        // Export Menu Functions
        function toggleExportMenu(menuId) {
            // Tüm export menülerini kapat
            const allMenus = document.querySelectorAll('.module-export-dropdown');
            allMenus.forEach(menu => {
                if (menu.id !== menuId) {
                    menu.classList.remove('active');
                }
            });
            
            // Tıklanan menüyü aç/kapat
            const menu = document.getElementById(menuId);
            menu.classList.toggle('active');
            
            // Buton durumunu güncelle
            const btn = menu.previousElementSibling;
            btn.classList.toggle('active');
        }
        
        // Sayfa dışına tıklandığında menüleri kapat
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.module-export-menu')) {
                const allMenus = document.querySelectorAll('.module-export-dropdown');
                allMenus.forEach(menu => {
                    menu.classList.remove('active');
                });
                
                const allBtns = document.querySelectorAll('.module-export-btn');
                allBtns.forEach(btn => {
                    btn.classList.remove('active');
                });
            }
        });
        
        // Temmuz Dashboard Export Functions
        function exportMonthlyData(format) {
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && person.name !== "Ali Altınay"
            );
            
            const data = visibleData.map(person => ({
                'İsim': person.name,
                'Ünvan': person.title,
                'Hedef (₺)': person.target,
                'Gerçekleşen (₺)': person.actual,
                'Başarı Oranı (%)': person.target > 0 ? ((person.actual / person.target) * 100).toFixed(1) : 0,
                'Netahsilat (₺)': person.productSales?.netTahsilat || 0,
                'NetEKstre (₺)': person.productSales?.netEkstre || 0,
                'PosRapor (₺)': person.productSales?.posRapor || 0,
                'TÖS (₺)': person.productSales?.tos || 0,
                'OnlineDBS (₺)': person.productSales?.onlineDBS || 0,
                'NAP360 (₺)': person.productSales?.nap || 0,
                'UniDOX (₺)': person.productSales?.unidox || 0
            }));
            
            exportData(data, `Temmuz_Satış_Dashboard_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Yıllık Dashboard Export Functions
        function exportYearlyData(format) {
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && person.name !== "Ali Altınay"
            );
            
            const data = visibleData.map(person => {
                const yearlyActual = person.monthlyData ? person.monthlyData.reduce((sum, val) => sum + val, 0) : person.actual;
                const yearlyTarget = person.yearlyTarget || person.target;
                
                return {
                    'İsim': person.name,
                    'Ünvan': person.title,
                    'Yıllık Hedef (₺)': yearlyTarget,
                    'Yıllık Gerçekleşen (₺)': yearlyActual,
                    'Yıllık Başarı Oranı (%)': yearlyTarget > 0 ? ((yearlyActual / yearlyTarget) * 100).toFixed(1) : 0,
                    'Ocak (₺)': person.monthlyData?.[0] || 0,
                    'Şubat (₺)': person.monthlyData?.[1] || 0,
                    'Mart (₺)': person.monthlyData?.[2] || 0,
                    'Nisan (₺)': person.monthlyData?.[3] || 0,
                    'Mayıs (₺)': person.monthlyData?.[4] || 0,
                    'Haziran (₺)': person.monthlyData?.[5] || 0,
                    'Temmuz (₺)': person.monthlyData?.[6] || 0
                };
            });
            
            exportData(data, `Yıllık_Satış_Dashboard_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Pipeline Export Functions
        function exportPipelineData(format) {
            const data = salesData.map(person => {
                const personOpportunities = pipelineData.filter(opportunity => opportunity.contactPerson === person.name);
                const personPipelineValue = personOpportunities.reduce((sum, opportunity) => sum + opportunity.amount, 0);
                const personTargetToPipelineRatio = personPipelineValue > 0 ? (person.target / personPipelineValue * 100) : 0;
                
                return {
                    'Satış Yöneticisi': person.name,
                    'Hedef (₺)': person.target,
                    'Pipeline Büyüklüğü (₺)': personPipelineValue,
                    'Hedef/Pipeline Oranı (%)': personTargetToPipelineRatio.toFixed(1),
                    'Fırsat Adedi': personOpportunities.length,
                    'Performans': personTargetToPipelineRatio >= 200 ? 'Mükemmel' : 
                                 personTargetToPipelineRatio >= 150 ? 'İyi' : 
                                 personTargetToPipelineRatio >= 100 ? 'Orta' : 'Düşük'
                };
            });
            
            exportData(data, `Pipeline_Analizi_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Temmuz Commitment Export Functions
        function exportJulyData(format) {
            const data = julyCommitmentData.map(opportunity => ({
                'Sıra': opportunity.id,
                'Firma Adı': opportunity.companyName,
                'Tutar (₺)': opportunity.amount,
                'Ürün Grubu': opportunity.productGroup,
                'Fırsat Sahibi': opportunity.owner
            }));
            
            exportData(data, `Temmuz_Commitment_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Stratejik Fırsatlar Export Functions
        function exportStrategicData(format) {
            const data = strategicOpportunitiesData.map(opportunity => ({
                'Firma Adı': opportunity.companyName,
                'Fırsat Sahibi': opportunity.owner,
                'Ürünler': opportunity.products.join(', '),
                'Fiyat (₺)': opportunity.price,
                'Güncel Durum': opportunity.status,
                'Tahmini Kapanış Tarihi': opportunity.closingDate
            }));
            
            exportData(data, `Stratejik_Fırsatlar_${new Date().toLocaleDateString('tr-TR')}`, format);
        }
        
        // Genel Export Function
        function exportData(data, filename, format) {
            switch (format) {
                case 'excel':
                    exportToExcel(data, filename);
                    break;
                case 'pdf':
                    exportToPDF(data, filename);
                    break;
            }
        }
        
        function exportToExcel(data, filename) {
            if (data.length === 0) {
                showExportMessage('Dışa aktarılacak veri bulunamadı!');
                return;
            }
            
            const headers = Object.keys(data[0]);
            const csvContent = [
                headers.join(','),
                ...data.map(row => headers.map(header => {
                    const value = row[header];
                    return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
                }).join(','))
            ].join('\n');
            
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `${filename}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showExportMessage(`${filename} Excel olarak dışa aktarıldı!`);
        }
        function exportToPDF(data, filename) {
            const printWindow = window.open('', '_blank');
            
            // Modern PDF içeriği oluştur
            const pdfContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>${filename}</title>
                    <style>
                        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
                        
                        * {
                            margin: 0;
                            padding: 0;
                            box-sizing: border-box;
                        }
                        
                        body { 
                            font-family: 'Inter', sans-serif; 
                            margin: 20px; 
                            background: #f8fafc;
                            color: #1e293b;
                        }
                        
                        .header { 
                            text-align: center; 
                            margin-bottom: 40px; 
                            padding: 30px;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            border-radius: 16px;
                            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
                        }
                        
                        .header h1 {
                            font-size: 2.5em;
                            font-weight: 700;
                            margin-bottom: 10px;
                        }
                        
                        .header p {
                            font-size: 1.1em;
                            opacity: 0.9;
                        }
                        
                        .summary-section {
                            background: white;
                            padding: 25px;
                            border-radius: 12px;
                            margin-bottom: 30px;
                            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
                        }
                        
                        .summary-grid {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 20px;
                            margin-top: 20px;
                        }
                        
                        .summary-item {
                            text-align: center;
                            padding: 20px;
                            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
                            border-radius: 10px;
                            border: 1px solid #e2e8f0;
                        }
                        
                        .summary-value {
                            font-size: 1.8em;
                            font-weight: 700;
                            color: #2563eb;
                            margin-bottom: 5px;
                        }
                        
                        .summary-label {
                            font-size: 0.9em;
                            color: #64748b;
                            font-weight: 500;
                        }
                        
                        .data-section {
                            background: white;
                            padding: 25px;
                            border-radius: 12px;
                            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
                        }
                        
                        .data-section h2 {
                            font-size: 1.5em;
                            font-weight: 600;
                            margin-bottom: 20px;
                            color: #1e293b;
                        }
                        
                        table { 
                            width: 100%; 
                            border-collapse: collapse; 
                            margin-top: 20px;
                            background: white;
                            border-radius: 8px;
                            overflow: hidden;
                            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                        }
                        
                        th, td { 
                            padding: 15px 12px; 
                            text-align: left; 
                            border-bottom: 1px solid #e2e8f0;
                        }
                        
                        th { 
                            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
                            font-weight: 600;
                            color: #374151;
                            font-size: 0.9em;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                        }
                        
                        tr:hover {
                            background: #f8fafc;
                        }
                        
                        .footer { 
                            margin-top: 40px; 
                            text-align: center; 
                            font-size: 0.9em; 
                            color: #64748b;
                            padding: 20px;
                            border-top: 1px solid #e2e8f0;
                        }
                        
                        .success-rate {
                            font-weight: 600;
                            padding: 4px 8px;
                            border-radius: 6px;
                            font-size: 0.85em;
                        }
                        
                        .success-excellent {
                            background: #dcfce7;
                            color: #166534;
                        }
                        
                        .success-good {
                            background: #fef3c7;
                            color: #92400e;
                        }
                        
                        .success-warning {
                            background: #fef2f2;
                            color: #dc2626;
                        }
                        
                        @media print {
                            body { margin: 0; }
                            .header { margin-bottom: 20px; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>${filename}</h1>
                        <p>Oluşturulma Tarihi: ${new Date().toLocaleDateString('tr-TR')} - ${new Date().toLocaleTimeString('tr-TR')}</p>
                    </div>
                    
                    <div class="summary-section">
                        <h2>📊 Özet İstatistikler</h2>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <div class="summary-value">${data.length}</div>
                                <div class="summary-label">Toplam Kayıt</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value">₺${data.reduce((sum, row) => {
                                    const amount = parseFloat(row['Gerçekleşen (₺)'] || row['Yıllık Gerçekleşen (₺)'] || row['Tutar (₺)'] || row['Fiyat (₺)'] || 0);
                                    return sum + amount;
                                }, 0).toLocaleString('tr-TR')}</div>
                                <div class="summary-label">Toplam Tutar</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value">${data.length > 0 ? Object.keys(data[0]).length : 0}</div>
                                <div class="summary-label">Sütun Sayısı</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <h2>📋 Detaylı Veriler</h2>
                        <table>
                            <thead>
                                <tr>
                                    ${Object.keys(data[0] || {}).map(header => `<th>${header}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                ${data.map(row => `
                                    <tr>
                                        ${Object.values(row).map(value => {
                                            if (typeof value === 'string' && value.includes('%')) {
                                                const rate = parseFloat(value);
                                                let className = 'success-warning';
                                                if (rate >= 80) className = 'success-excellent';
                                                else if (rate >= 50) className = 'success-good';
                                                return `<td><span class="success-rate ${className}">${value}</span></td>`;
                                            }
                                            return `<td>${value}</td>`;
                                        }).join('')}
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="footer">
                        <p>Bu rapor Sales Dashboard tarafından otomatik olarak oluşturulmuştur.</p>
                        <p>© 2025 Sales Dashboard - Tüm hakları saklıdır.</p>
                    </div>
                </body>
                </html>
            `;
            
            printWindow.document.write(pdfContent);
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 500);
            
            showExportMessage(`${filename} PDF olarak hazırlandı!`);
        }
        
        function showExportMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'export-success-message';
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }
        
        // Drag & Drop Fonksiyonları
        function initializeDragAndDrop(gridId) {
            const grid = document.getElementById(gridId);
            if (!grid) return;
            
            let draggedElement = null;
            let draggedIndex = null;
            
            // Tüm kartlara drag event listener'ları ekle
            const cards = grid.querySelectorAll('.speedometer-card');
            cards.forEach((card, index) => {
                card.setAttribute('draggable', true);
                card.dataset.index = index;
                
                card.addEventListener('dragstart', function(e) {
                    draggedElement = this;
                    draggedIndex = parseInt(this.dataset.index);
                    this.classList.add('dragging');
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/html', this.outerHTML);
                });
                
                card.addEventListener('dragend', function(e) {
                    this.classList.remove('dragging');
                    draggedElement = null;
                    draggedIndex = null;
                });
                
                card.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                    this.classList.add('drag-over');
                });
                
                card.addEventListener('dragleave', function(e) {
                    this.classList.remove('drag-over');
                });
                
                card.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('drag-over');
                    
                    if (draggedElement && draggedElement !== this) {
                        const dropIndex = parseInt(this.dataset.index);
                        
                        // Sürüklenen kartı bu kartın önüne veya arkasına yerleştir
                        if (draggedIndex < dropIndex) {
                            // Sürüklenen kart daha önceki bir pozisyondan geliyor
                            this.parentNode.insertBefore(draggedElement, this.nextSibling);
                        } else {
                            // Sürüklenen kart daha sonraki bir pozisyondan geliyor
                            this.parentNode.insertBefore(draggedElement, this);
                        }
                        
                        // Index'leri güncelle
                        const allCards = Array.from(grid.querySelectorAll('.speedometer-card'));
                        allCards.forEach((card, newIndex) => {
                            card.dataset.index = newIndex;
                        });
                        
                        // Başarı mesajı göster
                        showNotification('Kart sırası güncellendi!', 'success');
                    }
                });
            });
        }
        
        // Mail Ayarları Fonksiyonları
        let mailScheduleInterval = null;
        let mailSettings = {
            recipients: '',
            subject: 'Günlük Satış Dashboard Raporu',
            schedule: 'daily',
            time: '09:00',
            modules: {
                monthly: true,
                yearly: true,
                pipeline: false,
                strategic: false
            },
            format: 'html',
            smtpHost: '',
            smtpPort: 587,
            smtpUsername: '',
            smtpPassword: '',
            isActive: false,
            lastSent: null,
            nextSend: null
        };
        
        // SMTP Mail Gönderimi
        function sendMailWithSMTP(to, subject, content) {
            return new Promise((resolve, reject) => {
                Email.send({
                    Host: mailSettings.smtpHost,
                    Username: mailSettings.smtpUsername,
                    Password: mailSettings.smtpPassword,
                    To: to,
                    From: mailSettings.smtpUsername,
                    Subject: subject,
                    Body: content,
                    Port: mailSettings.smtpPort,
                    UseTLS: mailSettings.smtpPort === 587,
                    UseSSL: mailSettings.smtpPort === 465
                }).then(
                    message => {
                        console.log('Mail başarıyla gönderildi:', message);
                        resolve(message);
                    }
                ).catch(
                    error => {
                        console.error('Mail gönderim hatası:', error);
                        reject(error);
                    }
                );
            });
        }
        
        function loadMailSettings() {
            const savedSettings = localStorage.getItem('mailSettings');
            if (savedSettings) {
                mailSettings = { ...mailSettings, ...JSON.parse(savedSettings) };
            }
            
            // Form alanlarını doldur
            document.getElementById('mailRecipients').value = mailSettings.recipients;
            document.getElementById('mailSubject').value = mailSettings.subject;
            document.getElementById('mailSchedule').value = mailSettings.schedule;
            document.getElementById('mailTime').value = mailSettings.time;
            document.getElementById('mailFormat').value = mailSettings.format;
            
            document.getElementById('mailMonthly').checked = mailSettings.modules.monthly;
            document.getElementById('mailYearly').checked = mailSettings.modules.yearly;
            document.getElementById('mailPipeline').checked = mailSettings.modules.pipeline;
            document.getElementById('mailStrategic').checked = mailSettings.modules.strategic;
            
            document.getElementById('smtpHost').value = mailSettings.smtpHost || '';
            document.getElementById('smtpPort').value = mailSettings.smtpPort || 587;
            document.getElementById('smtpUsername').value = mailSettings.smtpUsername || '';
            document.getElementById('smtpPassword').value = mailSettings.smtpPassword || '';
            
            updateMailStatus();
        }
        function saveMailSettings() {
            // Form verilerini al
            mailSettings.recipients = document.getElementById('mailRecipients').value.trim();
            mailSettings.subject = document.getElementById('mailSubject').value.trim();
            mailSettings.schedule = document.getElementById('mailSchedule').value;
            mailSettings.time = document.getElementById('mailTime').value;
            mailSettings.format = document.getElementById('mailFormat').value;
            
            mailSettings.modules.monthly = document.getElementById('mailMonthly').checked;
            mailSettings.modules.yearly = document.getElementById('mailYearly').checked;
            mailSettings.modules.pipeline = document.getElementById('mailPipeline').checked;
            mailSettings.modules.strategic = document.getElementById('mailStrategic').checked;
            
            mailSettings.smtpHost = document.getElementById('smtpHost').value.trim();
            mailSettings.smtpPort = parseInt(document.getElementById('smtpPort').value) || 587;
            mailSettings.smtpUsername = document.getElementById('smtpUsername').value.trim();
            mailSettings.smtpPassword = document.getElementById('smtpPassword').value;
            
            // Validasyon
            if (!mailSettings.recipients) {
                showNotification('Lütfen alıcı e-posta adreslerini girin!', 'error');
                return;
            }
            
            if (!mailSettings.smtpHost || !mailSettings.smtpUsername || !mailSettings.smtpPassword) {
                showNotification('Lütfen SMTP ayarlarını tamamlayın!', 'error');
                return;
            }
            
            // Ayarları kaydet
            localStorage.setItem('mailSettings', JSON.stringify(mailSettings));
            
            // SMTP ayarları zaten yüklendi
            
            // Mail gönderimini başlat
            startMailSchedule();
            
            showNotification('Mail ayarları kaydedildi ve gönderim başlatıldı!', 'success');
        }
        
        function startMailSchedule() {
            // Önceki interval'i temizle
            if (mailScheduleInterval) {
                clearInterval(mailScheduleInterval);
            }
            
            mailSettings.isActive = true;
            localStorage.setItem('mailSettings', JSON.stringify(mailSettings));
            
            // İlk gönderim zamanını hesapla
            calculateNextSendTime();
            
            // Periyodik kontrol başlat
            mailScheduleInterval = setInterval(() => {
                const now = new Date();
                if (mailSettings.nextSend && now >= mailSettings.nextSend) {
                    sendScheduledMail();
                    calculateNextSendTime();
                }
            }, 60000); // Her dakika kontrol et
            
            updateMailStatus();
        }
        
        function calculateNextSendTime() {
            const now = new Date();
            const [hours, minutes] = mailSettings.time.split(':').map(Number);
            
            let nextSend = new Date();
            nextSend.setHours(hours, minutes, 0, 0);
            
            // Eğer bugünün saati geçtiyse, yarına ayarla
            if (nextSend <= now) {
                nextSend.setDate(nextSend.getDate() + 1);
            }
            
            // Haftalık/aylık gönderim için ek günler ekle
            if (mailSettings.schedule === 'weekly') {
                nextSend.setDate(nextSend.getDate() + 7);
            } else if (mailSettings.schedule === 'monthly') {
                nextSend.setMonth(nextSend.getMonth() + 1);
            }
            
            mailSettings.nextSend = nextSend;
            localStorage.setItem('mailSettings', JSON.stringify(mailSettings));
        }
        function sendScheduledMail() {
            try {
                // Mail içeriğini oluştur
                const mailContent = generateMailContent();
                
                // SMTP ile mail gönder
                const recipients = mailSettings.recipients.split(',').map(email => email.trim());
                
                recipients.forEach(recipient => {
                    sendMailWithSMTP(recipient, mailSettings.subject, mailContent)
                        .then(() => {
                            mailSettings.lastSent = new Date();
                            localStorage.setItem('mailSettings', JSON.stringify(mailSettings));
                            showNotification(`Mail ${recipient} adresine başarıyla gönderildi!`, 'success');
                        })
                        .catch((error) => {
                            console.error('Mail gönderim hatası:', error);
                            showNotification(`Mail ${recipient} adresine gönderilemedi!`, 'error');
                        });
                });
                
            } catch (error) {
                console.error('Mail gönderim hatası:', error);
                showNotification('Mail gönderiminde hata oluştu!', 'error');
            }
        }
        
        function generateMailContent() {
            let content = `
                <h2>${mailSettings.subject}</h2>
                <p>Tarih: ${new Date().toLocaleDateString('tr-TR')}</p>
                <hr>
            `;
            
            if (mailSettings.modules.monthly) {
                content += generateMonthlyReport();
            }
            
            if (mailSettings.modules.yearly) {
                content += generateYearlyReport();
            }
            
            if (mailSettings.modules.pipeline) {
                content += generatePipelineReport();
            }
            
            if (mailSettings.modules.strategic) {
                content += generateStrategicReport();
            }
            
            return content;
        }
        
        function generateMonthlyReport() {
            const visibleData = salesData.filter(person => 
                person.name !== "Umut Çakıroğlu" && person.name !== "Ali Altınay"
            );
            
            const totalTarget = visibleData.reduce((sum, person) => sum + person.target, 0);
            const totalActual = visibleData.reduce((sum, person) => sum + person.actual, 0);
            const successRate = totalTarget > 0 ? (totalActual / totalTarget) * 100 : 0;
            
            return `
                <h3>📊 Temmuz Dashboard Özeti</h3>
                <p><strong>Toplam Hedef:</strong> ₺${totalTarget.toLocaleString('tr-TR')}</p>
                <p><strong>Toplam Gerçekleşen:</strong> ₺${totalActual.toLocaleString('tr-TR')}</p>
                <p><strong>Başarı Oranı:</strong> %${successRate.toFixed(1)}</p>
                <p><strong>Satış Yöneticisi Sayısı:</strong> ${visibleData.length}</p>
            `;
        }
        
        function generateYearlyReport() {
            // Yıllık dashboard verilerini oluştur (renderYearlyDashboard'daki gibi)
            const yearlyData = [...salesData];
            // ... yıllık veri hesaplamaları
            
            return `
                <h3>📈 Yıllık Dashboard Özeti</h3>
                <p>Yıllık dashboard verileri burada yer alacak...</p>
            `;
        }
        
        function generatePipelineReport() {
            return `
                <h3>🔄 Pipeline Analizi</h3>
                <p>Pipeline analizi verileri burada yer alacak...</p>
            `;
        }
        
        function generateStrategicReport() {
            return `
                <h3>🎯 Stratejik Fırsatlar</h3>
                <p>Stratejik fırsatlar verileri burada yer alacak...</p>
            `;
        }
        
        function testMailSend() {
            if (!mailSettings.recipients) {
                showNotification('Lütfen önce alıcı e-posta adreslerini girin!', 'error');
                return;
            }
            
            if (!mailSettings.smtpHost || !mailSettings.smtpUsername || !mailSettings.smtpPassword) {
                showNotification('Lütfen önce SMTP ayarlarını tamamlayın!', 'error');
                return;
            }
            
            showNotification('Test mail gönderiliyor...', 'info');
            
            // Test mail gönder
            const mailContent = generateMailContent();
            const recipients = mailSettings.recipients.split(',').map(email => email.trim());
            
            recipients.forEach(recipient => {
                sendMailWithSMTP(recipient, `[TEST] ${mailSettings.subject}`, mailContent)
                    .then(() => {
                        showNotification(`Test mail ${recipient} adresine başarıyla gönderildi!`, 'success');
                    })
                    .catch((error) => {
                        console.error('Test mail gönderim hatası:', error);
                        showNotification(`Test mail ${recipient} adresine gönderilemedi!`, 'error');
                    });
            });
        }
        
        function stopMailSchedule() {
            if (mailScheduleInterval) {
                clearInterval(mailScheduleInterval);
                mailScheduleInterval = null;
            }
            
            mailSettings.isActive = false;
            mailSettings.nextSend = null;
            localStorage.setItem('mailSettings', JSON.stringify(mailSettings));
            
            updateMailStatus();
            showNotification('Mail gönderimi durduruldu!', 'info');
        }
        
        function updateMailStatus() {
            const statusElement = document.getElementById('mailStatus');
            const lastSentElement = document.getElementById('lastMailSent');
            const nextSendElement = document.getElementById('nextMailSend');
            
            if (statusElement) {
                statusElement.textContent = mailSettings.isActive ? 'Aktif' : 'Aktif değil';
                statusElement.style.color = mailSettings.isActive ? '#10b981' : '#ef4444';
            }
            
            if (lastSentElement) {
                lastSentElement.textContent = mailSettings.lastSent ? 
                    mailSettings.lastSent.toLocaleString('tr-TR') : '-';
            }
            
            if (nextSendElement) {
                nextSendElement.textContent = mailSettings.nextSend ? 
                    mailSettings.nextSend.toLocaleString('tr-TR') : '-';
            }
        }
        
        // Aylık Veri Analizi Data
        const monthlyAnalysisData = [];

        // Aylık Veri Analizi Functions
        function showMonthlyDataAnalysis() {
            hideAllContainers();
            document.getElementById('monthlyDataAnalysisContainer').style.display = 'block';
            currentModule = 'monthlyAnalysis';
            loadMonthlyAnalysisData();
        }

        function loadMonthlyAnalysisData() {
            updateMonthlyAnalysisSummary();
            populateMonthlyAnalysisFilters();
            updateMonthlyAnalysisTable(monthlyAnalysisData);
            updateMonthlyAnalysisCharts(monthlyAnalysisData);
            document.getElementById('monthlyAnalysisFilterCount').textContent = monthlyAnalysisData.length;
        }

        function updateMonthlyAnalysisSummary() {
            const totalSales = monthlyAnalysisData.reduce((sum, item) => sum + item.salesPrice, 0);
            const avgDiscount = monthlyAnalysisData.reduce((sum, item) => sum + item.discountRate, 0) / monthlyAnalysisData.length;
            const uniqueSellers = new Set(monthlyAnalysisData.map(item => item.seller)).size;
            const uniqueCustomers = new Set(monthlyAnalysisData.map(item => item.customer)).size;

            const summaryStats = document.getElementById('monthlyAnalysisSummaryStats');
            summaryStats.innerHTML = `
                <div class="summary-stat">
                    <h4>Toplam Satış</h4>
                    <div class="value">₺${totalSales.toLocaleString('tr-TR')}</div>
                </div>
                <div class="summary-stat">
                    <h4>Ortalama İndirim</h4>
                    <div class="value">%${avgDiscount.toFixed(1)}</div>
                </div>
                <div class="summary-stat">
                    <h4>Toplam Satıcı</h4>
                    <div class="value">${uniqueSellers}</div>
                </div>
                <div class="summary-stat">
                    <h4>Toplam Müşteri</h4>
                    <div class="value">${uniqueCustomers}</div>
                </div>
            `;
        }

        function populateMonthlyAnalysisFilters() {
            const sellers = [...new Set(monthlyAnalysisData.map(item => item.seller))];
            const cities = [...new Set(monthlyAnalysisData.map(item => item.city))];
            const products = [...new Set(monthlyAnalysisData.map(item => item.product))];

            const sellerSelect = document.getElementById('monthlyAnalysisSellerFilter');
            const citySelect = document.getElementById('monthlyAnalysisCityFilter');
            const productSelect = document.getElementById('monthlyAnalysisProductFilter');

            // Mevcut seçenekleri temizle (ilk "Tümü" seçeneği hariç)
            sellerSelect.innerHTML = '<option value="">Tümü</option>';
            citySelect.innerHTML = '<option value="">Tümü</option>';
            productSelect.innerHTML = '<option value="">Tümü</option>';

            sellers.forEach(seller => {
                const option = document.createElement('option');
                option.value = seller;
                option.textContent = seller;
                sellerSelect.appendChild(option);
            });

            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });

            products.forEach(product => {
                const option = document.createElement('option');
                option.value = product;
                option.textContent = product;
                productSelect.appendChild(option);
            });
        }

        function updateMonthlyAnalysisTable(data) {
            const tbody = document.getElementById('monthlyAnalysisTableBody');
            tbody.innerHTML = '';

            data.forEach(item => {
                const row = document.createElement('tr');
                const discountClass = item.discountRate > 0 ? 'discount-positive' : 
                                    item.discountRate < 0 ? 'discount-negative' : 'discount-zero';
                
                row.innerHTML = `
                    <td style="padding: 12px; text-align: left; border-bottom: 1px solid #eee;">${item.seller}</td>
                    <td style="padding: 12px; text-align: left; border-bottom: 1px solid #eee;">${item.customer}</td>
                    <td style="padding: 12px; text-align: left; border-bottom: 1px solid #eee;">${item.city}</td>
                    <td style="padding: 12px; text-align: left; border-bottom: 1px solid #eee;">${item.product}</td>
                    <td style="padding: 12px; text-align: left; border-bottom: 1px solid #eee;">₺${item.listPrice.toLocaleString('tr-TR')}</td>
                    <td style="padding: 12px; text-align: left; border-bottom: 1px solid #eee;">₺${item.salesPrice.toLocaleString('tr-TR')}</td>
                    <td style="padding: 12px; text-align: left; border-bottom: 1px solid #eee;" class="${discountClass}">${item.discountRate > 0 ? '+' : ''}${item.discountRate}%</td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateMonthlyAnalysisCharts(data) {
            // Satıcı indirim oranları grafiği
            const sellerDiscounts = {};
            data.forEach(item => {
                if (!sellerDiscounts[item.seller]) {
                    sellerDiscounts[item.seller] = [];
                }
                sellerDiscounts[item.seller].push(item.discountRate);
            });

            const sellerAverages = Object.keys(sellerDiscounts).map(seller => ({
                seller: seller,
                avgDiscount: sellerDiscounts[seller].reduce((a, b) => a + b, 0) / sellerDiscounts[seller].length
            }));

            // Ürün dağılımı
            const productCounts = {};
            data.forEach(item => {
                productCounts[item.product] = (productCounts[item.product] || 0) + 1;
            });

            drawMonthlyAnalysisDiscountChart(sellerAverages);
            drawMonthlyAnalysisProductChart(productCounts);
        }

        function drawMonthlyAnalysisDiscountChart(data) {
            const ctx = document.getElementById('monthlyAnalysisDiscountChart').getContext('2d');
            
            if (window.monthlyAnalysisDiscountChart) {
                window.monthlyAnalysisDiscountChart.destroy();
            }

            window.monthlyAnalysisDiscountChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(item => item.seller),
                    datasets: [{
                        label: 'Ortalama İndirim Oranı (%)',
                        data: data.map(item => item.avgDiscount),
                        backgroundColor: data.map(item => 
                            item.avgDiscount > 0 ? 'rgba(40, 167, 69, 0.7)' : 
                            item.avgDiscount < 0 ? 'rgba(220, 53, 69, 0.7)' : 'rgba(108, 117, 125, 0.7)'
                        ),
                        borderColor: data.map(item => 
                            item.avgDiscount > 0 ? 'rgba(40, 167, 69, 1)' : 
                            item.avgDiscount < 0 ? 'rgba(220, 53, 69, 1)' : 'rgba(108, 117, 125, 1)'
                        ),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'İndirim Oranı (%)'
                            }
                        }
                    }
                }
            });
        }

        function drawMonthlyAnalysisProductChart(data) {
            const ctx = document.getElementById('monthlyAnalysisProductChart').getContext('2d');
            
            if (window.monthlyAnalysisProductChart) {
                window.monthlyAnalysisProductChart.destroy();
            }

            const colors = [
                'rgba(255, 99, 132, 0.7)',
                'rgba(54, 162, 235, 0.7)',
                'rgba(255, 206, 86, 0.7)',
                'rgba(75, 192, 192, 0.7)',
                'rgba(153, 102, 255, 0.7)'
            ];

            window.monthlyAnalysisProductChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(data),
                    datasets: [{
                        data: Object.values(data),
                        backgroundColor: colors.slice(0, Object.keys(data).length),
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Aylık Veri Analizi Filtreleme Functions
        function applyMonthlyAnalysisFilters() {
            const sellerFilter = document.getElementById('monthlyAnalysisSellerFilter').value;
            const cityFilter = document.getElementById('monthlyAnalysisCityFilter').value;
            const productFilter = document.getElementById('monthlyAnalysisProductFilter').value;
            const discountFilter = document.getElementById('monthlyAnalysisDiscountFilter').value;

            let filteredData = monthlyAnalysisData.filter(item => {
                const sellerMatch = !sellerFilter || item.seller === sellerFilter;
                const cityMatch = !cityFilter || item.city === cityFilter;
                const productMatch = !productFilter || item.product === productFilter;
                
                let discountMatch = true;
                if (discountFilter === 'positive') {
                    discountMatch = item.discountRate > 0;
                } else if (discountFilter === 'negative') {
                    discountMatch = item.discountRate < 0;
                } else if (discountFilter === 'zero') {
                    discountMatch = item.discountRate === 0;
                }

                return sellerMatch && cityMatch && productMatch && discountMatch;
            });

            updateMonthlyAnalysisTable(filteredData);
            updateMonthlyAnalysisCharts(filteredData);
            document.getElementById('monthlyAnalysisFilterCount').textContent = filteredData.length;
        }

        function clearMonthlyAnalysisFilters() {
            document.getElementById('monthlyAnalysisSellerFilter').value = '';
            document.getElementById('monthlyAnalysisCityFilter').value = '';
            document.getElementById('monthlyAnalysisProductFilter').value = '';
            document.getElementById('monthlyAnalysisDiscountFilter').value = '';
            
            updateMonthlyAnalysisTable(monthlyAnalysisData);
            updateMonthlyAnalysisCharts(monthlyAnalysisData);
            document.getElementById('monthlyAnalysisFilterCount').textContent = monthlyAnalysisData.length;
        }

        // Aylık Veri Analizi Export Functions
        function exportMonthlyAnalysisData(format) {
            const filteredData = getCurrentMonthlyAnalysisData();
            
            switch(format) {
                case 'excel':
                    exportToExcel(filteredData, 'Aylık_Veri_Analizi');
                    break;
                case 'csv':
                    exportToCSV(filteredData, 'Aylık_Veri_Analizi');
                    break;
                case 'pdf':
                    exportToPDF(filteredData, 'Aylık_Veri_Analizi');
                    break;
                case 'print':
                    printData(filteredData, 'Aylık_Veri_Analizi');
                    break;
            }
        }

        function getCurrentMonthlyAnalysisData() {
            // Şu anda filtrelenmiş veriyi döndür (basit implementasyon)
            return monthlyAnalysisData;
        }





        // Başarı mesajı gösterme fonksiyonu
        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #10b981, #34d399);
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
                z-index: 10000;
                font-weight: 500;
                max-width: 300px;
                animation: slideInRight 0.3s ease;
            `;
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(successDiv);
                }, 300);
            }, 3000);
        }

        // Hata mesajı gösterme fonksiyonu
        function showErrorMessage(message) {
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #ef4444, #f87171);
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
                z-index: 10000;
                font-weight: 500;
                max-width: 300px;
                animation: slideInRight 0.3s ease;
            `;
            errorDiv.textContent = message;
            document.body.appendChild(errorDiv);
            
            setTimeout(() => {
                errorDiv.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(errorDiv);
                }, 300);
            }, 5000);
        }

        // Cache kontrolü - her yüklemede temiz cache
        if (window.performance && window.performance.navigation.type === window.performance.navigation.TYPE_BACK_FORWARD) {
            window.location.reload();
        }
        // Excel Export Fonksiyonları
        let extractedData = [];
        
        // Sayfa yüklendiğinde kaydedilmiş verileri yükle
        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('extractedData');
                if (savedData) {
                    extractedData = JSON.parse(savedData);
                    console.log('Kaydedilmiş veriler yüklendi:', extractedData.length, 'satır');
                    updateDataTable();
                    updateRowCount();
                }
            } catch (error) {
                console.error('Kaydedilmiş veriler yüklenirken hata:', error);
            }
        }
        
        // Verileri localStorage'a kaydet
        function saveDataToStorage() {
            try {
                localStorage.setItem('extractedData', JSON.stringify(extractedData));
                console.log('Veriler kaydedildi:', extractedData.length, 'satır');
            } catch (error) {
                console.error('Veriler kaydedilirken hata:', error);
            }
        }




        // Veri tablosunu güncelleme
        function updateDataTable() {
            const container = document.getElementById('extractedDataContainer');
            if (!container) return;

            if (extractedData.length === 0) {
                container.innerHTML = '<div class="no-data-message">Henüz veri çıkarılmadı</div>';
                return;
            }

            const headers = Object.keys(extractedData[0]);
            let tableHTML = `
                <div class="extracted-data-header">
                    <h3>📊 Çıkarılan Veriler (${extractedData.length} satır)</h3>
                    <button class="processing-btn processing-btn-success" onclick="exportToExcel()">
                        📥 Excel'e Aktar
                    </button>
                </div>
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                ${headers.map(header => `<th>${header}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
            `;

            extractedData.forEach(row => {
                tableHTML += '<tr>';
                headers.forEach(header => {
                    tableHTML += `<td>${row[header] || ''}</td>`;
                });
                tableHTML += '</tr>';
            });

            tableHTML += `
                        </tbody>
                    </table>
                </div>
            `;

            container.innerHTML = tableHTML;
        }
        // Excel export fonksiyonu
        function exportToExcel() {
            if (extractedData.length === 0) {
                showErrorMessage('Aktarılacak veri bulunamadı');
                return;
            }

            // CSV formatına dönüştür
            const headers = Object.keys(extractedData[0]);
            let csvContent = headers.join(',') + '\n';

            extractedData.forEach(row => {
                const values = headers.map(header => {
                    const value = row[header] || '';
                    // Virgül içeren değerleri tırnak içine al
                    return value.toString().includes(',') ? `"${value}"` : value;
                });
                csvContent += values.join(',') + '\n';
            });

            // Dosyayı indir
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `satis_verileri_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showSuccessMessage('Excel dosyası başarıyla indirildi!');
        }

        // Tüm container'ları gizle
        function hideAllContainers() {
            const containers = [
                'dashboardContainer',
                'augustDashboardContainer',
                'yearlyDashboardContainer'
            ];
            
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container) {
                    container.style.display = 'none';
                }
            });
        }

        // Görsel işleme sayfasını göster
        function showImageProcessing() {
            console.log('showImageProcessing çağrıldı');
            hideAllContainers();
            const container = document.getElementById('imageProcessingContainer');
            console.log('imageProcessingContainer bulundu:', container);
            if (container) {
                container.style.display = 'block';
                console.log('Görsel işleme sayfası gösterildi');
            } else {
                console.error('imageProcessingContainer bulunamadı!');
            }
        }





        
        // Modal'ı kapat
        function closeManualInput() {
            const modal = document.querySelector('.manual-input-modal');
            if (modal) {
                modal.remove();
            }
        }
        

        
        // Tekil satır ekle
        function addSingleRow() {
            const row = {
                'Satış Tarihi': document.getElementById('dateInput').value || '',
                'Satış Tipi': document.getElementById('typeInput').value || '',
                'Bölge': document.getElementById('regionInput').value || '',
                'Grup': document.getElementById('groupInput').value || '',
                'Satış Geliştirici': document.getElementById('developerInput').value || '',
                'Takım': '',
                'İletişim Kanalı': '',
                'Erişim Kanalı': '',
                'Satıcı': document.getElementById('developerInput').value || '',
                'İş Ortağı': '',
                'Müşteri Adı / Domain Adı - 2025': document.getElementById('customerInput').value || '',
                'Müşteri İli': document.getElementById('cityInput').value || '',
                'Ürün': document.getElementById('productInput').value || '',
                'Paket': '',
                'Açıklama': '',
                'Liste Fiyatı': document.getElementById('priceInput').value || '',
                'Miktar': '1',
                'Satış Fiyatı': document.getElementById('priceInput').value || '',
                'Durum': 'Tamamlandı',
                'Ödeme Tipi': 'Nakit',
                'Not': ''
            };
            
            extractedData.push(row);
            updateDataTable();
            updateRowCount();
            saveDataToStorage(); // Verileri kaydet
            
            // Form'u temizle
            document.getElementById('dateInput').value = '';
            document.getElementById('customerInput').value = '';
            document.getElementById('cityInput').value = '';
            document.getElementById('priceInput').value = '';
            
            showSuccessMessage('Satır başarıyla eklendi ve kaydedildi!');
        }
        
        // Veri sayısını güncelle
        function updateRowCount() {
            const totalRows = document.getElementById('totalRows');
            if (totalRows) {
                totalRows.textContent = extractedData.length;
            }
        }
        
        // Tüm verileri temizle
        function clearAllData() {
            if (confirm('Tüm verileri silmek istediğinizden emin misiniz?')) {
                extractedData = [];
                updateDataTable();
                updateRowCount();
                saveDataToStorage(); // Boş veriyi kaydet
                showSuccessMessage('Tüm veriler temizlendi ve kaydedildi!');
            }
        }
        
        // CSS düzeltmesi - Speedometer renkleri için
        const style = document.createElement('style');
        style.textContent = `
            /* Temmuz dashboard için gradient path'ler */
            .speedometer-svg path[stroke*="gradient"] {
                stroke: url(#gradient-FahriAktoz) !important;
            }
            
            /* Ağustos dashboard için gradient path'ler */
            .speedometer-svg path[stroke*="august-gradient"] {
                stroke: url(#august-gradient-FahriAktoz) !important;
            }
            
            /* Yıllık dashboard için gradient path'ler */
            .speedometer-svg path[stroke*="yearly-gradient"] {
                stroke: url(#yearly-gradient-FahriAktoz) !important;
            }
        `;
        document.head.appendChild(style);
        
        // Sayfa yüklendiğinde filtre sayılarını güncelle
        document.addEventListener('DOMContentLoaded', function() {
            // Kaydedilmiş verileri yükle
            loadSavedData();
            
            // Pipeline verilerini yükle
            loadPipelineData();
            
            // Stratejik fırsatlar verilerini yükle
            loadStrategicOpportunitiesData();
            
            // Temmuz Commitment verilerini yükle
            loadJulyCommitmentData();
            
            // Pipeline owner filter'ını doldur (duplicate kontrolü ile)
            const pipelineOwnerFilter = document.getElementById('pipelineOwnerFilter');
            if (pipelineOwnerFilter) {
                // Mevcut seçenekleri temizle (ilk "Tümü" seçeneği hariç)
                while (pipelineOwnerFilter.children.length > 1) {
                    pipelineOwnerFilter.removeChild(pipelineOwnerFilter.lastChild);
                }
                
                // Benzersiz isimleri al ve ekle
                const uniqueNames = [...new Set(salesData.map(person => person.name))];
                uniqueNames.forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name;
                    pipelineOwnerFilter.appendChild(option);
                });
            }
            
            // Başlangıç sayılarını ayarla
            setTimeout(() => {
                if (document.getElementById('monthlyFilterCount')) {
                    document.getElementById('monthlyFilterCount').textContent = salesData.length;
                }
                if (document.getElementById('pipelineFilterCount')) {
                    document.getElementById('pipelineFilterCount').textContent = salesData.length;
                }
                if (document.getElementById('julyFilterCount')) {
                    document.getElementById('julyFilterCount').textContent = julyCommitmentData.length;
                }
                if (document.getElementById('yearlyFilterCount')) {
                    document.getElementById('yearlyFilterCount').textContent = salesData.length;
                }
                if (document.getElementById('strategicFilterCount')) {
                    document.getElementById('strategicFilterCount').textContent = strategicOpportunitiesData.length;
                }

            }, 100);
            
                            // Varsayılan olarak Temmuz dashboard'u göster
            showDashboard();
        });
    </script>
</body>
</html>